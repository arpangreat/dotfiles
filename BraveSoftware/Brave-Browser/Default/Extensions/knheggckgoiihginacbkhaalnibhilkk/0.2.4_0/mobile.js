(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1137:function(e,t,n){"use strict";n.r(t);n(15),n(12);var r=n(0),i=n(3),o=n(34),s=n(220),a=n(8),l=n(17),c=n(171),d=n(688),h=n(1658),p=n(14),m=n(338),u=n(1499);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class f extends i.a{constructor(){super(...arguments),this.handleClickFind=()=>{d.c({environment:this.environment,analyticsFrom:"mobile-bottom-bar"}),p.Zd(this.environment,{itemName:"search"})},this.handleClickQuickAdd=()=>{s.f({environment:this.environment,from:"mobile_bottom_bar"}),p.Zd(this.environment,{itemName:"add_page"})},this.handleUndo=()=>{m.f(this.environment,!0),p.Zd(this.environment,{itemName:"undo"})},this.handleRedo=()=>{m.e(this.environment,!0),p.Zd(this.environment,{itemName:"redo"})},this.canQuickAdd=this.createComputedStore(()=>Boolean(l.a.state.currentSpaceStore&&l.a.state.currentSpaceStore.canEdit()))}renderComponent(){const e=u.a.state;if(e){const{isTablet:t}=this.environment.device;return r.createElement("div",{style:this.getWrapStyle(e)},t?this.renderTabletButtons():this.renderPhoneButtons())}}renderPhoneButtons(){return r.createElement(r.Fragment,null,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton())}renderTabletButtons(){return r.createElement(r.Fragment,null,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton(),this.renderUndoRedoButtons())}renderSearchButton(){return r.createElement(o.a,{style:this.getSearchButtonStyle(),onClick:this.handleClickFind,mobileFeedback:!0},a.a.mobileBottomBarSearch(this.getIconStyle()))}renderUpdatesButton(){const{isTablet:e}=this.environment.device;return r.createElement(h.a,{format:e?h.a.Format.MobileBottomBarTablet:h.a.Format.MobileBottomBarPhone})}renderQuickAddPageButton(){return r.createElement(o.a,{style:this.getQuickAddButtonStyle(),onClick:this.handleClickQuickAdd,mobileFeedback:!0,disabled:!this.canQuickAdd.state,disabledFeedback:!0},a.a.mobileBottomBarAddPage(this.getIconStyle()))}renderUndoRedoButtons(){return r.createElement(r.Fragment,null,r.createElement(o.a,{style:this.getUndoButtonStyle(),onClick:this.handleUndo,mobileFeedback:!0,disabled:!m.b(),disabledFeedback:!0},a.a.mobileBottomBarUndo(this.getIconStyle())),r.createElement(o.a,{style:this.getRedoButtonStyle(),onClick:this.handleRedo,mobileFeedback:!0,disabled:!m.a(),disabledFeedback:!0},a.a.mobileBottomBarRedo(this.getIconStyle())))}getWrapStyle(e){const{WindowSizeStore:t}=this.environment,{isTablet:n}=this.environment.device;return{position:"absolute",left:0,right:0,bottom:0,display:"flex",justifyContent:n?"flex-start":"space-around",height:t.getSafePaddingBottomCSS(f.height),paddingBottom:t.state.paddingBottomCSS,background:this.theme.contentBackground,borderTop:"1px ".concat(this.theme.darkDividerColor," solid"),zIndex:c.h,opacity:e?1:0,pointerEvents:e?"auto":"none",cursor:"pointer"}}getSearchButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return b({display:"flex",alignItems:"center",justifyContent:"flex-start",flex:1,paddingLeft:e.getSafePaddingLeftCSS(18)},t&&{flex:"none",paddingLeft:2,width:f.tabletButtonWidth,justifyContent:"center"})}getQuickAddButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return b({display:"flex",alignItems:"center",justifyContent:"flex-end",flex:1,paddingRight:e.getSafePaddingRightCSS(18)},t&&{justifyContent:"center",flex:"none",paddingRight:0,width:f.tabletButtonWidth,marginRight:"auto"})}getUndoButtonStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"flex-start",flex:"none",paddingLeft:e.getSafePaddingLeftCSS(18),width:f.tabletButtonWidth}}getRedoButtonStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flex:"none",width:f.tabletButtonWidth,paddingRight:4}}getIconStyle(){return{width:26,fill:this.theme.regularTextColor}}}f.height=44,f.tabletButtonWidth=54,t.default=f},1146:function(e,t,n){"use strict";n.r(t);n(15),n(12);var r=n(0),i=n(153),o=n(200),s=n(3),a=n(8),l=n(23),c=n(46),d=n(407),h=n(329),p=n(413),m=n(1);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class y extends s.a{constructor(){super(...arguments),this.storeTypes={store:o.a},this.handleFocused=()=>{l.e(this.environment),c.f(this.environment),this.stores.store.setState(g({},this.stores.store.state,{focus:!0}))},this.handleBlurred=()=>{this.stores.store.setState(g({},this.stores.store.state,{focus:!1}))},this.handleSearchQueryChange=e=>{this.props.onChange({searchQuery:e.target.value})}}renderComponent(){const{searchQuery:e,intl:t}=this.props,{focus:n}=this.stores.store.state;return r.createElement(d.a,{capture:n},r.createElement(h.a,{capture:!0,render:o=>r.createElement("div",Object.assign({},o),r.createElement(i.b,{style:this.getStyle(),format:i.a.Transparent,value:e,placeholder:t.formatMessage({defaultMessage:"Type to search…",id:"database.mobileSearch.placeholder"}),onChange:this.handleSearchQueryChange,autoComplete:"on",autoCorrect:"on",onFocus:this.handleFocused,onBlur:this.handleBlurred,showClearButton:!0,left:a.a.searchThick(this.getSearchIconStyle())}),r.createElement(p.a,{show:n}))}))}getStyle(){return{boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,flexGrow:0,flexShrink:0,height:32,paddingLeft:8,paddingRight:12,borderRadius:3,fontSize:14,marginBottom:4}}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor}}}t.default=Object(m.h)(y)},1150:function(e,t,n){"use strict";n.r(t);n(15),n(12);var r=n(0),i=n(3),o=n(6),s=n(8),a=n(510),l=n(26),c=n(592),d=n(222),h=n(753),p=n(68),m=n(69),u=n(16);class g extends u.a{getInitialState(){return{open:!1,focused:!1}}}var b=g,y=n(57),f=n(114),S=n(88),v=n(130),w=n(1190),E=n(39),O=n(116),k=n(17),P=n(22),M=n(1),T=n(275);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class B extends i.a{constructor(){super(...arguments),this.handleClick=()=>{const{onNavigate:e,store:t}=this.props;e&&e(t)}}renderComponent(){const{store:e,collectionViewStore:t}=this.props,n=Object(p.a)({store:e,fullyQualified:!1,collectionViewId:t.id}),i=t.getValue();if(i)return r.createElement(f.a,{href:n,style:{width:"100%"},onClick:this.handleClick},r.createElement(w.a,{icon:this.renderIcon(),style:this.getSidebarItemStyle(),isMobile:this.props.isMobile},r.createElement(T.a,{collectionViewName:i.name,collectionViewType:i.type})))}renderIcon(){return r.createElement("div",{style:j({},this.getInitialIconStyle())},"•")}getInitialIconStyle(){return{fontSize:12,fontWeight:500,color:this.theme.mediumTextColor}}getSidebarItemStyle(){const{device:e}=this.environment;return j({},this.isCurrentPage()&&j({background:this.theme.buttonHoveredBackground,color:this.theme.regularTextColor,fontWeight:P.a.fontWeight.semibold},e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t0 1px 0 ".concat(this.theme.buttonHoveredBackground,"\n\t\t\t\t\t")}),{},this.props.style)}isCurrentPage(){const{store:e,collectionViewStore:t}=this.props,{currentBlockStore:n,currentCollectionViewStore:r}=k.a.state;return n&&e.id===n.id&&r&&r.id===t.id}}var x=Object(M.h)(B),A=n(44);class D extends i.a{constructor(){super(...arguments),this.renderCollectionView=e=>{const{store:t}=this.props;return r.createElement(x,{key:e.id,store:t,collectionViewStore:e,style:this.props.itemStyle,isMobile:this.props.isMobile,onNavigate:this.props.onNavigate})},this.handleContextMenu=e=>{e.preventDefault(),Object(A.d)({event:e,context:A.a.EditorContextMenu,callback:()=>{}})}}renderComponent(){const{store:e}=this.props,t=e.getCollectionViewStores();return r.createElement("div",{onContextMenu:this.handleContextMenu},t.map(this.renderCollectionView))}}var L=D,R=n(27),F=n(11),W=n(14),U=n(99),N=n(23),V=n(81),_=n(172),z=n(836),H=n(34),q=n(429),G=n(196),Q=n(62),K=n(149),Z=n(42),Y=n(350),X=n(61);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class te extends y.a{constructor(){super(...arguments),this.showAsLoadingSpinner=!1,this.registries=[q.a],this.storeTypes={outlinerItemStore:b},this.toggleOpen=e=>{this.stores.outlinerItemStore.setState($({},this.stores.outlinerItemStore.state,{open:e})),this.shouldPersistToggleState()&&Q.a.set({userId:this.environment.currentUser.id,key:this.getLocalStoreKey(),value:e})},this.isCurrentPage=this.createComputedStore(()=>{const{store:e}=this.props,{currentBlockStore:t}=k.a.state;return t&&e.id===t.id}),this.handleLinkClick=()=>{const{store:e}=this.props;W.E(this.environment,{type:this.props.isTopLevelItem?"top_level":"nested"}),this.props.onNavigate&&this.props.onNavigate(e)},this.handleMouseMove=e=>{G.a.state.isDragging||this.stores.outlinerItemStore.setState($({},this.stores.outlinerItemStore.state,{focused:!0}))},this.handleMouseLeave=e=>{this.stores.outlinerItemStore.setState($({},this.stores.outlinerItemStore.state,{focused:!1}))},this.handleDrop=async e=>{const{droppedDirection:t,droppedStores:n,duplicate:r}=e,{store:i,type:o,isTopLevelItem:s,parentStore:a}=this.props;await h.b({type:o,droppedStores:n,droppedDirection:t})&&a&&F.d(this.environment,e=>{h.e({environment:this.environment,type:o,targetParentStore:a,targetStore:i,isTopLevelItem:s,droppedDirection:t,droppedStores:n,duplicate:r,transaction:e})})},this.handleShowMenuButtonClick=e=>{const{store:t}=this.props;N.k({environment:this.environment,store:t}),d.c({environment:this.environment,stores:[this.props.store],left:e.clientX,top:e.clientY,showInput:!1,actions:_.l,analyticsFrom:"sidebar_more_menu"})},this.handleToggleClick=()=>{const{outlinerItemStore:e}=this.stores,t=!e.state.open;W.Yc(this.environment,{type:this.props.isTopLevelItem?"top_level":"nested",is_toggled:t}),this.toggleOpen(t)},this.handleInsertBefore=e=>{const{store:t,type:n}=this.props;return h.f({environment:this.environment,store:t,insertStores:e.insertStores,parentStore:e.parentStore,before:!0,transaction:e.transaction,type:n})},this.handleInsertAfter=e=>{const{store:t,type:n}=this.props;return h.f({environment:this.environment,store:t,insertStores:e.insertStores,parentStore:e.parentStore,before:!1,transaction:e.transaction,type:n})},this.handleRemove=e=>{const{store:t}=this.props,n=t.recordStoreParent();n&&X.e({remove:t,parent:n,transaction:e.transaction})},this.handleRecordIconChange=e=>{const{store:t}=this.props,n=t.getIconStore();n&&F.d(this.environment,t=>{R.c({store:n,value:e,transaction:t})})},this.handleAddPageButtonClick=e=>{const{device:t}=this.environment;if(Object(V.k)(this.environment)){this.props.onCreatePage&&this.props.onCreatePage();const e=F.d(this.environment,e=>h.a({environment:this.environment,store:this.props.store,transaction:e}));Y.a.setState($({},Y.a.state,{lastPageId:k.a.state.currentBlockStore?k.a.state.currentBlockStore.id:void 0})),t.isMobile?Z.h({environment:this.environment,store:e,showMoveTo:!1,saveParent:!1,visitType:"Link"}):Z.m({environment:this.environment,store:e,showMoveTo:!0,saveParent:!1}),this.props.store.isCollectionView()||this.toggleOpen(!0)}}}toggleStore(){return this.stores.outlinerItemStore}async didMount(){if(super.didMount(),this.shouldPersistToggleState()){const e=Q.a.get({userId:this.environment.currentUser.id,key:this.getLocalStoreKey()});this.stores.outlinerItemStore.setState($({},this.stores.outlinerItemStore.state,{open:e}))}const{store:e}=this.props;this.showAsLoadingSpinner="copy_indicator"===e.getType()&&K.a.isPendingTransactionForRecord(e.pointer)}renderPersisted(){const{store:e,isFirstItem:t,type:n,parentStore:i}=this.props,o=e.canRead()&&"copy_indicator"!==e.getType()&&"offline"!==n,s=this.canEdit(),a=o&&i?{onInsertAfter:e=>this.handleInsertAfter($({},e,{parentStore:i})),onInsertBefore:e=>this.handleInsertBefore($({},e,{parentStore:i}))}:{};return r.createElement(v.a,Object.assign({analyticsName:"outliner_item",blockMenuActions:_.l,canDrag:o,canDropAbove:t,canDropBelow:o,canDropOnto:s,canInsertAfter:o,canInsertBefore:o,canSelect:o,canTriggerContextMenu:!0,onRemove:this.handleRemove,onSelectableDrop:this.handleDrop,shouldShowDropZone:!0,showBlockMenuInput:!1,store:e},a),this.renderItem(),this.shouldShowChildren()&&this.renderOutliner())}renderOutliner(){const{store:e,disabled:t}=this.props;return e.isCollectionView()?r.createElement(L,{store:e,itemStyle:this.getSubOutlinerStyle(),isMobile:this.props.isMobile,onNavigate:this.props.onNavigate}):r.createElement(he,{isMobile:this.props.isMobile,type:this.props.type,isTopLevel:!1,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,parentStore:e.getContentStore(),itemStyle:this.getSubOutlinerStyle(),itemToggleStyle:this.props.toggleStyle,onCreatePage:this.props.onCreatePage,onNavigate:this.props.onNavigate,disabled:t})}renderItem(){const{store:e}=this.props;if("copy_indicator"===e.getType())return this.showAsLoadingSpinner?r.createElement(w.a,{style:this.getSidebarItemStyle(),childrenStyle:te.sidebarChildrenStyle,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,isMobile:this.props.isMobile},r.createElement(U.a,null)):void 0;{let e=r.createElement(w.a,{style:this.getSidebarItemStyle(),childrenStyle:te.sidebarChildrenStyle,left:this.renderLeftToggleButton(),icon:this.renderIcon(),right:this.renderRightIcons(),onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,isMobile:this.props.isMobile},this.isAlias()&&this.renderAliasIcon(),this.renderTitle());const t=this.getURL();return t&&(e=r.createElement(f.a,{style:{width:"100%"},href:t,onClick:this.handleLinkClick},e)),e}}renderRightIcons(){const{isMobile:e,store:t}=this.props;if(e||this.stores.outlinerItemStore.state.focused){const e=t.getType()&&this.canEdit();return r.createElement("div",{style:{display:"flex",paddingLeft:3}},this.renderMenuButton(),e&&this.renderAddPageButton())}}renderAliasIcon(){const{store:e}=this.props;return r.createElement(E.a,{renderTooltip:()=>e.isCollectionView()?"This is a linked database":"This is a link to the original page",render:e=>r.createElement("div",Object.assign({style:{marginRight:"0.125em"}},e),te.aliasIcon)})}renderLeftToggleButton(){return r.createElement(z.a,{isSidebar:!0,fill:!0,open:Boolean(this.stores.outlinerItemStore.state.open),color:this.theme.mediumIconColor,onClick:this.handleToggleClick})}renderAddPageButton(){const{isMobile:e}=this.props;return r.createElement(E.a,{renderTooltip:()=>r.createElement(M.b,{defaultMessage:"Quickly add a page inside",id:"sidebarItem.addAPageInside.tooltip"}),placement:E.a.Placement.Bottom,render:t=>r.createElement(H.a,Object.assign({mobileFeedback:e,style:$({},this.getButtonStyle(),{marginLeft:e?0:4},!e&&{border:"1px solid ".concat(this.theme.outlineButtonBorder)}),onClick:this.handleAddPageButtonClick},t),s.a.plus(this.getButtonIconStyle()))})}renderMenuButton(){const{isMobile:e}=this.props;return r.createElement(E.a,{renderTooltip:()=>"bookmarks"===this.props.type?r.createElement(M.b,{defaultMessage:"Remove, rename, and more…",id:"sidebarItem.favoritedPageMenuButton.tooltip"}):r.createElement(M.b,{defaultMessage:"Delete, duplicate, and more…",id:"sidebarItem.pageMenuButton.tooltip"}),placement:E.a.Placement.Bottom,render:t=>r.createElement(H.a,Object.assign({mobileFeedback:e,style:this.getButtonStyle(),onClick:this.handleShowMenuButtonClick},t),s.a.dots($({},this.getButtonIconStyle(),{width:e?18:14})))})}renderIcon(){const{store:e}=this.props,t=e.getIcon(),n=!this.props.isMobile&&this.canEdit()&&!e.isLocked();return r.createElement(E.a,{renderTooltip:()=>r.createElement(M.b,{defaultMessage:"Change icon",id:"sidebarItem.changeIconButton.tooltip"}),placement:E.a.Placement.Bottom,render:i=>n?r.createElement(S.a,Object.assign({bucket:"secure",disabled:!1,icon:t,title:void 0,isEmptyPage:e.isEmptyPage(),size:this.props.isMobile?24:20,onChange:this.handleRecordIconChange,pageIconStyle:{fill:this.theme.mediumIconColor}},i)):r.createElement(S.a,{disabled:!0,icon:t,title:void 0,isEmptyPage:e.isEmptyPage(),size:this.props.isMobile?24:20,pageIconStyle:{fill:this.theme.mediumIconColor}})})}renderTitle(){const{store:e}=this.props;return r.createElement(O.a,{store:e})}shouldPersistToggleState(){return this.props.isTopLevelItem}shouldShowChildren(){return this.stores.outlinerItemStore.state.open}getURL(){const{store:e}=this.props;if(e.isNavigableBlock())return Object(p.a)({store:e,fullyQualified:!1});{const t=m.b(e);if(t)return Object(p.a)({store:t,scrollToBlockId:e.id,fullyQualified:!1})}}getLocalStoreKey(){const{store:e}=this.props;return"Outliner-".concat(e.id)}isAlias(){const{store:e,parentStore:t,isTopLevelItem:n}=this.props;if(e.isCollectionView()){const t=e.getCollectionViewCollectionStore();if(t){const n=t.getValue();if(n&&n.parent_id!==e.id)return!0}}if(n)return!1;if(!t)return!1;const r=e.getValue();return!!r&&r.parent_id!==t.id}getPaddingLeftUnit(){return this.props.isMobile?22:14}getSidebarItemStyle(){const{device:e}=this.environment;return $({},this.isCurrentPage.state&&$({background:this.theme.buttonHoveredBackground,color:this.theme.regularTextColor,fontWeight:P.a.fontWeight.semibold},e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t0 1px 0 ".concat(this.theme.buttonHoveredBackground,"\n\t\t\t\t\t")}),{},this.props.style)}getSubOutlinerStyle(){const e=$({},this.props.style),t=this.getSidebarItemStyle(),n="number"==typeof t.paddingLeft?t.paddingLeft:this.getInitialPaddingLeft();return e.paddingLeft=n+this.getPaddingLeftUnit(),e}getInitialPaddingLeft(){return this.props.isMobile?6:14}getButtonStyle(){const{isMobile:e}=this.props;return{display:"flex",alignItems:"center",justifyContent:"center",width:e?32:20,height:e?32:20,borderRadius:3}}getButtonIconStyle(){const{isMobile:e}=this.props;return{fill:e?this.theme.lightIconColor:this.theme.sidebarTextColor,width:e?18:12}}}te.aliasIcon=s.a.alias({width:"1em",height:"1em",marginRight:2}),te.sidebarChildrenStyle={display:"flex",alignItems:"center"};var ne=te,re=n(67),ie=n(4),oe=n(10),se=n(108);function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class de extends i.a{constructor(){super(...arguments),this.outlinerItemTree=this.createComputedStore(()=>{const{parentStore:e}=this.props,t=[];if(e){const n=l.a.createChildStore(e,{table:oe.b,id:e.id});this.getOutlinerItemsInSubtree(n,n,t,new Set)}return t}),this.handleCreatePageClick=async()=>{const{spaceStore:e,spaceViewStore:t,type:n,onCreatePage:r}=this.props;await h.c({environment:this.environment,spaceStore:e,spaceViewStore:t,type:n,prepend:!1})&&r&&r()},this.handleEmptyDrop=async e=>{const{droppedDirection:t,droppedStores:n,duplicate:r}=e,{type:i,isTopLevel:o,parentStore:s}=this.props;if(s){await h.b({type:i,droppedStores:n,droppedDirection:t})&&F.d(this.environment,e=>{h.e({environment:this.environment,type:i,targetParentStore:s,isTopLevelItem:o,droppedDirection:t,droppedStores:n,duplicate:r,transaction:e})})}}}renderComponent(){const{device:e}=this.environment,{parentStore:t,isTopLevel:n,childStores:i,disabled:o,type:s}=this.props;let d=[],h=!1;if(i)d=i.map((e,n)=>this.renderPageItem(e,!0,n,t)),h=!0;else if(t){const e=l.a.createChildStore(t,{table:oe.b,id:t.id});d=this.outlinerItemTree.state,h=a.b(e)}const p=0===d.length,m=(p||this.props.isHeaderless||e.isMobile)&&this.props.showAddPageButton&&!o,u=p&&!m&&!n,g={offline:re.I,bookmarks:re.G,workspace:re.O,shared:re.M,private:re.K}[this.props.type];return r.createElement(c.a,{style:this.props.style,className:g,loaded:h,showSpinnerTimeout:3e3,spinnerSize:"1em"},d,p&&n&&("shared"===s&&this.isEnhancedSidebarEnabled?this.renderEmptyPinnedPlaceholder():this.renderEmptyDroppable()),m&&this.renderAddPageButton(),u&&this.renderEmptyChildrenPlaceholder())}renderEmptyPinnedPlaceholder(){const{device:e}=this.environment;return r.createElement(w.a,{style:this.props.itemStyle,isMobile:this.props.isMobile},r.createElement("div",{style:le({color:this.theme.lightTextColor,paddingLeft:12},e.isMobile&&{display:"flex",alignItems:"center",height:32})},r.createElement(M.b,{defaultMessage:"No pinned pages",id:"outliner.NoPinnedPages.placeholder"})))}renderEmptyChildrenPlaceholder(){const{device:e}=this.environment;return r.createElement(w.a,{style:this.props.itemStyle,isMobile:this.props.isMobile},r.createElement("div",{style:le({color:this.theme.lightTextColor,paddingLeft:12},e.isMobile&&{display:"flex",alignItems:"center",height:32})},r.createElement(M.b,{defaultMessage:"No pages inside",id:"outliner.NoPagesInside.placeholder"})))}renderAddPageButton(){return r.createElement(H.a,{mobileFeedback:this.props.isMobile,onClick:this.handleCreatePageClick},r.createElement(w.a,{style:{color:this.theme.mediumTextColor},left:this.getPlusIcon(),isMobile:this.props.isMobile,disableMobileBorder:!0},this.props.addPageTitle))}renderPageItem(e,t,n,i){return r.createElement(ne,{isMobile:this.props.isMobile,type:this.props.type,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,key:e.id,store:e,style:this.props.itemStyle,toggleStyle:this.props.itemToggleStyle,isFirstItem:0===n,isTopLevelItem:t,parentStore:i,onNavigate:this.props.onNavigate,onCreatePage:this.props.onCreatePage,disabled:this.props.disabled})}renderEmptyDroppable(){const{currentBlockStore:e}=k.a.state;if(e){const t=l.a.createChildStore(this.props.spaceStore,e.pointer);return r.createElement(v.a,{store:t,canDropBelow:!0,onSelectableDrop:this.handleEmptyDrop,analyticsName:"outliner_item",shouldShowDropZone:!0})}}getPlusIcon(){return r.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},s.a.plus({fill:this.theme.mediumIconColor,width:16,height:16}))}getOutlinerItemsInSubtree(e,t,n,r){let i=!0;const o=e.getType();if(!r.has(e.id)&&(r.add(e.id),o&&de.shouldSkipItemTypes[o]?i=!1:o&&e!==t&&de.shouldShowItemTypes[o]&&(i=!1,n.push(this.renderPageItem(e,!1,n.length,e.recordStoreParent()))),i)){const i=e.getContentStores();for(const e of i){const i=e.getValue();if(i&&i.properties){const t=i.properties.title,r=ie.V(t);if(r)for(const o of r){const t=l.a.createChildStore(e,{table:oe.b,id:o});t.getParentId()===i.id&&n.push(this.renderPageItem(t,!1,n.length,t.recordStoreParent()))}}this.getOutlinerItemsInSubtree(e,t,n,r)}}}get isEnhancedSidebarEnabled(){return"on"===se.a.getGroup(this.environment,"sidebar-enhancements")}}de.shouldShowItemTypes={[o.a.page]:!0,[o.a.collectionView]:!0,[o.a.collectionViewPage]:!0},de.shouldSkipItemTypes={[o.a.factory]:!0};var he=de,pe=n(688),me=n(170),ue=n(2),ge=n(744),be=n(33),ye=n(49),fe=n(1287),Se=n(171),ve=n(92),we=n(55),Ee=n(24),Oe=n(53),ke=n(21),Pe=n(132),Me=n(66),Te=n(83),Ce=n(851),je=n(293);class Ie extends u.a{getInitialState(){return{showUpdateInfo:!1}}}var Be=Ie,xe=n(623),Ae=n(248),De=n(160),Le=n(70);class Re extends i.a{constructor(){super(...arguments),this.storeTypes={store:Be},this.renderUpdateInfo=()=>{const{AppUpdateStore:e}=this.environment,t=e.state.appUpdate?this.renderUpdateState("App.js - ",e.state.appUpdate):r.createElement(M.b,{defaultMessage:"App.js - Waiting…",id:"appVersionMenuItem.waitingForAppJsUpdate.message"}),n=e.state.electronUpdate&&this.renderUpdateState("Electron - ",e.state.electronUpdate);return r.createElement("div",null,t,n)},this.handleResetCache=()=>{const{AppUpdateStore:e,reactNative:t}=this.environment;e.setState({appUpdate:void 0,electronUpdate:e.state.electronUpdate}),t&&t.resetAssetCache()},this.handleShowUpdateInfo=()=>{this.stores.store.setState({showUpdateInfo:!0})}}renderComponent(){const{device:e}=this.environment,t="Notion 2.10.".concat(be.a.version),n=r.createElement(M.b,{id:"appVersionMenuItem.lastUpdatedTime.menuItem",defaultMessage:"Updated {lastUpdatedTime}",description:"Message to tell the user when their current version of the Notion app was last updated.",values:{lastUpdatedTime:Object(Le.a)(be.a.lastUpdatedTime).fromNow()}});let i=r.createElement(r.Fragment,null,t,r.createElement("br",null),n);if(e.isReactNative){const e=xe.a(),o=r.createElement(M.b,{defaultMessage:"Mobile {reactNativeVersionFormatted}",values:{reactNativeVersionFormatted:Object(Ae.g)(e)},id:"appVersionMenuItem.lastUpdatedReactNativeVersion.menuItem"});i=r.createElement(r.Fragment,null,t,r.createElement("br",null),o,r.createElement("br",null),n)}if(e.isElectron){const e=Pe.h(),o=r.createElement(M.b,{defaultMessage:"Desktop {desktopVersionFormatted}",values:{desktopVersionFormatted:Object(Ae.g)(e)},id:"appVersionMenuItem.desktopVersion.menuItem"});i=r.createElement(r.Fragment,null,t,r.createElement("br",null),o,r.createElement("br",null),n)}const o=be.a.isLocalhost||"local"===be.a.env||"development"===be.a.env;if(e.isMobile){const e=o&&this.stores.store.state.showUpdateInfo&&r.createElement("div",null,this.renderUpdateInfo(),r.createElement(H.a,{style:{paddingTop:4},onClick:this.handleResetCache},r.createElement(M.b,{defaultMessage:"Clear cache",id:"appVersionMenuItem.mobile.clearCache.message"})));return r.createElement(De.a,{caption:r.createElement("div",{style:{color:this.theme.lightTextColor}},r.createElement("div",{style:{userSelect:"none",WebkitUserSelect:"none"}},i),e),onClick:o?this.handleShowUpdateInfo:void 0})}return o?r.createElement(E.a,{renderTooltip:this.renderUpdateInfo,placement:E.a.Placement.Left,render:e=>r.createElement(De.a,Object.assign({caption:r.createElement("div",{style:{color:this.theme.lightTextColor}},i)},e))}):r.createElement(De.a,{caption:r.createElement("div",{style:{color:this.theme.lightTextColor}},i)})}renderUpdateState(e,t){return"checking"===t.state?r.createElement("div",null,e," ",r.createElement(M.b,{defaultMessage:"Checking for updates…",id:"appVersionMenuItem.updateStateForApp.checking.message"})):"no-update"===t.state?r.createElement("div",null,e," ",r.createElement(M.b,{defaultMessage:"No update {timeFromNow}",id:"appVersionMenuItem.noUpdatesForApp.message",description:"timeFromNow is a translated message like '2 hours ago' that refers to the time of the last update.",values:{timeFromNow:Object(Le.a)(t.timestamp).fromNow()}})):"downloading"===t.state?r.createElement("div",null,e," ",r.createElement(M.b,{defaultMessage:"Downloading {version} {percentComplete}",id:"appVersionMenuItem.downloadingUpdate.message",values:{percentComplete:this.props.intl.formatNumber(t.progress,{style:"percent",maximumFractionDigits:0}),version:Object(Ae.g)(t.version)}})):"ready"===t.state?r.createElement("div",null,e," ",r.createElement(M.b,{defaultMessage:"Update ready {version}",id:"appVersionMenuItem.updateReady.message",values:{version:Object(Ae.g)(t.version)}})):"error"===t.state?r.createElement("div",null,e," ",r.createElement(M.b,{defaultMessage:"Update error {errorMessage}",id:"appVersionMenuitem.updateError.message",values:{errorMessage:t.error&&t.error.message}})):void 0}}var Fe=Object(M.h)(Re),We=n(106),Ue=n(136),Ne=n(184);var Ve=function(e){const{locale:t,children:n}=e;return t===Ne.a?r.createElement(r.Fragment,null,n):null},_e=n(1495),ze=n(760),He=n(1323),qe=n(89),Ge=n(620);function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ze extends i.a{constructor(){super(...arguments),this.renderOrigin=e=>this.props.isMobile?r.createElement(H.a,Object.assign({hovered:Ce.a.state.open,mobileFeedback:this.props.isMobile},e),r.createElement(w.a,{isMobile:this.props.isMobile,left:s.a.help({fill:this.theme.mediumIconColor,width:16,height:16}),disableMobileBorder:!0},r.createElement(M.b,{defaultMessage:"Help & feedback",id:"helpButton.mobileHelpFeedbackButton.label"}))):r.createElement(r.Fragment,null,r.createElement(E.a,{renderTooltip:()=>r.createElement("span",null,r.createElement(M.b,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:r.createElement("br",null)}})),render:t=>r.createElement(H.a,Object.assign({className:"notion-help-button",style:this.getRoundButtonStyle(),hoveredStyle:{background:this.theme.whiteButtonHoveredBackground},pressedStyle:{background:this.theme.whiteButtonPressedBackground}},Object(ve.a)(e,t)),"?")}),this.renderNag()),this.renderMessageItem=e=>{const{device:t}=this.environment;return t.isElectron?this.renderMessageButton(e):r.createElement(E.a,{key:e.key,renderTooltip:()=>this.renderIntercomTooltip(),delayThreshold:0,placement:E.a.Placement.Right,render:t=>this.renderMessageButton(Object(ve.a)(e,t))})},this.renderSalesItem=e=>{const{device:t}=this.environment;return t.isElectron?this.renderSalesButton(e):r.createElement(E.a,{key:e.key,renderTooltip:()=>this.renderIntercomTooltip(),delayThreshold:0,placement:E.a.Placement.Right,render:t=>this.renderSalesButton(Object(ve.a)(e,t))})},this.renderGuideItem=e=>r.createElement(Oe.a,Object.assign({},e,{isTokenTitle:!0,icon:s.a.helpButtonGuide(this.getIconStyle()),title:r.createElement(M.b,{defaultMessage:"Help & support guide",id:"helpButton.helpSupportGuide.menuItem"})})),this.renderMessageButton=e=>r.createElement(Oe.a,Object.assign({},e,{isTokenTitle:!0,icon:s.a.helpButtonMessage(this.getIconStyle()),title:r.createElement(M.b,{defaultMessage:"Send us a message",id:"helpButton.sendMessage.menuItem"})})),this.renderCsatButton=e=>r.createElement(Oe.a,Object.assign({},e,{isTokenTitle:!0,icon:s.a.feedback(this.getIconStyle()),title:r.createElement(M.b,{defaultMessage:"Give feedback",id:"helpButton.giveFeedback.menuItem"})})),this.renderSalesButton=e=>r.createElement(Oe.a,Object.assign({},e,{isTokenTitle:!0,icon:s.a.helpButtonSales(this.getIconStyle()),title:r.createElement(M.b,{defaultMessage:"Chat with sales",id:"helpButton.salesChat.menuItem"})})),this.renderJoinUsItem=e=>r.createElement(Ve,{locale:"en-US"},r.createElement(Oe.a,Object.assign({},e,{title:r.createElement(M.b,{defaultMessage:"Join us",id:"helpButton.joinUs.menuItem"})}))),this.renderKeyboardShortcutsItem=e=>r.createElement(Oe.a,Object.assign({},e,{title:r.createElement(M.b,{defaultMessage:"Keyboard shortcuts",id:"helpButton.keyboardShortcuts.menuItem"})})),this.renderNewsItem=e=>r.createElement(Oe.a,Object.assign({},e,{title:"What's new?"})),this.renderTermsItem=e=>{const{device:t}=this.environment;return t.isMobile?r.createElement(Oe.a,Object.assign({},e,{title:"Terms & privacy"})):r.createElement(Oe.a,Object.assign({},e,{caption:"Terms & privacy"}))},this.renderTwitterItem=e=>{const{device:t}=this.environment;return t.isMobile?r.createElement(Oe.a,Object.assign({},e,{title:r.createElement(M.b,{defaultMessage:"Twitter – @{notionHandle}",id:"helpButton.mobileTwitter.menuItem",values:{notionHandle:"NotionHQ"}})})):r.createElement(Oe.a,Object.assign({},e,{caption:r.createElement(M.b,{defaultMessage:"Twitter – @{notionHandle}",id:"helpButton.twitter.menuItem",values:{notionHandle:"NotionHQ"}})}))},this.renderStatusItem=e=>{const{device:t}=this.environment;return t.isMobile?r.createElement(Oe.a,Object.assign({},e,{title:"Status"})):r.createElement(Oe.a,Object.assign({},e,{caption:"Status"}))},this.acceptMessageItem=()=>{this.analyticsTrackClickItem("help_feedback"),ge.a({environment:this.environment,from:"help_button"}),this.closePopup()},this.acceptSalesItem=()=>{this.analyticsTrackClickItem("sales_chat");const{currentUserStore:e}=k.a.state,t=e&&e.getValue();He.a.setState({open:!0,email:t&&t.email,name:t&&Object(qe.d)(this.props.intl,t)}),this.closePopup()},this.acceptCsatItem=()=>{this.analyticsTrackClickItem("csat"),_e.a.setState({open:!0,type:ze.f}),this.closePopup()},this.acceptGuideItem=()=>{this.analyticsTrackClickItem("guides"),Z.i({environment:this.environment,url:Object(Ue.a)("guides.guides")}),this.closePopup()},this.acceptKeyboardShortcutsItem=()=>{this.analyticsTrackClickItem("keyboard_shortcuts"),Z.i({environment:this.environment,url:Object(Ue.a)("guides.keyboardShortcuts")}),this.closePopup()},this.acceptTwitterItem=()=>{this.analyticsTrackClickItem("twitter"),Z.i({environment:this.environment,url:Me.K}),this.closePopup()},this.acceptStatusItem=()=>{this.analyticsTrackClickItem("status"),Z.i({environment:this.environment,url:Me.bb}),this.closePopup()},this.acceptJoinUsItem=()=>{this.analyticsTrackClickItem("join_us"),Z.i({environment:this.environment,url:Me.j}),this.closePopup()},this.acceptNewsItem=()=>{Z.i({environment:this.environment,url:Me.pb}),this.analyticsTrackClickItem("whats_new"),this.closePopup()},this.acceptTermsItem=()=>{Z.i({environment:this.environment,url:Me.ib}),this.analyticsTrackClickItem("terms"),this.closePopup()},this.trackClickHelp=()=>{W.z(this.environment)}}renderComponent(){const{device:e}=this.environment,t=this.props.isMobile;return r.createElement(ye.a,{popupType:e.isMobile?ye.a.PopupType.SlideUp:ye.a.PopupType.Popup,renderOrigin:this.renderOrigin,originGap:t?0:12,placementToOrigin:t?ye.a.Placement.Right:ye.a.Placement.Top,alignmentToOrigin:t?ye.a.Alignment.Center:ye.a.Alignment.End,buttonPopupStore:Ce.a,onClick:this.trackClickHelp,render:()=>{const t=this.getSections();let n;return n=e.isMobile?{menuType:ke.b.MenuType.ActionSheet}:{menuType:ke.b.MenuType.Popup,minWidth:208},r.createElement(ke.b,Object.assign({},n),r.createElement(we.a,{type:we.a.Type.Vertical,initialFocus:void 0,sections:t}))}})}renderNag(){if("development"===Object({NODE_ENV:"production",VERSION:"0.2.4",CONFIG:{env:"production",isAdminMode:!1,isLocalhost:!1,offline:!0,version:"23.7.56",baseURL:"https://www.notion.so",protocol:"notion",staticS3:{url:"https://prod-notion-assets.s3-us-west-2.amazonaws.com",bucket:"prod-notion-assets"},lastUpdatedTime:1614040473418,api:{http:"/api/v3"},googleOAuth:{clientId:"905154081809-858sm3f0qnalqd9d44d9gecjtrdji9tf.apps.googleusercontent.com"},messageStore:{url:"https://msgstore.www.notion.so",api:"/api/v1"},stripe:{key:"pk_live_vuNO27XGTCbXjVwneiECILjT"},intercom:{appId:"gpfdrxfd",adminId:"3483686"},segment:{writeKey:"g1mMn2qquRcv7exBIVDivoKl9cOrdxLA"},pricing:{invoiceDaysUntilDue:30,team_free:{spaceBlockLimit:1e3,fileUploadMaxBytes:5e6},personal_free:{fileUploadMaxBytes:5e6},student:{productId:"prod_FhChFoDp7gS1Ba"},personal:{productId:"prod_CpavZFCbxF2YGx",monthlyPrice:500,yearlyPrice:4800},team:{productId:"prod_CpawK4ih14xs4t",monthlyPricePerMember:1e3,yearlyPricePerMember:9600},enterprise:{productId:"prod_Cpb8M1AFEFhdy1",monthlyPricePerMember:2500,yearlyPricePerMember:24e3}},desktopS3:{url:"https://s3-us-west-2.amazonaws.com/desktop-release.notion-static.com"},publicFileS3:{url:"https://s3-us-west-2.amazonaws.com/public.notion-static.com",bucket:"public.notion-static.com"},temporaryFileS3:{url:"https://s3-us-west-2.amazonaws.com/temporary.notion-static.com",bucket:"temporary.notion-static.com"},secureFileS3:{url:"https://s3-us-west-2.amazonaws.com/secure.notion-static.com",bucket:"secure.notion-static.com"},loggly:{token:"edcca201-4028-4ef1-bbb1-c78b430dd74e"},embedly:{key:"421626497c5d4fc2ae6b075189d602a2"},aif:{url:"https://aif.notion.so/aif-production.html"},contentful:{spaceId:"spoqsaf9291f",contentDeliveryToken:"AGqteRpWD8aE_kxy_s7_hSFAlKCh5qf-RctSU6vV6u0",contentPreviewToken:"uR2ZVAs-9TMKDq0YKYVtczFplx6P9p06huCibZDJZKA"},iOSAppId:1232780281}}).ENV)return r.createElement(Ge.a,{fetch:()=>n.e(16).then(n.bind(null,2333)),render:e=>r.createElement(e.UseTheAppReminder,null)})}getSections(){const{device:e}=this.environment,t=We.i(this.environment),n="team"===t||"enterprise"===t,i=!je.a.state.isIntercomEnabled||Object(We.M)(this.environment)&&"on"===se.a.getGroup(this.environment,"hazelnut"),o="on"===se.a.getGroup(this.environment,"csat")&&!this.environment.device.isMobile;return ue.compact([{key:"guide",render:e=>r.createElement(Ee.a,Object.assign({},e)),items:ue.compact([{key:"guide",action:this.acceptGuideItem,render:this.renderGuideItem},i?void 0:{key:"message",action:this.acceptMessageItem,render:this.renderMessageItem},n?{key:"sales",action:this.acceptSalesItem,render:this.renderSalesItem}:void 0,o?{key:"csat",action:this.acceptCsatItem,render:this.renderCsatButton}:void 0])},{key:"middle section",render:e=>r.createElement(Ee.a,Object.assign({},e,{topBorder:!0})),items:ue.compact([{key:"keyboardshortcut",action:this.acceptKeyboardShortcutsItem,render:this.renderKeyboardShortcutsItem},{key:"news",action:this.acceptNewsItem,render:this.renderNewsItem},{key:"join-us",action:this.acceptJoinUsItem,render:this.renderJoinUsItem}])},{key:"botttom section",render:e=>r.createElement(Ee.a,Object.assign({},e,{topBorder:!0})),items:ue.compact([{key:"twitter",action:this.acceptTwitterItem,render:this.renderTwitterItem},{key:"terms",action:this.acceptTermsItem,render:this.renderTermsItem},{key:"status",action:this.acceptStatusItem,render:this.renderStatusItem},e.isElectron&&"production"!==be.a.env?{key:"devtools",action:Pe.k,render:e=>r.createElement(Oe.a,Object.assign({},e,{caption:"Open Dev Tools"}))}:void 0])},{key:"version",render:e=>r.createElement(Ee.a,Object.assign({},e,{topBorder:!0})),items:ue.compact([{key:"version",action:()=>{},render:e=>r.createElement(Fe,Object.assign({},e))}])}])}renderIntercomTooltip(){return r.createElement("span",null,r.createElement(M.b,{defaultMessage:"We use Intercom for messaging.{br}Make sure it's not blocked by your browser.",values:{br:r.createElement("br",null)},id:"helpButton.sendUsAMessage.tooltip"}))}analyticsTrackClickItem(e){W.B(this.environment,{item:e})}closePopup(){Ce.a.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Ce.a.state,{open:!1}))}getRoundButtonStyle(){const{device:e}=this.environment;return{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",background:this.theme.buttonBackground,bottom:16+e.scrollbarWidth,right:16+e.scrollbarWidth,width:36,height:36,borderRadius:"100%",fontSize:20,boxShadow:this.theme.lightBoxShadow,zIndex:Se.e,opacity:Te.p.state?0:1,transition:"\n\t\t\t\topacity ".concat(fe.a.transitionDuration,"ms,\n\t\t\t\tcolor ").concat(fe.a.transitionDuration,"ms\n\t\t\t")}}getIconStyle(){return{width:16,height:16,color:this.theme.regularTextColor,fill:this.theme.regularTextColor}}}var Ye=Object(M.h)(Ze),Xe=n(109),Je=n(852),$e=n(30);function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){nt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rt extends i.a{constructor(){super(...arguments),this.storeTypes={mouseStore:Xe.a,labelMouseStore:Xe.a,outlinerToggleButtonStore:Je.a},this.headerRef=r.createRef(),this.handleHideClick=()=>{const{isHidden:e}=this.stores.outlinerToggleButtonStore.state,t=!e;h.g({spaceViewStore:this.props.spaceViewStore,type:this.props.type,outlinerToggleButtonStore:this.stores.outlinerToggleButtonStore,newValue:t})},this.handleCreatePageClick=()=>{const{type:e,spaceStore:t,spaceViewStore:n}=this.props,{outlinerToggleButtonStore:r}=this.stores;h.c({environment:this.environment,spaceStore:t,spaceViewStore:n,type:e,outlinerToggleButtonStore:r,prepend:!0})}}willMount(e){super.willMount(e);const t=Q.a.get({userId:this.environment.currentUser.id,key:h.d(e.spaceViewStore,e.type)});t&&this.stores.outlinerToggleButtonStore.setState(tt({},this.stores.outlinerToggleButtonStore.state,{isHidden:t}))}renderComponent(){const{renderSidebar:e}=this.props,{isHidden:t}=this.stores.outlinerToggleButtonStore.state;return r.createElement("div",{ref:this.headerRef,onMouseMove:()=>this.stores.mouseStore.setState(tt({},this.stores.mouseStore.state,{mouseEntered:!0})),onMouseLeave:()=>this.stores.mouseStore.setState(tt({},this.stores.mouseStore.state,{mouseEntered:!1})),style:{marginBottom:t?0:rt.marginBottom}},this.renderLabel(),!t&&e(this.headerRef))}renderLabel(){const{showAddPageButton:e}=this.props,{isHidden:t}=this.stores.outlinerToggleButtonStore.state,{labelMouseStore:n}=this.stores,{mouseEntered:i}=n.state,o={bookmarks:re.H,workspace:re.P,shared:re.N,private:re.L,offline:re.J}[this.props.type],s=t?r.createElement(M.b,{defaultMessage:"Click to show section",id:"sidebar.sectionHeaderShow.tooltip"}):r.createElement(M.b,{defaultMessage:"Click to hide section",id:"sidebar.sectionHeaderHide.tooltip"});return r.createElement(w.a,{className:o,isMobile:this.props.isMobile,disableMobileBorder:t,shouldShowMobileMarginBotton:t,style:this.getSectionSidebarItemStyle(),childrenStyle:{overflow:"visible"},right:e&&this.renderAddPageButton()},r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement(E.a,{style:rt.tooltipStyle,textWrap:!0,renderTooltip:()=>r.createElement("div",null,r.createElement("div",null,s),r.createElement("span",{style:{color:this.theme.mediumInvertedTextColor,whiteSpace:"nowrap"}},this.props.labelTooltip)),placement:E.a.Placement.Top,render:e=>{const t=tt({},this.props.isMobile?this.getMobileSectionLabelStyle():this.getSectionLabelStyle(),{transition:"color 100ms ease-out"});return i&&Object.assign(t,this.getSectionLabelHoverStyles()),r.createElement(H.a,Object.assign({mobileFeedback:this.props.isMobile,style:this.getLabelButtonStyle(),onClick:this.handleHideClick},Object(ve.a)(e,{onMouseMove:()=>n.setState(tt({},n.state,{mouseEntered:!0})),onMouseLeave:()=>n.setState(tt({},n.state,{mouseEntered:!1}))})),r.createElement("span",{style:t},this.renderLabelContent()))}})))}renderAddPageButton(){return r.createElement(E.a,{style:rt.tooltipStyle,textWrap:!0,renderTooltip:()=>r.createElement(r.Fragment,null,r.createElement(M.b,{defaultMessage:"Add a page",id:"sidebar.addAPageButton.tooltip"}),r.createElement("br",null),r.createElement("span",{style:{color:this.theme.mediumInvertedTextColor}},this.props.labelTooltip)),placement:E.a.Placement.Right,render:e=>r.createElement(H.a,Object.assign({style:this.getPlusButtonStyle(),mobileFeedback:this.props.isMobile,onClick:this.handleCreatePageClick,className:re.t},e),s.a.plus({fill:this.theme.mediumIconColor,width:12,height:12}))})}renderLabelContent(){const{type:e}=this.props;switch(e){case"bookmarks":return r.createElement(M.b,{defaultMessage:"Favorites",id:"sidebar.favoritesSection.header"});case"workspace":return r.createElement(M.b,{defaultMessage:"Workspace",id:"sidebar.workspaceSection.header"});case"private":return r.createElement(M.b,{defaultMessage:"Private",id:"sidebar.privateSection.header"});case"shared":return r.createElement(M.b,{defaultMessage:"Shared",id:"sidebar.sharedSection.header"});case"offline":return r.createElement(M.b,{defaultMessage:"Offline",id:"sidebar.offlineSection.header"});default:Object($e.e)(e)}}getSectionSidebarItemStyle(){return{paddingTop:0,paddingBottom:0,paddingRight:14,paddingLeft:15,minHeight:24}}getSectionLabelStyle(){return{letterSpacing:"0.03em",textTransform:"uppercase",fontSize:11.5,lineHeight:1,marginBottom:1,color:this.theme.lightTextColor,fontWeight:P.a.fontWeight.semibold}}getMobileSectionLabelStyle(){return{textTransform:"uppercase",fontSize:13,lineHeight:1,color:this.theme.lightTextColor,fontWeight:P.a.fontWeight.semibold}}getSectionLabelHoverStyles(){return{color:this.theme.mediumTextColor}}getLabelButtonStyle(){return tt({display:"flex",alignItems:"center",borderRadius:3,padding:"2px 4px",marginLeft:-4},this.props.isMobile&&{marginBottom:8})}getPlusButtonStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:20,width:20,border:"1px solid ".concat(this.theme.outlineButtonBorder)}}}rt.tooltipStyle={minWidth:200},rt.marginBottom=20;var it=rt,ot=n(438),st=n(255),at=n(181),lt=n(183),ct=n(297),dt=n(220),ht=n(167),pt=n(1290),mt=n(1400),ut=n(154),gt=n(285),bt=n(561),yt=n(264),ft=n(168),St=n(80),vt=n(503),wt=n(77),Et=n(360),Ot=n(588),kt=n(5),Pt=n(91);function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){Ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const jt=Object(M.g)({filterByPlaceholder:{id:"sidebarTrash.filterBy.placeholder",defaultMessage:"Filter by page title…"}});class It extends i.a{constructor(){super(...arguments),this.storeTypes={requestStore:st.a},this.renderTrashPages=(e,t)=>{const{device:n}=this.environment,i=t?t.results:[],{currentBlockStore:o}=k.a.state;if(!o)return;const a=i.map(e=>l.a.createChildStore(o,{table:oe.b,id:e})).filter(e=>e.getValue()&&!ot.a.state.excludePages.has(e.id)).map(e=>({key:e.id,action:t=>{let{event:r}=t;if(r.metaKey){const t=Object(yt.a)({baseUrl:be.a.baseURL,pageId:e.id});Z.i({environment:this.environment,url:t})}else Z.h({environment:this.environment,store:e}),vt.a.setState(Tt({},vt.a.state,{open:!1}));n.isMobile&&dt.b()},render:t=>r.createElement(gt.a,Object.assign({},t,{dontShrinkRight:!0,store:e,right:r.createElement("div",{style:{display:"flex"}},r.createElement(E.a,{placement:E.a.Placement.Bottom,renderTooltip:()=>r.createElement(M.b,{defaultMessage:"Restore",id:"sidebarTrash.restorePageButton.tooltip"}),render:t=>r.createElement(wt.a,Object.assign({isGray:!0,onClick:()=>this.handleRestoreClick(e)},t),s.a.undo({width:18,height:18}))}),r.createElement(E.a,{placement:E.a.Placement.Bottom,renderTooltip:()=>r.createElement(M.b,{defaultMessage:"Delete permanently",id:"sidebarTrash.deletePagePermanentlyButton.tooltip"}),render:t=>r.createElement(wt.a,Object.assign({isGray:!0,onClick:()=>this.handleDeleteClick(e)},t),s.a.trash({width:18,height:18}))}))}))}));return 0===a.length?r.createElement(Ee.a,null,n.isMobile?r.createElement(ut.a,{title:r.createElement(M.b,{defaultMessage:"No matches found.",id:"sidebarTrash.mobileFilterBy.noMatchesPrompt"})}):r.createElement("div",{style:{fontSize:14,color:this.theme.mediumTextColor,textAlign:"center"}},r.createElement(M.b,{defaultMessage:"No matches found.",id:"sidebarTrash.filterBy.noMatchesPrompt"}))):r.createElement(r.Fragment,null,r.createElement(we.a,{type:we.a.Type.Vertical,initialFocus:void 0,sections:[{key:0,items:a,render:e=>r.createElement(Ee.a,Object.assign({},e))}]}),r.createElement(ct.a,{show:this.stores.requestStore.state.loading,showDelay:500,showHold:200,render:e=>{if(e)return r.createElement("div",{style:{height:44,display:"flex",flex:1,alignItems:"center",justifyContent:"center"}},r.createElement(U.a,null))}}),r.createElement(lt.a,{onChange:this.handleScrollOffsetChange}))},this.handleSwipeLeft=()=>{const e=It.tabs.indexOf(ot.a.state.currentTab)+1,t=It.tabs[e];void 0!==t&&this.changeTab(t)},this.handleSwipeRight=()=>{const e=It.tabs.indexOf(ot.a.state.currentTab)-1,t=It.tabs[e];void 0!==t&&this.changeTab(t)},this.handleTabChange=e=>{const t=It.tabs[e];this.changeTab(t)},this.handleRestoreClick=e=>{F.d(this.environment,t=>{bt.c({environment:this.environment,blocks:[e],transaction:t})})},this.handleDeleteClick=e=>{bt.b({environment:this.environment,blocks:[e]})},this.handleSearchInputChange=e=>{ot.a.setState(Tt({},ot.a.state,{filter:e.target.value,limit:ot.a.startLimit}))},this.handleClose=()=>{vt.a.setState(Tt({},vt.a.state,{open:!1}))},this.handleScrollOffsetChange=e=>{const{requestStore:t}=this.stores,{ready:n,loading:r,result:i}=t.state,o=i;e<=ot.a.loadMoreOffset&&o&&n&&!r&&!o.endOfResultsReached&&ot.a.setState(Tt({},ot.a.state,{limit:ot.a.state.limit+ot.a.limitIncrement}))},this.performSearchRequest=async e=>{const{currentSpaceStore:t,currentBlockStore:n}=k.a.state;if(!t||!n)return;const{limit:r,filter:i,currentTab:o}=ot.a.state;let s;if("in_current_page"===o)if(n.isCollectionView()){const e=n.getValue();if(!e||!e.collection_id)return;s=e.collection_id}else s=n.id;return await ft.m({environment:this.environment,query:i,limit:r,ancestorId:s,spaceId:t.id})}}willMount(e){super.willMount(e),ot.a.setState(Tt({},ot.a.state,{filter:"",limit:ot.a.startLimit,excludePages:new Set}))}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:ke.b.MenuType.Modal,title:r.createElement(M.b,{defaultMessage:"Trash",id:"sidebarTrash.menu.header"}),left:this.renderMobileHelpButton(),right:r.createElement(Pt.DoneMenuText,null),onClickRight:this.handleClose,header:this.renderHeader()}:{menuType:ke.b.MenuType.Popup,height:"50vh",width:414,header:this.renderHeader(),footer:this.renderFooter()},r.createElement(mt.a,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>r.createElement(ke.b,Object.assign({},t,e,{className:re.hb}),this.renderPages())})}renderHeader(){const{device:e}=this.environment,t=ot.a.state.currentTab,n=It.tabs.indexOf(t);return r.createElement(r.Fragment,null,r.createElement(pt.a,{tabs:[r.createElement(M.b,{defaultMessage:"All pages",id:"sidebarTrash.allPages.tabHeader"}),r.createElement(M.b,{defaultMessage:"In current page",id:"sidebarTrash.inCurrentPage.tabHeader"})],selectedIndex:n,onChange:this.handleTabChange}),r.createElement("div",{style:{margin:e.isMobile?0:"10px 0"}},r.createElement(ht.a,{left:r.createElement(ct.a,{show:this.stores.requestStore.state.loading,showDelay:500,showHold:200,render:e=>e?r.createElement(U.a,{style:this.getSearchIconStyle()}):s.a.searchThick(this.getSearchIconStyle())}),style:Tt({},e.isAndroid&&{borderBottom:"none"}),showClearButton:!0,placeholder:kt.a.formatMessage(jt.filterByPlaceholder),focus:!e.isMobile||void 0,value:ot.a.state.filter,onChange:this.handleSearchInputChange})))}renderFooter(){return r.createElement(Ee.a,{topBorder:!0,disableDesktopPadding:!0},r.createElement(Et.a,{title:r.createElement(M.b,{defaultMessage:"Learn about deleting and restoring pages",id:"sidebarTrash.learnMore.prompt"}),href:Object(Ue.a)("guides.trash"),analyticsFrom:"trash"}))}renderMobileHelpButton(){return r.createElement(Ot.a,{href:Object(Ue.a)("guides.trash"),analyticsFrom:"trash"})}renderPages(){if(!St.a.state.online)return r.createElement(Ee.a,null,r.createElement(ut.a,{title:r.createElement(M.b,{defaultMessage:"Please go online to view the Trash.",id:"sidebarTrash.goOnline.prompt"})}));{const{filter:e,limit:t,currentTab:n}=ot.a.state,i="".concat(e,":").concat(t).concat(n);return r.createElement(at.a,{requestStore:this.stores.requestStore,request:i,performRequest:this.performSearchRequest,render:this.renderTrashPages,debounce:ft.b})}}changeTab(e){ot.a.setState(Tt({},ot.a.state,{currentTab:e,limit:ot.a.startLimit})),this.stores.requestStore.setState(Tt({},this.stores.requestStore.state,{result:null})),W.qe(this.environment,{tab:e})}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:this.theme.regularIconColor}}}It.tabs=["all_pages","in_current_page"];var Bt=It,xt=n(96);function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(Object(n),!0).forEach((function(t){Lt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Rt extends i.a{constructor(){super(...arguments),this.renderOrigin=e=>{const{isMobile:t,onClick:n}=this.props;return r.createElement(v.a,{store:this.clonedStore,canDropOnto:!0,onSelectableDrop:this.handleDrop,analyticsName:"sibebar_trash",shouldShowDropZone:!0},r.createElement(H.a,Object.assign({onClick:this.handleClick,mobileFeedback:t},Object(ve.a)(e,{onClick:n})),r.createElement(w.a,{left:this.renderIcon(),style:Dt({},vt.a.state.open&&{background:this.theme.buttonHoveredBackground}),isMobile:t,disableMobileBorder:!0},r.createElement(M.b,{defaultMessage:"Trash",id:"sidebarTrashButton.text"}))))},this.renderSidebarTrash=()=>{const{currentSpaceStore:e}=k.a.state;if(e)return r.createElement(Bt,{spaceStore:e})},this.handleClick=e=>{ot.a.setState(Dt({},ot.a.state,{currentTab:"all_pages"})),W.Vc(this.environment)},this.handleDrop=e=>{const{droppedStores:t,duplicate:n}=e;n||F.d(this.environment,e=>{xt.o({environment:this.environment,blocks:t,transaction:e})})}}willMount(e){super.willMount(e),this.clonedStore=e.store.clone()}renderComponent(){const{device:e}=this.environment;return r.createElement(ye.a,{popupType:e.isMobile?ye.a.PopupType.SlideUp:ye.a.PopupType.Popup,buttonPopupStore:vt.a,alignmentToOrigin:ye.a.Alignment.Start,placementToOrigin:ye.a.Placement.Right,originGap:0,onClick:this.handleClick,isFullWidthOnMobile:!0,render:this.renderSidebarTrash,preventScaleTransition:!0,renderOrigin:this.renderOrigin})}renderIcon(){const{device:e}=this.environment,t=this.theme.mediumIconColor;return e.isMobile?s.a.sidebarTrash({fill:t,height:16}):s.a.sidebarTrash({fill:t,width:14})}}var Ft=Rt,Wt=n(487),Ut=n(148),Nt=n(1480),Vt=n(761),_t=n(1485),zt=n(1396),Ht=n(1195),qt=n(586),Gt=n(84),Qt=n(1659),Kt=n(485),Zt=n(125),Yt=n(1478),Xt=n(743);class Jt extends i.a{constructor(){super(...arguments),this.storeTypes={passwordRequestStore:st.a},this.handleClose=()=>{Vt.a.setState({open:!1})},this.handleStartOfWeekToggle=()=>{1===this.getStartDayOfWeek()?Object(Kt.d)(this.environment):Object(Kt.c)(this.environment)}}renderComponent(){const{device:e}=this.environment,t=Vt.a.state.open,n="on"===se.a.getGroup(this.environment,"user-data-consent");return r.createElement(ye.a,{popupType:e.isMobile?ye.a.PopupType.SlideUp:ye.a.PopupType.Popup,buttonPopupStore:Vt.a,renderOrigin:e=>r.createElement(H.a,Object.assign({mobileFeedback:this.props.isMobile},e),r.createElement(w.a,{left:this.renderIcon(),style:{background:t?this.theme.buttonHoveredBackground:"none"},isMobile:this.props.isMobile,disableMobileBorder:!0},r.createElement(M.b,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.label"}))),render:()=>{let t;if(t=e.isMobile?{menuType:ke.b.MenuType.Modal,title:r.createElement(M.b,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.title"}),right:r.createElement(M.b,{defaultMessage:"Done",id:"notificationSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose,whiteBackground:!0}:{menuType:ke.b.MenuType.Popup},St.a.state.online){const{passwordRequestStore:e}=this.stores,{data:i}=Zt.a.state;return r.createElement(ke.b,Object.assign({},t),e.state.loading?r.createElement(U.a,{style:{margin:"50% auto"}}):r.createElement(Ht.a,null,r.createElement(Nt.a,null),r.createElement(qt.a,{size:48,isHidden:!0}),r.createElement(Xt.a,{divider:"full"},r.createElement(M.b,{id:"notificationSettingsButton.generalSection.title",defaultMessage:"General"})),r.createElement(Qt.a,{requestStore:e,isEducationPlan:We.w(i)}),this.renderAppearanceSettings(),n&&this.renderUserDataConsentSettings(),r.createElement(qt.a,{size:32}),r.createElement(zt.a,{onClick:this.handleStartOfWeekToggle,startDayOfWeek:this.getStartDayOfWeek()||0})))}return r.createElement(Ht.a,null,r.createElement(Gt.a,{isSmall:!0,style:{textAlign:"center"}},r.createElement(M.b,{defaultMessage:"Please go online to manage settings.",id:"notificationSettingsButton.goOnline.prompt"})))}})}renderUserDataConsentSettings(){return r.createElement(r.Fragment,null,r.createElement(qt.a,{size:32}),r.createElement(Yt.a,null))}renderAppearanceSettings(){return r.createElement(r.Fragment,null,r.createElement(qt.a,{size:32}),r.createElement(_t.a,null))}renderIcon(){return s.a.sidebarSettings({fill:this.theme.mediumIconColor,width:16})}getStartDayOfWeek(){const{currentUserSettingsStore:e}=k.a.state;if(e){const t=e.getSettings();if(t)return t.start_day_of_week}}}var $t=Jt;class en extends i.a{renderComponent(){const e=r.createElement(M.b,{defaultMessage:"Upgrade to Pro",id:"upgradeMobileButton.upgradeButton.label"});return r.createElement(H.a,{mobileFeedback:!0,onClick:this.showUpgradeModal(this.environment)},r.createElement(w.a,{left:this.renderIcon(),isMobile:!0,disableMobileBorder:!0},e))}renderIcon(){return s.a.settingsUpgradeFilled({fill:this.theme.mediumIconColor,width:16})}showUpgradeModal(e){return()=>{const{reactNative:t}=e;t&&t.openUpgradeModal()}}}var tn=en,nn=n(79),rn=n(1655);class on extends i.a{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:nn.a},this.handleClose=()=>{this.stores.buttonPopupStore.setState({open:!1})}}renderComponent(){if(!We.N(this.environment))return;const{store:e}=this.props,{buttonPopupStore:t}=this.stores;return r.createElement(ye.a,{buttonPopupStore:t,popupType:ye.a.PopupType.SlideUp,renderOrigin:e=>r.createElement(H.a,Object.assign({mobileFeedback:!0},e),r.createElement(w.a,{left:this.renderIcon(),isMobile:!0,disableMobileBorder:!0},r.createElement(M.b,{defaultMessage:"Members",id:"memberSettingsButton.mobileSidebar.label"}))),render:()=>{if(St.a.state.online){const t={menuType:ke.b.MenuType.Modal,title:r.createElement(M.b,{defaultMessage:"Members",id:"memberSettingsButton.mobileMemberSettings.title"}),right:r.createElement(M.b,{defaultMessage:"Done",id:"memberSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose};return r.createElement(ke.b,Object.assign({},t),r.createElement(rn.a,{store:e,isMobile:!0}))}this.renderOffline()}})}renderIcon(){return s.a.teamSize({fill:this.theme.mediumIconColor,width:16})}renderOffline(){return r.createElement(Ht.a,null,r.createElement(Gt.a,{isSmall:!0,style:{textAlign:"center"}},r.createElement(M.b,{defaultMessage:"Please go online to manage members.",id:"memberSettingsButton.goOnline.prompt"})))}}var sn=on,an=n(105),ln=(n(191),n(74)),cn=n(265),dn=n(624),hn=n(389);class pn extends i.a{constructor(){super(...arguments),this.handleTouchStart=e=>{const t={x:e.touches[0].clientX,y:e.touches[0].clientY};cn.b.state?t.x>Object(hn.c)(this.environment)?dn.a.setState({touching:!0,swiping:!1,start:t}):this.handleReset():Object(hn.g)(this.environment)&&t.x<100?dn.a.setState({touching:!0,swiping:!1,start:t}):this.handleReset()},this.handleTouchMove=e=>{if(G.a.state.isDragging)return void this.handleReset();const t=dn.a.state;if(!t.touching)return;const n={x:e.touches[0].clientX,y:e.touches[0].clientY};if(t.swiping)dn.a.setState({touching:!0,swiping:!0,start:t.start,speed:cn.b.state?t.end.x-n.x:n.x-t.end.x,end:n});else{if(Math.abs(n.y-t.start.y)>=25)return void this.handleReset();(!cn.b.state&&n.x-t.start.x>25||cn.b.state&&t.start.x-n.x>25)&&dn.a.setState({touching:!0,swiping:!0,start:t.start,speed:0,end:n})}this.updateTransform()},this.handleTouchEnd=async()=>{const{ThemeStore:e}=this.environment,t=dn.a.state;if(!t.swiping)return;const n=Object(hn.c)(this.environment),r=document.querySelector(Object(hn.g)(this.environment)?".".concat(re.fb):".".concat(re.w)),i=document.querySelector(".".concat(re.w)),o=Math.abs(t.speed)>=8,s=o?"ease-out":"ease-in-out",a="dark"===e.state.mode?", 1px 0 0 ".concat(this.theme.shadowColor.alpha(2*this.theme.shadowOpacity).css()):"",l="\n\t\t\t".concat(this.theme.mediumBoxShadow,"\n\t\t\t").concat(a,"\n\t\t");if(cn.b.state){const e=t.start.x-t.end.x;if(e+25*t.speed>n/2){let t=o?(n-e)/n*200:200;t=Math.max(t,1),r.style.transition="transform ".concat(t,"ms ").concat(s),r.style.transform="translateZ(0)translateX(0px)",Object(hn.g)(this.environment)&&(r.style.boxShadow=l,i.style.transition="filter ".concat(t,"ms ").concat(s),i.style.filter="brightness(1)"),await un(r),dt.b(),this.handleReset()}else r.style.transition="transform ".concat(200,"ms ").concat(s),r.style.transform="translateZ(0)translateX(".concat(n,"px)"),Object(hn.g)(this.environment)&&(r.style.boxShadow=l,i.style.transition="filter ".concat(200,"ms ").concat(s),i.style.filter="brightness(0.7)"),await un(r),this.handleReset()}else{const e=t.end.x-t.start.x;if(e+25*t.speed>n/2){let t=o?(n-e)/n*200:200;t=Math.max(t,1),r.style.transition="transform ".concat(t,"ms ").concat(s),r.style.transform="translateZ(0)translateX(".concat(n,"px)"),Object(hn.g)(this.environment)&&(r.style.boxShadow=l,i.style.transition="filter ".concat(t,"ms ").concat(s),i.style.filter="brightness(0.7)"),await un(r),dt.d(),this.handleReset()}else r.style.transition="transform ".concat(200,"ms ").concat(s),r.style.transform="translateZ(0)translateX(0px)",Object(hn.g)(this.environment)&&(r.style.boxShadow=l,i.style.transition="filter ".concat(200,"ms ").concat(s),i.style.filter="brightness(1)"),await un(r),this.handleReset()}},this.handleSidebarToggle=()=>{this.updateTransform()},this.updateTransform=async()=>{const e=document.querySelector(Object(hn.g)(this.environment)?".".concat(re.fb):".".concat(re.w)),t=document.querySelector(".".concat(re.w)),n=Object(hn.c)(this.environment),r=dn.a.state;if(r.swiping)if(cn.b.state){const i=n-(r.start.x-r.end.x)+25,o=Math.min(Math.max(0,i),n);if(e.style.transition="none",e.style.transform="translateZ(0)translateX(".concat(o,"px)"),Object(hn.g)(this.environment)){e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="none";const r=(1-.3*o/n).toString();t.style.filter="brightness(".concat(r,")")}}else{const i=r.end.x-r.start.x-25,o=Math.min(Math.max(0,i),n);if(e.style.transition="none",e.style.transform="translateZ(0)translateX(".concat(o,"px)"),Object(hn.g)(this.environment)){e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="none";const r=(1-.3*o/n).toString();t.style.filter="brightness(".concat(r,")")}}else cn.b.state?(e.style.transition="transform 200ms",e.style.transform="translateZ(0)translateX(".concat(n,"px)"),Object(hn.g)(this.environment)&&(e.style.transform="translateZ(0)translateX(calc(".concat(n,"px - 1px))"),e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="filter 200ms",t.style.filter="brightness(0.7)"),N.e(this.environment)):(e.style.transition="transform 200ms",e.style.transform="translateZ(0)translateX(0)",Object(hn.g)(this.environment)&&(e.style.boxShadow="none",t.style.transition="filter 200ms",t.style.filter="brightness(1)"))}}didMount(){const{device:e}=this.environment;e.isMobile&&(window.addEventListener("touchstart",this.handleTouchStart),window.addEventListener("touchmove",this.handleTouchMove),window.addEventListener("touchend",this.handleTouchEnd),cn.b.addListener(this.handleSidebarToggle))}willUnmount(){const{device:e}=this.environment;e.isMobile&&(window.removeEventListener("touchstart",this.handleTouchStart),window.removeEventListener("touchmove",this.handleTouchMove),window.removeEventListener("touchend",this.handleTouchEnd),cn.b.removeListener(this.handleSidebarToggle))}handleReset(){dn.a.reset(),this.updateTransform()}}var mn=pn;async function un(e){const t=ln.c();e.addEventListener("transitionend",t.resolve),e.addEventListener("webkitTransitionEnd",t.resolve),await t.promise,e.removeEventListener("transitionend",t.resolve),e.removeEventListener("webkitTransitionEnd",t.resolve)}var gn=n(499),bn=n(365),yn=n(19),fn=n(126),Sn=n(414),vn=n(763),wn=n(251),En=n(117),On=n(1292),kn=n(526);function Pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(n),!0).forEach((function(t){Tn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Cn extends i.a{renderComponent(){const{device:e}=this.environment,{onClick:t,focused:n,isAddButton:i,title:o,caption:a,shortcut:l,isOnlySpace:c,disabled:d}=this.props,h=this.environment.device.isMobile,p=this.props.isCheck;return r.createElement(H.a,{mobileFeedback:this.environment.device.isMobile,onClick:t,hovered:n,disabled:d,style:this.getStyle()},!c&&!h&&this.renderDragHandle(),i?this.renderAddIcon():this.renderIcon(),r.createElement("div",{style:{marginLeft:12,marginRight:l||p?12:0,minWidth:0}},r.createElement(Gt.a,{className:"notranslate",isMobile:e.isMobile},o),a&&r.createElement(Gt.a,{isSmall:!0,isMobile:e.isMobile},a)),p&&s.a.check({width:16,height:16,marginLeft:"auto"}),l&&!h&&!p&&r.createElement("div",{style:this.getShortcutStyle()},l))}renderDragHandle(){return r.createElement(kn.a,{iconSize:12,style:{marginLeft:-6,marginRight:4,visibility:this.props.isAddButton?"hidden":"visible"}})}renderIcon(){const e=this.environment.device.isMobile;return r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement("div",{style:{position:"relative"}},this.props.id&&r.createElement(S.a,{disabled:!0,icon:this.props.icon,isEmptyPage:!1,title:this.props.title,size:e?Cn.mobileIconSize:Cn.desktopIconSize,isLarge:!0}),r.createElement(On.a,{color:On.a.Color.Red,count:this.props.unreadMentions,style:{position:"absolute",top:-5,right:-5}})))}renderAddIcon(){const e=this.environment.device.isMobile?Cn.mobileIconSize:Cn.desktopIconSize;return r.createElement("div",{style:Mn({},this.getIconWrapStyle(),{width:e,height:e})},this.getPlusIcon())}getStyle(){const e=this.environment.device.isMobile,{WindowSizeStore:t}=this.environment,{disabled:n}=this.props;return Mn({display:"flex",alignItems:"center",lineHeight:"120%",width:"100%",paddingTop:e?8:4,paddingBottom:e?8:4,paddingLeft:e?t.getSafePaddingLeftCSS(16):14,paddingRight:e?t.getSafePaddingRightCSS(16):14},e&&{boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor)},{marginBottom:1,fontSize:e?16:14},e&&{background:this.theme.popoverBackground},{height:e?54:48},this.props.isAddButton&&!e&&{boxShadow:"none",marginBottom:0},{},n&&{opacity:.4})}getPlusIcon(){return s.a.plus({flexGrow:0,flexShrink:0,width:16,height:16,fill:this.theme.popoverBackground})}getIconWrapStyle(){return{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:this.theme.lightIconColor,borderRadius:3,flexShrink:0}}getShortcutStyle(){return{color:this.theme.lightTextColor,fontSize:12,whiteSpace:"nowrap",marginLeft:"auto",flexShrink:0}}}Cn.contextTypes=Mn({},ke.c),Cn.mobileIconSize=36,Cn.desktopIconSize=32,Cn.dragHandleEffectiveWidth=16;var jn=Cn,In=n(405),Bn=n(151);function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function An(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(n),!0).forEach((function(t){Dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ln extends i.a{renderComponent(){const{device:e}=this.environment,t=e.isElectronMac&&Te.p.state;return r.createElement(E.a,{renderTooltip:()=>r.createElement("div",null,r.createElement("div",null,r.createElement(M.b,{defaultMessage:"Close sidebar",id:"sidebarUnexpandButton.closeSidebar.tooltip"})),r.createElement(In.a,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleSidebar"})),originGap:6,render:n=>r.createElement(fn.a,{isVisible:!0,animationStyle:{opacity:t?0:1},render:()=>r.createElement(Bn.a,Object.assign({icon:s.a.doubleChevronLeft,style:An({position:"relative"},e.isMobile&&{height:"100%"}),mobileFeedback:e.isMobile,onClick:()=>dt.g({environment:this.environment,isExpanded:!1}),className:re.n},n))})})}}var Rn=Ln,Fn=n(343);class Wn extends i.a{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:nn.a}}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:ke.b.MenuType.ActionSheet}:{menuType:ke.b.MenuType.Popup},r.createElement("div",{style:this.getContainerStyle()},r.createElement("div",{style:this.getTextStyle()},this.props.emailAddress),r.createElement(ye.a,{popupType:e.isMobile?ye.a.PopupType.SlideUp:ye.a.PopupType.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>{if(!this.props.disabled)return r.createElement(H.a,Object.assign({},e,{style:this.getButtonStyle()}),s.a.dots(this.getButtonIconStyle()))},render:()=>r.createElement(ke.b,Object.assign({},t),r.createElement(Fn.a,{sections:Object(_.f)(this.props.userId),context:{environment:this.environment,blocks:[]}}))}))}getButtonStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:e.isMobile?24:20,height:e.isMobile?24:20,borderRadius:3}}getButtonIconStyle(){const{device:e}=this.environment;return{width:e.isMobile?18:12,height:e.isMobile?18:12}}getContainerStyle(){return{marginTop:this.environment.device.isMobile?20:8,marginLeft:12,marginRight:12,display:"flex",alignItems:"center",justifyContent:"space-between",color:this.theme.mediumTextColor}}getTextStyle(){return{fontSize:this.environment.device.isMobile?14:11,lineHeight:P.a.lineHeight.UISmall.desktop,fontWeight:P.a.fontWeight.medium}}}var Un=Wn,Nn=n(156),Vn=n(631),_n=n(550),zn=n(252),Hn=n(627);class qn extends i.a{renderComponent(){return r.createElement("div",{style:this.getPlaceholderPageStyle()},this.props.showIcon&&s.a.templates({width:16,height:16,fill:this.theme.buttonHoveredBackground}),r.createElement("div",{style:this.getPlaceholderTextWrapStyle()},r.createElement("div",{style:qn.getPlaceholderTextStyle(this.theme)})))}getPlaceholderPageStyle(){return{height:28,display:"flex",alignItems:"center",width:"100%",padding:this.props.showIcon?"0 15px":"0 0px"}}getPlaceholderTextWrapStyle(){return{flexGrow:1,marginLeft:this.props.showIcon?10:0,height:28,display:"flex",alignItems:"center"}}static getPlaceholderTextStyle(e){const t=Math.ceil(60),n=Math.floor(85),r=Math.floor(Math.random()*(n-t+1))+t+"%";return{height:4,background:e.buttonHoveredBackground,width:r}}}var Gn=qn,Qn=n(120);function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){Yn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Xn extends i.a{willMountOrUpdate(){"store"===this.props.type&&this.props.spaceStore.getValue()}renderComponent(){const{device:e}=this.environment,{props:t}=this,{activeUserEmailAddress:n,isMobile:i,style:o,showExpand:a}=t,l="store"===t.type?Object(Qn.getSpaceName)(this.environment,t.spaceStore):t.spaceName;return r.createElement(w.a,{style:Zn({overflow:"hidden",width:"100%"},i&&{fontSize:14,padding:0,marginRight:12},{},o||{}),left:l?this.renderRecordIcon(l,"store"===t.type?void 0:t.spaceIcon,i,"store"===t.type?t.spaceStore:void 0):this.renderPlaceholderRecordIcon(),isMobile:i,disableMobileBorder:!0},!l&&this.renderPlaceholderTitle(),l&&r.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:n?"space-between":"start"},className:"notranslate"},r.createElement("div",{style:Zn({display:"flex",flexDirection:"column",marginRight:6,marginTop:e.isAndroid?3:0},Xn.truncateStyle)},r.createElement("div",{style:Zn({color:this.theme.regularTextColor,fontWeight:P.a.fontWeight.medium},Xn.truncateStyle)},l),r.createElement("div",{style:Zn({color:this.theme.mediumTextColor,fontSize:11,lineHeight:"12px",fontWeight:P.a.fontWeight.regular},Xn.truncateStyle)},n)),a&&r.createElement("div",{style:{flexGrow:0,flexShrink:0,width:12,height:12,fill:this.theme.mediumIconColor}},s.a.expand())))}renderRecordIcon(e,t,n,i){const o=i?Object(Qn.getSpaceIcon)(this.environment,i):t?{icon:t,table:"space",id:"undefined"}:void 0,s=i?Object(Qn.getSpaceName)(this.environment,i):e;return r.createElement(S.a,{disabled:!0,icon:o,isEmptyPage:!1,title:s,size:n?24:20,style:{marginTop:1,color:this.theme.regularTextColor}})}renderPlaceholderRecordIcon(){return r.createElement("div",{style:{opacity:.25}},r.createElement(Hn.a,{size:20,title:void 0}))}renderPlaceholderTitle(){return r.createElement(Gn,{showIcon:!1})}}Xn.truncateStyle={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"};var Jn=Xn,$n=n(1322),er=n(749),tr=n(506);const nr=new nn.a,rr=new nn.a;var ir=n(742),or=(n(135),n(153)),sr=n(748),ar=n(759);function lr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dr extends i.a{renderComponent(){return r.createElement(H.a,{onClick:this.props.onClick,style:this.getStyle(),hoveredStyle:this.getHoveredStyle()},s.a.appleLogo({width:16,height:16,marginRight:6,marginBottom:2}),r.createElement(M.b,{id:"loginForm.loginWithAppleButton.label",defaultMessage:"Continue with Apple"}))}getStyle(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lr(Object(n),!0).forEach((function(t){cr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",height:36,borderRadius:3,color:yn.f.regularTextColor,fill:yn.f.regularTextColor,background:yn.f.white,fontSize:14,lineHeight:1,paddingLeft:12,paddingRight:12,fontWeight:P.a.fontWeight.medium,border:"light"===this.theme.mode?"1px solid ".concat(this.theme.regularTextColor):"none",width:"100%"},this.props.style,{boxShadow:"0 1px 2px rgba(15, 15, 15, 0.1)"})}getHoveredStyle(){return{background:"light"===this.theme.mode?this.theme.buttonHoveredBackground:yn.f.whiteWithAlpha(.8)}}}var hr=dr,pr=n(483),mr=n(40),ur=n(223);function gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gr(Object(n),!0).forEach((function(t){yr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fr extends i.a{constructor(){super(...arguments),this.emailInputId=ue.uniqueId("notion-email-input-"),this.passwordInputId=ue.uniqueId("notion-password-input-"),this.storeTypes={loginStore:er.a,loginPermissionsStore:$n.a},this.handleHiddenPasswordInputChange=e=>{const{loginStore:t}=this.stores,n=br({},t.state,{password:e.currentTarget.value,alert:void 0});t.setState(n)},this.handleEmailChange=e=>{const{loginStore:t}=this.stores,n=br({},t.state,{email:e.target.value,alert:void 0});t.isPassword()||t.isTemporaryPasscode()||t.isReverifying()?t.setState(br({},n,{loginType:"email",password:""})):t.setState(n)},this.handleEmailLoginClick=async()=>{const{loginStore:e}=this.stores;if(e.isEmail()){const{email:t}=e.state,n=await mr.l(this.environment,{email:t,allowAdminBypass:!0});if("failed"===n.type)return;const r=n.data.samlRedirect;if(r&&r.enforced)return e.setState(br({},e.state,{loginType:"saml",alert:"Redirecting you to use SAML SSO"})),void this.handleSamlLoginClick();n.data.hasPassword?n.data.mustReverify?await wn.r({environment:this.environment,store:e,reverify:!0}):e.setState(br({},e.state,{loginType:"password",alert:void 0})):(e.setState(br({},e.state,{hasAccount:Boolean(n.data.hasAccount)})),wn.r({environment:this.environment,store:e}))}},this.handleTemporaryPasscodeLoginClick=async()=>{const{loginStore:e}=this.stores;if(e.isReverifying()){const{password:t,sentEmailPasscodeState:n}=e.state,r=await wn.t({environment:this.environment,state:n,password:t});r?e.setState(br({},e.state,{alert:r})):e.setState(br({},e.state,{loginType:"password",password:"",reverified:!0,alert:void 0}))}if(e.isTemporaryPasscode()){const{password:t,sentEmailPasscodeState:n}=e.state,r=await wn.j({environment:this.environment,state:n,password:t});r&&e.setState(br({},e.state,{alert:r}))}},this.handlePasswordLoginClick=async()=>{const{loginStore:e}=this.stores,{email:t,password:n}=e.state,r=await wn.i({environment:this.environment,email:t,password:n});e.setState(br({},e.state,{alert:r}))},this.handleResetPasswordClick=async()=>{wn.q({environment:this.environment,store:this.stores.loginStore})},this.handleSamlLoginClick=async()=>{const{device:e}=this.environment,{loginStore:t}=this.stores;if(t.isSaml()){const{email:n}=t.state;if(n){const r=e.isElectron?"nativeredirect":e.isNative?"native":void 0,i=await mr.T(this.environment,{email:n,callbackType:r});if("failed"===i.type)return void t.setState(br({},t.state,{alert:Object(ur.b)(this.props.intl,i)}));t.setState(br({},t.state,{alert:void 0}));const o=i.data.redirectUrl;o&&wn.n(this.environment,o)}}},this.handleLoginWithAppleClick=async()=>{wn.o({environment:this.environment,store:this.stores.loginStore})}}renderComponent(){const{loginStore:e}=this.stores,{isSignup:t}=this.props;return r.createElement("div",{className:re.C,style:br({},fr.wrapStyle,{},this.props.style)},this.renderLoginWithGoogleButton(),this.renderLoginWithAppleButton(),r.createElement("div",{style:{width:"100%"}},this.renderLoginForm(),this.renderAlert(),!t&&this.renderForgotPassword(),!be.a.isAdminMode&&this.renderLoginOptions({email:!(e.isEmail()||e.isTemporaryPasscode()||e.isPassword()||e.isReverifying()),saml:!e.isSaml()})),this.renderDisclaimer())}renderLoginForm(){var e=this;const{loginStore:t}=this.stores,{email:n,password:i}=t.state;return t.isEmail()?r.createElement("form",null,this.renderEmailInput({email:n,onSubmit:this.handleEmailLoginClick}),r.createElement(or.b,{type:"password",autoComplete:"current-password",style:{opacity:0,height:0,padding:0,pointerEvents:"none"},inputElementAttributes:{tabIndex:-1,"aria-hidden":!0},onChange:this.handleHiddenPasswordInputChange}),r.createElement(ar.a,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleEmailLoginClick},r.createElement(M.b,{id:"loginForm.continueWithEmailButton.label",defaultMessage:"Continue with email"}))):t.isPassword()?r.createElement("form",null,this.renderEmailInput({email:n,onSubmit:this.handlePasswordLoginClick}),t.state.reverified&&r.createElement("div",{style:this.getEmailSentCaptionStyle()},r.createElement("span",{style:{paddingRight:4}},this.renderCheck()),r.createElement(M.b,{id:"loginForm.reverifyPasswordLabel",defaultMessage:"<emailverifiedtext>Email verified</emailverifiedtext>. You can continue logging in with your password.",values:{emailverifiedtext:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.createElement("span",{style:{color:e.theme.regularTextColor}},n)}}})),r.createElement(sr.a,{forId:this.passwordInputId},r.createElement(M.b,{id:"loginForm.passwordInput.label",defaultMessage:"Password"})),this.renderPasswordInput({password:i,inputType:"password",placeholderType:"enter_password",onSubmit:this.handlePasswordLoginClick,intl:this.props.intl}),r.createElement(ar.a,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handlePasswordLoginClick},r.createElement(M.b,{id:"loginForm.continueWithPasswordButton.label",defaultMessage:"Continue with password"}))):t.isPasswordResetSent()?r.createElement(r.Fragment,null,r.createElement(qt.a,{size:42}),r.createElement("div",{style:this.getEmailSentCaptionStyle()},r.createElement(M.b,{id:"loginForm.passwordResetSentMessage",defaultMessage:"Check your inbox for the link to reset your password."}))):t.isForgotPassword()?r.createElement("form",null,this.renderEmailInput({email:n,onSubmit:this.handleResetPasswordClick}),r.createElement(ar.a,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleResetPasswordClick},r.createElement(M.b,{id:"loginForm.sendResetLink",defaultMessage:"Send reset link"}))):t.isReverifying()?r.createElement("form",null,this.renderEmailInput({email:n,onSubmit:this.handleTemporaryPasscodeLoginClick}),r.createElement("div",{style:this.getEmailSentCaptionStyle()},r.createElement(M.a,{id:"loginForm.reverifySentMessage",defaultMessage:"This account requires email verification. Please check your inbox and paste in the verification code."})),r.createElement(sr.a,{forId:this.passwordInputId},r.createElement(M.b,{id:"loginForm.verificationCodeInput.label",defaultMessage:"Verification code"})),this.renderPasswordInput({password:i,inputType:"text",placeholderType:"reverify",onSubmit:this.handleTemporaryPasscodeLoginClick,intl:this.props.intl}),r.createElement(ar.a,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleTemporaryPasscodeLoginClick},r.createElement(M.b,{id:"loginForm.continueWithReverifyButton.label",defaultMessage:"Verify email"}))):t.isTemporaryPasscode()?r.createElement("form",null,this.renderEmailInput({email:n,onSubmit:this.handleTemporaryPasscodeLoginClick}),r.createElement("div",{style:this.getEmailSentCaptionStyle()},this.stores.loginStore.state.hasAccount||!vn.a(this.environment)?r.createElement(M.b,{id:"loginForm.temporaryPasscodeSentMessage",defaultMessage:"We just sent you a temporary login code.{br}Please check your inbox.",values:{br:r.createElement("br",null)}}):r.createElement(M.b,{id:"loginForm.temporaryPasscodeSentMessageNoAccount",defaultMessage:"We just sent you a temporary sign up code. Please check your inbox and paste the sign up code below."})),r.createElement(sr.a,{forId:this.passwordInputId},this.stores.loginStore.state.hasAccount||!vn.a(this.environment)?r.createElement(M.b,{id:"loginForm.loginCodeInput.label",defaultMessage:"Login code"}):r.createElement(M.b,{id:"loginForm.signUpCodeInput.label",defaultMessage:"Sign up code"})),this.renderPasswordInput({password:i,inputType:"text",placeholderType:this.props.emailPasscodePlaceholderType,onSubmit:this.handleTemporaryPasscodeLoginClick,intl:this.props.intl}),r.createElement(ar.a,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleTemporaryPasscodeLoginClick},this.stores.loginStore.state.hasAccount||!vn.a(this.environment)?r.createElement(M.b,{id:"loginForm.continueWithLoginCodeButton.label",defaultMessage:"Continue with login code"}):r.createElement(M.b,{id:"loginForm.createNewAccountButton.label",defaultMessage:"Create new account"}))):t.isSaml()?r.createElement("form",null,this.renderEmailInput({email:t.state.email,onSubmit:this.handleSamlLoginClick}),r.createElement(ar.a,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleSamlLoginClick},r.createElement(M.b,{id:"loginForm.continueWithSAMLButton.label",defaultMessage:"Continue with SAML"}))):void 0}renderLoginWithGoogleButton(){return r.createElement(ar.a,{variant:"primary",isFullWidth:!0,style:{marginBottom:4},onClick:e=>{wn.p({environment:this.environment,store:this.stores.loginStore,permissionsStore:this.stores.loginPermissionsStore})}},s.a.googleLogo({fill:"currentColor",width:14,height:14,marginRight:6}),r.createElement(M.b,{id:"loginForm.loginWithGoogleButton.label",defaultMessage:"Continue with Google"}))}renderLoginWithAppleButton(){if(!be.a.isAdminMode)return r.createElement(hr,{style:{marginTop:10},onClick:this.handleLoginWithAppleClick})}renderCheck(){return s.a.thinCheck({display:"inline",height:12,width:12,color:this.theme.regularTextColor})}renderLoginOptions(e){const{email:t,saml:n}=e;if(t||n)return r.createElement("div",{style:this.getCaptionStyle()},t&&n?this.renderContinueWithEmailOrSaml():t?this.renderContinueWithEmail():this.renderContinueWithSaml())}renderContinueWithEmailOrSaml(){var e=this;return r.createElement(M.b,{id:"loginForm.otherLoginOptions.continueWithEmailOrSAML",defaultMessage:"You can also <emailloginlink>continue with email</emailloginlink> or <samlloginlink>continue with SAML SSO</samlloginlink>",values:{emailloginlink:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.createElement(pr.a,{onClick:()=>{e.stores.loginStore.setState(br({},e.stores.loginStore.state,{loginType:"email",alert:void 0}))}},n)},samlloginlink:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.createElement(pr.a,{onClick:()=>{e.stores.loginStore.setState(br({},e.stores.loginStore.state,{loginType:"saml",alert:void 0}))}},n)}}})}renderContinueWithEmail(){var e=this;return r.createElement(M.b,{id:"loginForm.otherLoginOptions.continueWithEmail",defaultMessage:"You can also <emailloginlink>continue with email</emailloginlink>",values:{emailloginlink:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.createElement(pr.a,{onClick:()=>{e.stores.loginStore.setState(br({},e.stores.loginStore.state,{loginType:"email",alert:void 0}))}},n)}}})}renderContinueWithSaml(){var e=this;return r.createElement(M.b,{id:"loginForm.otherLoginOptions.continueWithSAML",defaultMessage:"You can also <samlloginlink>continue with SAML SSO</samlloginlink>",values:{samlloginlink:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.createElement(pr.a,{onClick:()=>{e.stores.loginStore.setState(br({},e.stores.loginStore.state,{loginType:"saml",alert:void 0}))}},n)}}})}renderEmailInput(e){const{email:t,onSubmit:n}=e,i="email"===this.props.emailLabelType?r.createElement(M.b,{id:"loginForm.emailInput.label",defaultMessage:"Email",description:"Label for email input field if user is logging in with a normal email address"}):r.createElement(M.b,{id:"loginForm.workEmailInput.label",defaultMessage:"Work email",description:"Label for email input field if user is logging in with a company email address"});return r.createElement(r.Fragment,null,r.createElement(qt.a,{size:42}),r.createElement(sr.a,{forId:this.emailInputId},i),r.createElement(or.b,{id:this.emailInputId,value:t,type:"email",format:or.b.Format.Large,style:this.getInputStyle(),placeholder:this.props.intl.formatMessage({id:"loginForm.emailInput.placeholder",defaultMessage:"Enter your email address..."}),onSubmit:n,autoComplete:"username",showClearButton:!0,autoFocus:this.props.emailInputAutoFocus,onChange:this.handleEmailChange}))}renderPasswordInput(e){const{password:t,inputType:n,placeholderType:i,intl:o,onSubmit:s}=e;let a="";const l=this.stores.loginStore.state.hasAccount,c=!vn.a(this.environment);switch(i){case"enter_password":a=o.formatMessage({id:"loginForm.passcodeInput.enterPasswordPlaceholder",defaultMessage:"Enter your password..."});break;case"enter_code":a=l||!c?o.formatMessage({id:"loginForm.passcodeInput.enterCodePlaceholder",defaultMessage:"Enter login code"}):o.formatMessage({id:"loginForm.passcodeInput.enterSignupCodePlaceholder",defaultMessage:"Enter sign up code"});break;case"paste_code":a=l||!c?o.formatMessage({id:"loginForm.passcodeInput.pasteCodePlaceholder",defaultMessage:"Paste login code"}):o.formatMessage({id:"loginForm.passcodeInput.pasteSignupCodePlaceholder",defaultMessage:"Paste sign up code"});break;case"reverify":a=o.formatMessage({id:"loginForm.passcodeInput.reverifyPlaceholder",defaultMessage:"Paste verification code"})}return r.createElement(or.b,{id:this.passwordInputId,type:n,value:t,style:this.getInputStyle(),format:or.b.Format.Large,placeholder:a,onSubmit:s,autoFocus:!0,autoComplete:"text"===n?"one-time-code":"current-password",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:e=>{this.stores.loginStore.setState(br({},this.stores.loginStore.state,{password:"text"===n?e.target.value.trim():e.target.value,alert:void 0}))}})}renderForgotPassword(){const{loginStore:e}=this.stores;if(e.isPassword()||e.isEmail())return r.createElement("div",{style:this.getCaptionStyle()},r.createElement(pr.a,{onClick:()=>{e.setState(br({},e.state,{loginType:"forgot",password:"",alert:void 0}))}},r.createElement(M.b,{id:"loginForm.forgotPasswordLink",defaultMessage:"Forgot password?"})))}renderAlert(){const{alert:e}=this.stores.loginStore.state,t=e&&e.split("User:")[1]||e;return r.createElement("div",{style:{fontSize:14,color:yn.f.redWithAlpha(1),textAlign:"center",display:t?"block":"none",width:"100%"}},t)}renderDisclaimer(){const{device:e}=this.environment;return this.props.disableDisclaimer?null:r.createElement("div",{style:{width:e.isMobile?"100%":500,marginTop:64,fontSize:12,color:this.theme.lightTextColor,textAlign:e.isMobile?"left":"center"}},r.createElement("p",{style:{marginBottom:0}},r.createElement(M.b,{id:"loginForm.disclaimer",description:"Terms and conditions for using the app",defaultMessage:"By clicking “Continue with Google/Email/SAML” above, you acknowledge that you have read and understood, and agree to Notion's <termsandconditionslink>Terms & Conditions</termsandconditionslink> and <privacypolicylink>Privacy Policy</privacypolicylink>.",values:{termsandconditionslink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.createElement(pr.a,{href:Me.hb},t)},privacypolicylink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.createElement(pr.a,{href:Me.P},t)}}})))}getInputStyle(){const{device:e}=this.environment;return br({marginTop:4,marginBottom:8,boxShadow:this.theme.inputBoxShadow},e.isMobile&&{lineHeight:"30px"})}getCaptionStyle(){return br({color:this.theme.mediumTextColor,fontSize:14,lineHeight:1.6,marginTop:8,textAlign:"center"},this.props.captionStyle)}getEmailSentCaptionStyle(){return br({fontSize:14,textAlign:"center",marginTop:8,marginBottom:8,width:"100%",color:this.theme.mediumTextColor},this.props.emailPasswordSentPromptStyle)}}fr.wrapStyle={width:"100%",display:"flex",flexDirection:"column",alignItems:"center"};var Sr=Object(M.h)(fr);function vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(n),!0).forEach((function(t){Er(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Or extends i.a{constructor(){super(...arguments),this.storeTypes={loginStore:er.a,loginPermissionsStore:$n.a},this.renderLoginAction=e=>{const{device:t}=this.environment;return r.createElement(me.b,{type:me.b.OverflowType.Y,style:{height:"100%"}},!t.isMobile&&r.createElement("div",{style:this.getCancelStyle(),onClick:()=>tr.a.setState(wr({},tr.a.getState(),{open:!1}))},r.createElement(M.b,{defaultMessage:"Cancel",id:"sidebarSwitcherMultiAccount.addAccountModal.cancelButton.label"})),r.createElement("div",{style:this.getLoginActionWrapperStyle()},r.createElement("div",{style:this.getTitleStyle()},r.createElement(M.b,Object.assign({},Object(hn.e)(this.props.intl,e)))),r.createElement("div",{style:this.getDescriptionStyle()},this.renderDescription(e)),r.createElement(an.a,{capture:!0,onBackspace:ue.identity,onLeft:ue.identity,onRight:ue.identity,onSelectAll:ue.identity,onRedo:ue.identity,onUndo:ue.identity,onCut:ue.identity,onCopy:ue.identity,onPaste:ue.identity,onKeypress:ue.identity,onDelete:ue.identity,onTab:ue.identity},r.createElement(Sr,Object.assign({style:this.getLoginActionStyle(),emailPasscodePlaceholderType:"enter_code",emailLabelType:"email",emailInputAutoFocus:!0,disableDisclaimer:!0},this.stores)))))},this.renderAccountActionModal=()=>{const{open:e,createType:t}=tr.a.state;return r.createElement(ir.a,{open:e,innerStyle:this.getModalStyle(),onDismiss:()=>{tr.a.reset(),this.stores.loginStore.reset()},render:()=>{if(t)return this.renderLoginAction(t)},className:re.ib})},this.getAccountActionStyle=()=>{const{device:e}=this.environment;return{display:"flex",color:this.theme.mediumTextColor,whiteSpace:"nowrap",fontSize:e.isMobile?16:12}}}willMount(e){super.willMount(e);const{loginStore:t}=this.stores;"email"===t.state.loginType&&this.environment.device.isMobile&&t.setState(wr({},t.state,{loginType:"google"}))}renderComponent(){const{online:e}=St.a.state,{device:t}=this.environment,{createType:n}=this.props;return t.isMobile?r.createElement(ye.a,{popupType:ye.a.PopupType.SlideUp,buttonPopupStore:"add-account"===n?rr:nr,alignmentToOrigin:ye.a.Alignment.Start,placementToOrigin:ye.a.Placement.Top,originGap:0,isFullWidthOnMobile:!0,render:e=>this.renderAccountActionMenu(n,e),preventScaleTransition:!0,renderOrigin:t=>r.createElement(Oe.a,Object.assign({focused:!1,disabled:!e,title:this.renderMenuButtonLoginTitle(n)},t))}):r.createElement("div",{onClick:()=>{e&&tr.a.setState(wr({},tr.a.getState(),{open:!0,createType:n}))}},r.createElement(Oe.a,{focused:!1,disabled:!e,title:this.renderMenuButtonLoginTitle(n)}),this.renderAccountActionModal())}renderMenuButtonLoginTitle(e){switch(e){case"create-work":return r.createElement("div",{style:this.getAccountActionStyle()},r.createElement(M.b,{defaultMessage:"Create work account",id:"sidebarSwitcherMultiAccount.menuItem.createWorkAccountButton.label"}));case"add-account":return r.createElement("div",{style:this.getAccountActionStyle()},r.createElement(M.b,{defaultMessage:"Add another account from email",id:"sidebarSwitcherMultiAccount.addAccountButton.label"}))}}renderAccountActionMenu(e,t){const n={menuType:ke.b.MenuType.Modal,left:r.createElement(Pt.CancelMenuText,null),onClickLeft:t.close,whiteBackground:!0,title:r.createElement(M.b,Object.assign({},Object(hn.e)(this.props.intl,e)))};return r.createElement(ke.b,Object.assign({},n),this.renderLoginAction(e))}renderDescription(e){switch(e){case"add-account":return r.createElement(M.b,{id:"sidebarSwitcherMultiAccount.addAccount.description",defaultMessage:"Use an existing account, or sign up with a new email. Your current account will remain logged in.",description:"Description when adding an account"});case"create-work":return r.createElement(M.b,{id:"sidebarSwitcherMultiAccount.createWork.description",defaultMessage:"We’ll check if your teammates are already on Notion. If not, we’ll create a new home for you and your team.",description:"Description when creating a work account"})}}getBaseMobileStyle(){return this.environment.device.isMobile?{maxWidth:343}:{}}getModalStyle(){return{width:480,maxWidth:"calc(100vw - 100px)",borderRadius:3}}getTitleStyle(){return wr({fontSize:28,fontWeight:P.a.fontWeight.semibold,marginTop:90,textAlign:"center",lineHeight:1.1},this.getBaseMobileStyle())}getDescriptionStyle(){return wr({fontSize:14,color:this.theme.mediumTextColor,width:350,marginTop:12,marginBottom:20,textAlign:"center",lineHeight:1.3},this.getBaseMobileStyle())}getCancelStyle(){return{fontSize:14,color:this.theme.mediumTextColor,position:"absolute",right:0,marginTop:16,marginRight:16,cursor:"pointer"}}getLoginActionWrapperStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}}getLoginActionStyle(){return wr({width:320,marginTop:24,marginBottom:64},this.getBaseMobileStyle())}}var kr,Pr=Object(M.h)(Or),Mr=n(335),Tr=n(182),Cr=n(257),jr=n(186);function Ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(n),!0).forEach((function(t){xr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.Regular=0]="Regular",e[e.DesktopMac=1]="DesktopMac",e[e.Mobile=2]="Mobile"}(kr||(kr={}));class Ar extends i.a{constructor(){super(...arguments),this.storeTypes={loginStore:er.a,loginPermissionsStore:$n.a},this.height={[kr.Regular]:fe.a.defaultHeight,[kr.DesktopMac]:fe.a.desktopMacHeight,[kr.Mobile]:"auto"},this.handleDesktopAppClick=()=>{const{device:e}=this.environment;this.close(),e.isWindows?W.qb(this.environment,{from:"sidebar",platform:"windows"}):W.qb(this.environment,{from:"sidebar",platform:"mac"})},this.handleMobileAppClick=()=>{this.close(),W.rb(this.environment,{from:"sidebar"})},this.handleClick=()=>{Vn.a.setState(Br({},Vn.a.state,{open:!0})),W.Tc(this.environment)},this.logout=()=>{const{online:e}=St.a.state;e&&(Vn.a.setState(Br({},Vn.a.state,{open:!1})),W.Od(this.environment),wn.k(this.environment))},this.handleDraggableListDrop=e=>t=>{const n=new Mr.a(this.environment,{table:jr.a,id:e},{userId:e});F.d(this.environment,e=>{En.u({userRootStore:n,transaction:e,spaceViewIds:t})},e),W.xd(this.environment,{workspace_count:t.length})},this.getAccountActionStyle=()=>({display:"flex",color:this.theme.mediumTextColor,whiteSpace:"nowrap",fontSize:this.isMobile()?16:12,paddingLeft:this.isMobile()||this.isOnlySpace()?0:jn.dragHandleEffectiveWidth}),this.getFooterStyle=()=>this.environment.device.isMobile?{}:{backgroundColor:this.theme.sidebarSwitcherFooterBackground}}renderComponent(){const{device:e}=this.environment,{shouldShowUnexpandButton:t}=this.props,{currentSpaceStore:n,currentUserStore:i}=k.a.state,o=tr.a.getUserIds(this.environment);if(!n||!i)return;const s=_n.a.getUnreadMentionsCountForOtherSpaces(),a=o.length>1?i.getEmail():void 0;return r.createElement(ye.a,{popupType:e.isMobile?ye.a.PopupType.SlideUp:ye.a.PopupType.Popup,buttonPopupStore:Vn.a,renderOrigin:()=>r.createElement(H.a,{style:Br({},Ar.buttonStyle,{height:this.height[this.props.format],marginBottom:a?e.isMobile?0:8:0}),mobileFeedback:e.isMobile,onClick:this.handleClick,className:re.gb},r.createElement(Jn,{isMobile:this.isMobile(),spaceStore:n,activeUserEmailAddress:a,showExpand:!0,type:"store"}),t&&r.createElement("div",{className:re.t,style:{display:"flex",alignItems:"center",height:"100%",marginLeft:"auto",marginRight:s?0:12}},r.createElement(Rn,null)),r.createElement(On.a,{color:On.a.Color.Red,count:s,style:{marginLeft:6,marginRight:14}})),originGap:0,disableMutationObserver:!0,render:t=>{let n;return n=e.isMobile?{menuType:ke.b.MenuType.Modal,title:r.createElement(M.b,{defaultMessage:"Accounts & Workspaces",id:"sidebarSwitcherMultiAccount.mobileMenu.title"}),right:r.createElement(Pt.DoneMenuText,null),onClickRight:t.close}:{menuType:ke.b.MenuType.Popup,minWidth:270,maxWidth:360,footer:this.renderFooter()},r.createElement(ke.b,Object.assign({},n),o.map(t=>r.createElement(r.Fragment,{key:t},this.renderAccountHeader(t),r.createElement("div",{style:e.isMobile?{paddingTop:10}:{}},r.createElement(we.a,{type:we.a.Type.Vertical,sections:this.getMenuListSections(t),initialFocus:void 0})))),e.isMobile&&this.renderFooter())}})}renderAccountHeader(e){const{online:t}=St.a.state,n=tr.a.getUserEmailAddress(this.environment,e);return n&&r.createElement(Un,{emailAddress:n,userId:e,disabled:!t})}renderFooter(){const e=r.createElement(r.Fragment,null,!this.hasAtLeastOneTeamPlan()&&r.createElement(Pr,Object.assign({createType:"create-work"},this.stores)),r.createElement(Pr,Object.assign({createType:"add-account"},this.stores)));return r.createElement("div",{style:this.getFooterStyle()},r.createElement(Ee.a,null,vn.b(this.environment)&&e,this.renderLogoutAll()),r.createElement(Ee.a,{topBorder:!0},!this.isMobile()&&this.renderDownloadApps()))}renderDownloadApps(){const{device:e}=this.environment;return e.isElectron?r.createElement(Tr.a,{external:!0,href:Me.H,onClick:this.handleMobileAppClick},r.createElement(Oe.a,{focused:!1,title:r.createElement("div",{style:{color:this.theme.mediumTextColor,fontSize:12,paddingLeft:this.isMobile()||this.isOnlySpace()?0:jn.dragHandleEffectiveWidth}},r.createElement(M.b,{defaultMessage:"Get mobile app",id:"sidebarMultiSwitcher.desktopAppGetMobileApp.prompt"}))})):r.createElement(De.a,{isTokenTitle:!0,title:r.createElement("div",{style:{display:"flex",color:this.theme.mediumTextColor,fontSize:12,alignItems:"center",marginLeft:-5,paddingLeft:this.isOnlySpace()?0:jn.dragHandleEffectiveWidth}},r.createElement(Tr.a,{external:!0,href:Me.n},r.createElement(Cr.a,{onClick:this.handleDesktopAppClick},e.isWindows?r.createElement(M.b,{defaultMessage:"Get Windows app",id:"sidebarMultiSwitcher.windowsAppButton.text"}):r.createElement(M.b,{defaultMessage:"Get Mac app",id:"sidebarMultiSwitcher.macAppButton.text"}))))})}renderLogoutAll(){const{online:e}=St.a.state;return r.createElement(Oe.a,{onClick:this.logout,focused:!1,disabled:!e,title:r.createElement("div",{style:Br({},this.getAccountActionStyle(),{paddingLeft:0})},r.createElement(M.b,{defaultMessage:"Log out all",id:"sidebarSwitcherMultiAccount.menuItem.logoutAllButton.label"}))})}getMenuListSections(e){const{device:t}=this.environment,n=tr.a.getSpaceViewStores(this.environment,e).map(e=>e.id);return[{key:"spaces",render:i=>r.createElement(Ee.a,Object.assign({},i,{disableMobilePadding:!0,topBorder:t.isMobile,style:{borderBottom:"1px solid ".concat(this.theme.regularDividerColor)},children:t.isMobile?i.children:r.createElement(r.Fragment,null,r.createElement(Nn.b,{direction:Nn.a.Vertical,keys:n,renderKey:e=>i.children[n.indexOf(e)],onDrop:this.handleDraggableListDrop(e),isSidebarSwitcher:!0}))})),items:this.getSpaceMenuListItems(e)}]}renderSpaceMenuItem(e){const{device:t}=this.environment,{online:n}=St.a.state;return r.createElement(jn,Object.assign({},e.props,{id:e.id,icon:e.icon,title:e.title,caption:e.subtitle,isCheck:e.isCurrentSpace,unreadMentions:e.unreadMentions,isOnlySpace:this.isOnlySpace(e.userId),shortcut:void 0!==e.shortcutIndex&&e.shortcutIndex<=9?t.isElectronMac?"⌘".concat(e.shortcutIndex):"ctrl+".concat(e.shortcutIndex):void 0,disabled:!n&&this.environment.currentUser.id!==e.userId}))}getSpaceMenuListItems(e){const{device:t}=this.environment,n=[],{currentUserRootStore:r,currentSpaceStore:i}=k.a.state,o=tr.a.getSpaceViewStores(this.environment,e),s=tr.a.getAllSpaceViewStores(this.environment);if(!r||!i)return[];for(const[a,l]of o.entries()){const o=l.getSpaceStore();if(o){const a=e===r.id&&o.id===i.id,{results:c}=_n.a.state,d=c.find(e=>e.spaceId===o.id),h=Object(Qn.getSpaceName)(this.environment,o);let p;const m=zn.a.getPublicSpaceData(this.environment,o.id);if(m){const e=m.productId?this.props.intl.formatMessage(Object(hn.d)(m.productId)):this.props.intl.formatMessage("team"===o.getPlanType()?hn.h.teamTrialPlan:hn.h.personalPlan);p=this.props.intl.formatMessage("personal"===o.getPlanType()?hn.h.workspaceSubtitleWithoutMembers:hn.h.workspaceSubtitleWithMembers,{numberOfWorkspaceMembers:this.props.intl.formatNumber(m.memberCount),planType:e})}const u=ue.findIndex(s,e=>e.id===l.id)+1;n.push({key:l.id,render:n=>this.renderSpaceMenuItem({id:o.id,props:n,title:h,subtitle:p,shortcutIndex:t.isElectron?u:void 0,icon:Object(Qn.getSpaceIcon)(this.environment,o),isCurrentSpace:a,userId:e,unreadMentions:d&&d.spaceId!==i.id&&d.unread.mentions>0?d.unread.mentions:void 0}),action:async e=>{let{event:t}=e;this.close(),a||await En.o({environment:this.environment,spaceViewStore:l,userSettingsStore:k.a.state.currentUserSettingsStore,userRootStore:k.a.state.currentUserRootStore,metaClick:t.ctrlKey||t.metaKey}),W.Pd(this.environment)}})}}return n}close(){Vn.a.setState(Br({},Vn.a.state,{open:!1}))}isMobile(){return this.props.format===kr.Mobile}isOnlySpace(e){return 1===(e?tr.a.getSpaceViewStores(this.environment,e):tr.a.getAllSpaceViewStores(this.environment)).length}hasAtLeastOneTeamPlan(){return tr.a.hasAtLeastOneTeamPlan(this.environment)}}Ar.Format=kr,Ar.buttonStyle={display:"flex",alignItems:"center",minWidth:0,height:"100%",width:"100%"};var Dr=Object(M.h)(Ar),Lr=n(621),Rr=n(766),Fr=n.n(Rr),Wr=n(38),Ur=n(13);function Nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _r(e,t){const n="today",r="past-week",i="earlier",o=Ur.ob(Ur.m).startOf("day").valueOf(),s=Fr()(o).subtract(1,"week").valueOf(),a=ue.groupBy(e,e=>{let{timestamp:a}=e;return"Relevance"===t?i:a>o?n:a>s?r:i});let l=-1;return ue.compact([n,r,i].map(e=>{const t=a[e];if(t&&0!==t.length)return{key:e,pages:t.map(e=>(l+=1,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nr(Object(n),!0).forEach((function(t){Vr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{index:l})))}}))}var zr=n(587),Hr=n(757),qr=n(727),Gr=n(406),Qr=n(250),Kr=n(686);function Zr(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Yr(e){const{actorPointer:t,timestamp:n,store:i}=e,o=Object(M.i)(),s=Object(Le.a)(Math.min(n,Date.now())).calendar(),a=Object(Gr.a)(()=>t?Object(qr.a)({parentStore:i,pointer:t}):void 0,[i]),l=a&&Object(qe.b)(o,a);return l?r.createElement("div",null,r.createElement(M.b,{id:"sharedWithMePage.menuItem.caption",defaultMessage:"{time} · {actorName}",values:{time:s,actorName:l},description:"Caption for a shared page that shows the time the page was last edited or the time at which the user was invited, and by whom (e.g. 'Today at 11:00am • Ivan Zhao'"})):r.createElement("div",null,s)}function Xr(e){const{store:t}=e,[n,i]=r.useState(!1),o=Object(zr.b)(),{isMobile:a}=o.device,l=n?r.createElement(M.b,{defaultMessage:"Link copied",id:"sharedWithMePageMenuItem.linkCopied.tooltip",description:"Tooltip shown when user copied link to a shared page"}):r.createElement(M.b,{defaultMessage:"Copy link",id:"sharedWithMePageMenuItem.copylinkToPage.tooltip",description:"Shortcut for copying a link to a shared page from the 'Shared With Me' pop-up"});return r.createElement(E.a,{placement:E.a.Placement.Bottom,renderTooltip:()=>l,forceVisibleState:n||void 0,render:e=>r.createElement(wt.a,Object.assign({isGray:!0,style:{marginRight:2},onClick:e=>{Qr.b({environment:o,blocks:[t],event:e}),i(!0),setTimeout(()=>{i(!1)},1e3)}},e,{onMouseLeave:t=>{i(!1),e.onMouseLeave(t)}}),s.a.link({width:a?18:16,height:a?18:16}))})}function Jr(e){const{isPinned:t,store:n,spaceViewStore:i}=e,o=Object(zr.b)(),a=Object(zr.d)(),[{online:l}]=Object(Gr.b)(St.a),[{currentUserSettingsStore:c}]=Object(Gr.b)(k.a),d=Object(Kr.a)(e=>({pinned:{width:a?18:16,height:a?18:16,fill:e.regularIconColor},unpinned:{width:a?18:16,height:a?18:16}}),[a]);return r.createElement(E.a,{disableTooltip:!l,placement:E.a.Placement.Bottom,renderTooltip:()=>t?r.createElement(M.b,{defaultMessage:"Remove from sidebar",id:"outlinerViewAllMenuList.removeFromSidebar.tooltip",description:"Tooltip displayed when user can remove a pinned page from the sidebar"}):r.createElement(M.b,{defaultMessage:"Add to sidebar",id:"outlinerViewAllMenuList.addToSidebar.tooltip",description:"Tooltip displayed when user can pin a page to the sidebar"}),render:e=>r.createElement(wt.a,Object.assign({},e,{isGray:!0,onClick:()=>{c&&Object(F.d)(o,e=>{t?dt.i({environment:o,store:n,spaceViewStore:i,userSettingsStore:c,transaction:e}):dt.e({environment:o,store:n,spaceViewStore:i,userSettingsStore:c,transaction:e})})},disabled:!l,style:l?void 0:{cursor:"default"}}),t?s.a.pinFilled(d.unpinned):s.a.pin(d.pinned))})}var $r=r.forwardRef((e,t)=>{const{store:n,timestamp:i,actorPointer:o}=e,s=Zr(e,["store","timestamp","actorPointer"]),a=Object(Gr.a)(()=>n.getIcon(),[n]),l=Object(Gr.a)(()=>n.isEmptyPage(),[n]);return r.createElement(Oe.a,Object.assign({},s,{ref:t,title:r.createElement(O.a,{store:n}),icon:r.createElement(S.a,{disabled:!0,icon:a,isEmptyPage:l,size:19}),caption:r.createElement(Yr,{actorPointer:o,store:n,timestamp:i}),right:r.createElement("div",{style:{display:"flex"}},r.createElement(Xr,{store:n}),r.createElement(Jr,Object.assign({},e)))}))});function ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ei(Object(n),!0).forEach((function(t){ni(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ei(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ri(e){const{sections:t}=e,n=1===t.length;return t.map((t,i)=>{let{key:o,pages:s}=t;return{key:o,items:ii(ti({},e,{pages:s})),render:e=>r.createElement(Ee.a,Object.assign({},e,{topBorder:0!==i,title:n?void 0:oi(o)}))}})}function ii(e){const{environment:t,spaceStore:n,pages:i,visiblePageIds:o,closePopover:s}=e,a=o.length;return i.map(i=>{let{blockId:c,timestamp:d,authorId:h,authorTable:p}=i;const m=l.a.createChildStore(n,{table:oe.b,id:c}),u=h&&p?{table:p,id:h}:void 0,g=o.includes(c);return{key:c,action:e=>{let{event:n}=e;s(),Z.h({environment:t,store:m,metaClick:n.metaKey}),t.device.isPhone&&dt.b()},render:t=>r.createElement($r,Object.assign({},t,e,{store:m,timestamp:d,actorPointer:u,isPinned:g,spaceId:n.id,pinnedAmount:a}))}})}function oi(e){switch(e){case"today":return r.createElement(M.b,{id:"sharedWithMePopover.todaySection.label",defaultMessage:"Today"});case"past-week":return r.createElement(M.b,{id:"sharedWithMePopover.pastWeekSection.label",defaultMessage:"Past week"});case"earlier":return r.createElement(M.b,{id:"sharedWithMePopover.earlierSection.label",defaultMessage:"Earlier"});default:throw $e.e(e)}}var si=function(e){const t=Object(zr.b)(),[n,i]=Object(Gr.b)(Hr.b);return r.createElement(we.a,{type:we.a.Type.Vertical,initialFocus:void 0,sections:ri(ti({},e,{environment:t,closePopover:()=>{i(ti({},n,{[e.type]:!1}))}}))})},ai=n(1498);function li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?li(Object(n),!0).forEach((function(t){di(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function di(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class hi extends i.a{renderComponent(){const{title:e,children:t,handleClick:n,handleCloseClick:i,showCloseButton:o,style:a}=this.props;return r.createElement(H.a,{style:ci({position:"relative",padding:10,margin:12,fontSize:12,background:this.theme.sidebarItemSelectedBackground,borderRadius:6},a),onClick:n,hovered:!1,ignoreLocalHoverState:!0},e&&r.createElement("div",{style:{marginRight:16}},r.createElement("div",{style:{fontWeight:P.a.fontWeight.medium,flexGrow:1}},e)),t,o&&r.createElement(Cr.a,{style:{position:"absolute",top:7,right:8},onClick:i},s.a.closeThick({width:10,opacity:"75%"})))}}var pi=hi;const mi=["view-all","pin-pages"];class ui extends u.a{getInitialState(){return{currentStepNum:0}}getFeatureIntroStep(e){if(!e.getSettings().completed_enhanced_sidebar_intro)return mi[this.state.currentStepNum]}goToNextStep(){this.setState({currentStepNum:this.state.currentStepNum+1})}}var gi=new ui;function bi(e){const{userSettingsStore:t,helpDocsHref:n}=e,i=Object(zr.b)(),o=Object(Gr.a)(()=>gi.getFeatureIntroStep(t),[]),a=Object(Kr.a)(e=>({learnMore:{color:e.mediumTextColor,fontSize:12,marginTop:4,textDecoration:"underline"},bannerCallout:{borderRadius:0,padding:"10px 12px 10px",margin:0,backgroundColor:e.sidebarSecondaryBackground,boxShadow:"0 1px 0 ".concat(e.regularDividerColor)}}),[]);return"pin-pages"!==o?null:r.createElement(pi,{style:a.bannerCallout,showCloseButton:!0,handleClick:e=>{e.preventDefault(),Object(Z.i)({environment:i,url:n})},handleCloseClick:()=>{gi.reset(),Kt.a({environment:i,userSettingsStore:t})},title:r.createElement("div",{style:{display:"flex",alignItems:"center"}},s.a.pinFilled({width:12,marginRight:6,marginLeft:2,opacity:"65%"}),r.createElement(M.b,{id:"enhancedSidebarFeatureTour.pinPages.primaryText",defaultMessage:"Organize your shared pages here"}))},r.createElement("div",{style:{fontSize:12,display:"flex",flexDirection:"column",marginTop:2,marginLeft:20}},r.createElement("div",null,r.createElement(M.b,{id:"enhancedSidebarFeatureTour.pinPages.secondaryText",defaultMessage:"Pin pages you frequently access to the sidebar."})),r.createElement("div",{style:a.learnMore},r.createElement(M.b,{id:"enhancedSidebarFeatureTour.pinPages.actionText",defaultMessage:"Learn more"}))))}function yi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yi(Object(n),!0).forEach((function(t){Si(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Si(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const vi=Object(M.g)({searchPlaceholder:{id:"sharedWithMePopover.search.placeholder",defaultMessage:"Search for shared pages",description:"Search placeholder text in 'Shared with me' popover menu"}});function wi(e){const t=Object(zr.a)(),{isMobile:n}=t,{query:i,onInputChange:o}=e,s=Object(Kr.a)(e=>({iconStyle:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:e.regularIconColor},headerContainer:{marginTop:n?0:14,backgroundColor:e.popoverBackground,borderBottom:"1px solid ".concat(e.regularDividerColor)},sortContainer:{margin:n?"4px 14px":"4px 14px 0"}}),[n]),[{currentUserSettingsStore:a}]=Object(Gr.b)(k.a);return r.createElement(r.Fragment,null,a&&r.createElement(bi,{userSettingsStore:a,helpDocsHref:Object(Ue.a)("guides.sharing")}),r.createElement("div",{style:s.headerContainer},r.createElement(ht.a,{style:fi({},t.isAndroid&&{borderBottom:"none"}),showClearButton:!0,placeholder:kt.a.formatMessage(vi.searchPlaceholder),focus:!t.isMobile||void 0,value:i,onChange:e=>{o(e.target.value)}}),r.createElement("div",{style:s.sortContainer},r.createElement(ai.a,{currentSortBy:e.sortBy,setSortBy:e.setSortBy,sortOptions:Mi}))))}function Ei(){return r.createElement(Ee.a,{topBorder:!0,disableDesktopPadding:!0},r.createElement(Et.a,{title:r.createElement(M.b,{defaultMessage:"Learn about shared pages",id:"sharedWithMePopover.learnMore.prompt",description:"Link to a guide to learn more about 'Shared with Me' in popover menu"}),href:Object(Ue.a)("guides.sharing"),analyticsFrom:"sharing"}))}function Oi(){return r.createElement(Ot.a,{href:Object(Ue.a)("guides.sharing"),analyticsFrom:"sharing"})}function ki(e){const{pages:t,sortBy:n}=e,i=_r(t,n);return 0===i.length?r.createElement(Pi,null):r.createElement(si,Object.assign({},e,{sections:i}))}function Pi(){const e=Object(zr.a)(),{isMobile:t}=e,n=Object(Kr.a)(e=>({placeHolderStyle:{textAlign:"center",padding:"".concat(t?64:0,"px 20px 0"),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:t?void 0:"100%",minHeight:t?void 0:200},iconStyle:{width:36,fill:e.lightIconColor},contentStyle:{fontSize:14,color:e.mediumTextColor,maxWidth:260}}),[t]),i=r.createElement(M.b,{defaultMessage:"No pages found",id:"outlinerViewAllPopover.search.noMatchesPrompt",description:"Message when 'View all' popover query results are empty"});return r.createElement("div",{style:n.placeHolderStyle},r.createElement("div",{style:{paddingBottom:12}},s.a.paperAirplane(n.iconStyle)),r.createElement("div",{style:fi({},n.contentStyle,{fontWeight:500})},i))}const Mi=[{key:"Relevance",formattedName:r.createElement(M.b,{id:"sharedWithMePopover.sortOrder.relevance",defaultMessage:"Best match"})},{key:"LastEditedNewest",formattedName:r.createElement(M.b,{id:"sharedWithMePopover.sortOrder.lastEditedNewest",defaultMessage:"Last edited"})}];var Ti=function(e){const t=Object(zr.b)(),{device:n}=t,[i,o]=Object(Gr.b)(Hr.b),s=r.createElement(wi,Object.assign({},e));let a;return a=n.isMobile?{menuType:ke.b.MenuType.Modal,title:r.createElement(M.b,{defaultMessage:"Shared with Me",id:"sharedWithMePopover.menu.header",description:"Label for mobile popover menu that displays pages others have shared with the user"}),left:r.createElement(Oi,null),right:r.createElement(Pt.DoneMenuText,null),onClickRight:()=>{o(fi({},i,{[e.type]:!1}))},header:s}:{menuType:ke.b.MenuType.Popup,width:400,header:s,footer:r.createElement(Ei,null)},r.createElement(ke.b,Object.assign({},a),r.createElement(ki,Object.assign({},e,{pages:e.sharedPages})))},Ci=n(45),ji=n(31),Ii=n(336);function Bi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bi(Object(n),!0).forEach((function(t){Ai(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ai(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Di(e){const{isPopoverOpen:t,isMobile:n,onClick:i,total:o}=e,s=Object(Kr.a)(e=>({item:{background:t?e.buttonHoveredBackground:void 0,marginBottom:n?16:void 0}}),[t,n]);return r.createElement(H.a,{mobileFeedback:n,onClick:i},r.createElement(w.a,{style:s.item,isMobile:n,disableMobileBorder:!0},r.createElement(M.b,{defaultMessage:"View all ({total})",id:"viewMoreOutlinerButton.label",description:"Label for popover menu that displays all pages for an overflowing section in the sidebar. The count represents total number of pages  (e.g. View all (8))",values:{total:o}})))}var Li=function(e){const t=Object(M.i)(),{isMobile:n,allSharedPages:i,type:o,originRef:s,userSettingsStore:a}=e,l=a.id,c=s.current?s.current.getBoundingClientRect():void 0,[d,h]=Object(Gr.b)(Hr.b),p=Boolean(d[o]),m=r.useCallback(()=>{h(e=>xi({},e,{[o]:!0}))},[h,o]),u=r.useCallback(()=>{h(e=>xi({},e,{[o]:!1}))},[h,o]),[g,b]=r.useState(""),[y,f]=r.useState("Relevance"),S=r.useRef(void 0);r.useEffect(()=>(p?S.current&&(clearTimeout(S.current),S.current=void 0):S.current=setTimeout(()=>{b("")},2*ji.d),()=>{S.current&&(clearTimeout(S.current),S.current=void 0)}),[p]);const v=Object(Gr.a)(()=>{const e=ue.compact(i.map(e=>{const n=e.getValue();if(!n)return;const r=n.last_edited_time||n.created_time;if(!r)return;const{id:i,last_edited_by_id:o,last_edited_by_table:s,created_by_id:a,created_by_table:l}=n;let c,d;return o&&s?(c=o,d=s):(c=a,d=l),function(e){const{block:t,query:n,getRecordValue:r,userTimeZone:i,intl:o}=e;if(!n)return!0;const s=t?Wr.h({table:oe.b,value:t,getRecordValue:r,userTimeZone:i,intl:o}):void 0;return!!s&&s.toLowerCase().indexOf(n.trim().toLowerCase())>=0}({block:n,query:g,getRecordValue:e.getRecordValue,userTimeZone:Ur.m,intl:t})?{blockId:i,timestamp:r,authorId:c,authorTable:d}:void 0}));switch(y){case"Relevance":return Ii.a.sortFrecencyHighToLow({items:e.map(e=>xi({},e,{id:e.blockId})),now:Date.now(),currentUserId:l});case"LastEditedNewest":return ue.sortBy(e,e=>{let{timestamp:t}=e;return t}).reverse();default:return e}},[i,y,g]);return r.createElement(Ci.c,{popupType:n?Ci.c.PopupType.SlideUp:Ci.c.PopupType.Popup,originRect:c||void 0,alignmentToOrigin:Ci.c.Alignment.Start,placementToOrigin:Ci.c.Placement.Right,originGap:0,isFullWidthOnMobile:!0,preventScaleTransition:!0,open:p,onDismiss:u,render:()=>r.createElement(Ti,Object.assign({},e,{query:g,onInputChange:b,sortBy:y,setSortBy:f,sharedPages:v,allSharedPageIds:i.map(e=>{let{id:t}=e;return t})})),origin:r.createElement(Di,{isPopoverOpen:p,isMobile:n,onClick:m,total:i.length})})};function Ri(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ri(Object(n),!0).forEach((function(t){Wi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ri(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ui extends i.a{constructor(){super(...arguments),this.sidebarState=this.createComputedStore(()=>Object(Te.i)(this.environment)),this.storeTypes={scrollerStore:gn.a},this.handleScrollerMount=e=>{bn.a.SidebarMobileScroller=e},this.handleCloseSidebar=()=>{dt.b()},this.handleClickFind=()=>pe.c({environment:this.environment,analyticsFrom:"sidebar-mobile"}),this.handleOrientationChange=()=>{dt.b()},this.isScrolledToTop=this.createComputedStore(()=>0===this.stores.scrollerStore.state.scrollTop),this.currentOfflinePages=this.createComputedStore(()=>Lr.a.getCurrentOfflinePagesStore())}willMount(){window.addEventListener("resize",this.handleOrientationChange)}willUnmount(){window.removeEventListener("resize",this.handleOrientationChange)}renderComponent(){const e=hn.a(this.environment);return e?r.createElement(fn.a,{render:()=>r.createElement("div",{className:re.fb,style:this.getWrapStyle()},!e&&r.createElement(mn,null),this.renderSidebar()),isVisible:!0,animationStyle:{width:e?hn.b(this.environment):"100vw"}}):r.createElement("div",{className:re.fb,style:Fi({},this.getWrapStyle(),{width:"100vw"})},!e&&r.createElement(mn,null),this.renderSidebar())}renderSidebar(){return r.createElement(an.a,{capture:!hn.a(this.environment)&&cn.b.get(),onBackButton:this.handleCloseSidebar},r.createElement("div",{style:this.getStyle()},this.renderTopbar(),this.renderOutliner()))}renderTopbar(){const{device:e}=this.environment,t=e.isReactNative&&e.isTablet&&hn.a(this.environment);return r.createElement("div",{style:this.getTopbarStyle()},r.createElement(Dr,{shouldShowUnexpandButton:t,format:kr.Mobile}),!e.isReactNative&&r.createElement(H.a,{onClick:this.handleClickFind,mobileFeedback:!0,style:Ui.actionButtonStyle},s.a.mobileBottomBarSearch({width:26})))}renderOutliner(){const{currentSpaceStore:e,currentSpaceViewStore:t,currentUserRootStore:n,currentUserStore:i,currentUserSettingsStore:o,currentBlockStore:s}=k.a.state,a=this.sidebarState.state;if(!(a&&s&&t&&n&&e&&i&&o))return;const l=e.canEdit(),c=this.environment.device.isIOS&&"personal_free"===Object(We.i)(this.environment)&&!1;return r.createElement(Wt.a,{store:e,disableEditNearestBlock:!0,render:n=>r.createElement(me.b,{store:this.stores.scrollerStore,ref:this.handleScrollerMount,style:Ui.outlinerStyle,disableScroll:Ut.e(this.environment),type:me.b.OverflowType.Y},a.showOfflineSection&&r.createElement(it,{isMobile:!0,type:"offline",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>r.createElement(he,{isMobile:!0,type:"offline",isTopLevel:!0,spaceStore:e,spaceViewStore:t,childStores:this.currentOfflinePages.state,showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l})}),a.showBookmarksSection&&r.createElement(it,{isMobile:!0,type:"bookmarks",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>r.createElement(he,{isMobile:!0,type:"bookmarks",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:t.getBookmarkedPagesStore(),childStores:t.getBookmarkedPages(),showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l})}),a.showWorkspaceSection&&r.createElement(it,{isMobile:!0,type:"workspace",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>r.createElement(he,{isMobile:!0,type:"workspace",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getWorkspacePages(),addPageTitle:r.createElement(M.b,{defaultMessage:"Add a page",id:"sidebarMobile.addPageToWorkspace.title"}),onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,showAddPageButton:!0,disabled:!l})}),a.showSharedSection&&r.createElement(it,{isMobile:!0,type:"shared",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:n=>r.createElement(r.Fragment,null,r.createElement(he,{isMobile:!0,type:"shared",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:t.getSharedPagesStore(),childStores:a.visibleSharedPagesStores,showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l}),this.isEnhancedSidebarEnabled&&a.showSharedOverflowButton&&r.createElement(Li,{originRef:n,isMobile:!0,type:"shared",spaceStore:e,spaceViewStore:t,userSettingsStore:o,allSharedPages:a.allSharedPagesStores,visiblePageIds:a.visibleSharedPagesStores.map(e=>{let{id:t}=e;return t})}))}),a.showPrivateSection&&!a.showOnlyPrivateSection&&r.createElement(it,{isMobile:!0,type:"private",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>r.createElement(he,{isMobile:!0,type:"private",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getPrivatePages(),addPageTitle:r.createElement(M.b,{defaultMessage:"Add a page",id:"sidebarMobile.addAPrivatePage.title"}),showAddPageButton:!0,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l})}),a.showOnlyPrivateSection&&r.createElement(he,{isMobile:!0,type:"private",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getPrivatePages(),addPageTitle:r.createElement(M.b,{defaultMessage:"Add a page",id:"sidebarMobile.addAPageToOnlyPrivateSection.title"}),showAddPageButton:!0,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l}),a.showOnlyPrivateSection&&r.createElement("div",{style:{height:20}}),r.createElement(sn,{store:e}),r.createElement($t,{isMobile:!0}),e.canEdit()&&r.createElement(Ft,{store:s,isMobile:!0}),c&&r.createElement(tn,null),r.createElement(Ye,{isMobile:!0}),r.createElement("div",{style:{height:128}}))})}get isEnhancedSidebarEnabled(){return"on"===se.a.getGroup(this.environment,"sidebar-enhancements")}getWrapStyle(){return hn.a(this.environment)?{display:"block",height:"100vh",position:"relative",zIndex:3}:hn.g(this.environment)?{display:"block",height:"100vh",position:"fixed",top:0,right:"100%",zIndex:3}:{display:"block",height:"100vh",position:"fixed",top:0,left:0}}getStyle(){return Fi({display:"flex",flexDirection:"column",width:hn.c(this.environment),height:"100%",background:hn.g(this.environment)?this.theme.mobileSidebarAndroidBackground:this.theme.mobileSidebarIOSBackground,willChange:"transform",color:this.theme.mediumTextColor},hn.g(this.environment)&&{marginLeft:"auto"},{},hn.a(this.environment)&&{position:"absolute",right:0},{cursor:"pointer"})}getTopbarStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"space-between",flex:"none",height:Sn.b,marginTop:e.state.paddingTopCSS,paddingLeft:12,boxShadow:hn.g(this.environment)&&!hn.a(this.environment)&&cn.b.state?this.isScrolledToTop.state?this.theme.topbarAndroidShadowCollapsed:this.theme.topbarAndroidShadow:"0 1px 0 ".concat(this.theme.darkDividerColor),background:hn.g(this.environment)?this.theme.androidSidebarBackground:yn.f.transparent,transition:"box-shadow 300ms",width:"100%",zIndex:1}}}Ui.outlinerStyle={flexGrow:1,paddingTop:12,userSelect:"none",WebkitUserSelect:"none"},Ui.actionButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",flex:"none",height:"100%",width:44,paddingRight:6};t.default=Ui},1161:function(e,t,n){"use strict";n.r(t);n(15),n(12);var r=n(0),i=n(2),o=n(8),s=n(391),a=n(340),l=n(338),c=n(96),d=n(23),h=n(14),p=n(22),m=n(172),u=n(16);class g extends u.a{getInitialState(){return{isOpen:!1,isInsertOpen:!1,isTurnIntoOpen:!1,isColorOpen:!1,isTemplatesOpen:!1}}}var b=g,y=n(343),f=n(21),S=n(3),v=n(1486),w=n(1487),E=n(1491),O=n(747),k=n(392),P=n(249),M=n(11),T=n(279),C=n(83),j=n(32);var I=n(46),B=n(171),x=n(222),A=n(45),D=n(95),L=n(364),R=n(73),F=n(29),W=n(278),U=n(460),N=n(328),V=n(317),_=n(188),z=n(34),H=n(1493),q=n(591),G=n(138),Q=n(9),K=n(119),Z=n(1),Y=n(17),X=n(242),J=n(55),$=n(450),ee=n(465),te=n(440),ne=n(412),re=n(81),ie=n(24),oe=n(137),se=n(91),ae=n(1488),le=n(38),ce=n(1499),de=n(1137),he=n(1494);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ge extends S.a{constructor(){super(...arguments),this.storeTypes={store:b,ignoreSelectionAreaStore:q.a,templatePickerMenuListStore:X.a},this.renderMobileTemplatePreviewItem=e=>({key:e.name,render:t=>r.createElement(te.a,Object.assign({key:e.name,title:e.name,type:"page_template",format:"phone-modal",emoji:e.emoji,locked:!1},t)),action:()=>{ne.h({environment:this.environment,item:e,createNewPage:!1,isPrivate:!1})}}),this.renderPageTemplatePickerItem=e=>{const t=this.props.currentBlockStore;return{key:e.name,render:t=>r.createElement(te.a,Object.assign({key:e.name,format:"phone-modal",title:e.name,type:e.type,icon:e.icon,locked:!1},t)),action:n=>{t&&Object(re.k)(this.environment)&&(h.Hd(this.environment,{name:e.name,is_keyboard:"keydown"===n.event.type}),e.onClick(this.environment,t))}}},this.handleScrollerRef=e=>{e&&(this.scrollerDiv=e)},this.handleCloseColorPopup=()=>{this.stores.store.setState(me({},this.stores.store.state,{isColorOpen:!1}))},this.handleCloseInsertPopup=()=>{this.stores.store.setState(me({},this.stores.store.state,{isInsertOpen:!1}))},this.handleCloseTurnIntoPopup=()=>{this.stores.store.setState(me({},this.stores.store.state,{isTurnIntoOpen:!1}))},this.handleCloseTemplatesPopup=()=>{this.stores.store.setState(me({},this.stores.store.state,{isTemplatesOpen:!1}))},this.handleUnindent=e=>{if("editing"!==F.a.state.mode)return;const t=F.a.state.store,n=Object(K.c)(t);n&&(M.d(this.environment,e=>{R.t({environment:this.environment,store:t,closestSelectable:n,shiftKey:!0,transaction:e})}),this.trackItemTap("unindent"))},this.handleIndent=e=>{if("editing"!==F.a.state.mode)return;const t=F.a.state.store,n=Object(K.c)(t);n&&(M.d(this.environment,e=>{R.t({environment:this.environment,store:t,closestSelectable:n,shiftKey:!1,transaction:e})}),this.trackItemTap("indent"))},this.handleMoveUp=async e=>{if("editing"!==F.a.state.mode)return;const t=F.a.state.store,n=Object(K.c)(t);n&&(M.d(this.environment,e=>{R.q({environment:this.environment,store:t,closestSelectable:n,transaction:e})}),this.trackItemTap("move-up"))},this.handleMoveDown=e=>{if("editing"!==F.a.state.mode)return;const t=F.a.state.store,n=Object(K.c)(t);n&&(M.d(this.environment,e=>{R.p({environment:this.environment,store:t,closestSelectable:n,transaction:e})}),this.trackItemTap("move-down"))},this.handleUndo=()=>{l.f(this.environment),this.trackItemTap("undo")},this.handleRedo=()=>{l.e(this.environment),this.trackItemTap("redo")},this.handleDismissKeyboard=e=>{d.e(this.environment),this.handleCloseInsertPopup(),this.trackItemTap("hide_keyboard"),I.e()},this.handleInsert=e=>{this.stores.store.setState(me({},this.stores.store.state,{isInsertOpen:!0})),this.trackItemTap("insert")},this.handleTakePicture=e=>{!async function(e){const t=await P.b({multiple:!0,accept:e.device.isIOS?"image/*, video/*":"image/*"}),n=j.b.getCurrentRecordCacheStore(),r=C.b(e);0!==t.length&&n&&M.d(e,i=>{const o=T.a({environment:e,files:t,inMemoryRecordCacheStore:n,pageWidth:r,transaction:i});c.k({environment:e,blocks:o,selection:j.b.state.stores,transaction:i}),d.e(e)})}(this.environment),this.trackItemTap("take_picture")},this.handleMention=e=>{L.e(this.environment,{page:!0,createPage:!0,user:!0,bot:!0,date:!0,reminder:!0}),this.trackItemTap("mention")},this.handleComment=e=>{const t=j.b.state.stores[0];t&&(s.d({environment:this.environment,blockStore:t}),this.trackItemTap("discuss"))},this.handleDelete=async e=>{const t=j.b.state.stores[0],n=F.a.state;if(t&&"editing"===n.mode){const e=n.store,r=Object(G.g)(e)||Object(G.h)(e);if(M.d(this.environment,e=>{c.n({store:t,transaction:e})}),r){const e=Object(K.c)(r);d.f({environment:this.environment,store:e}),d.g(this.environment)}else d.e(this.environment);this.trackItemTap("remove")}},this.handleActionsScroll=()=>{h.c(this.environment)},this.handleActionsScrollDebounced=i.debounce(this.handleActionsScroll,500),this.handleMoreClick=e=>{d.q({environment:this.environment,stores:j.b.state.stores}),x.c({environment:this.environment,stores:j.b.state.stores,actions:m.c,left:e.clientX,top:e.clientY,showInput:!1,analyticsFrom:"mobile_more_menu"})},this.listenForPositionChanges=this.createComputedStore(()=>{const e=F.a.state;return"editing"===e.mode?{scrollTop:U.a.state.scrollTop,editing:!0,store:e.store.id,selection:e.selection.endIndex}:{scrollTop:U.a.state.scrollTop,editing:!1}}),this.shouldShow=this.createComputedStore(()=>{const{device:e}=this.environment;if(!e.isMobile)return!1;if(V.a.state.open)return!1;if(N.a.state.isOpen)return!1;if(!e.isReactNative&&_.a.state.open)return!1;if(F.a.isEditingComment())return!1;if(this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState&&"editing"===this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState.mode)return!0;if("editing"!==F.a.state.mode)return!1;const t=W.a.findEditableWithStore(F.a.state.store);return(!t||!t.props.disableMobileActionBar)&&!!Object(Q.B)()}),this.shouldShowTextActions=this.createComputedStore(()=>{const e=F.a.state;if("editing"===e.mode){const t=e.selection;if(t)return t.startIndex!==t.endIndex}const t=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState;if(t&&"editing"===t.mode){const e=t.selection;if(e)return e.startIndex!==e.endIndex}return!1}),this.shouldShowBlockActions=this.createComputedStore(()=>!this.shouldShowTextActions.state),this.canTriggerBlockActions=this.createComputedStore(()=>{if(!this.shouldShowBlockActions.state)return!1;const e=oe.a.getMode(this.environment,this.props.currentBlockStore);if(e&&"edit"!==e)return!1;const{stores:t}=j.b.state;return t.length>0&&t[0].canEdit()&&!t[0].isNavigableBlock()}),this.canTriggerTextActions=this.createComputedStore(()=>{const e=oe.a.getMode(this.environment,this.props.currentBlockStore);return(!e||"edit"===e)&&this.props.currentBlockStore.canEdit()})}willMountOrUpdate(){const{device:e}=this.environment;if(e.isMobileBrowser){const e=this.shouldShow.state,t=this.stores.store.state.isOpen;e?t?void 0!==this.currentlyShownTimer&&(window.clearTimeout(this.currentlyShownTimer),this.currentlyShownTimer=void 0):(this.stores.store.setState(me({},this.stores.store.state,{isOpen:!0})),this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)):t&&void 0===this.currentlyShownTimer&&(this.currentlyShownTimer=window.setTimeout(()=>{this.currentlyShownTimer=void 0,this.stores.store.setState(me({},this.stores.store.state,{isOpen:!1}))},200))}else this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,n=this.isOpen();return r.createElement(r.Fragment,null,r.createElement(k.a,{capture:!0,render:e=>r.createElement("div",Object.assign({},e,{style:{position:"relative",width:"100%",height:0,zIndex:B.g}}),this.renderActionBar(),this.renderInsertPopup(),this.renderTurnIntoPopup(),this.renderColorPopup(),this.renderTemplatesPopup())}),!n&&e.isIPhoneX&&e.isNative&&r.createElement("div",{style:{position:"absolute",bottom:0,background:"transparent",height:t.state.paddingBottomCSS,width:"100%",pointerEvents:"none",WebkitUserSelect:"none"}}))}renderActionBar(){const{device:e,WindowSizeStore:t}=this.environment,n=this.isOpen(),i=e.isMobile&&ce.a.state;if(this.props.position===he.a.Bottom)return r.createElement("div",{style:{position:"absolute",bottom:i?t.getSafePaddingBottomCSS(de.default.height):0,left:0,height:ge.height,width:"100%",pointerEvents:n?"auto":"none",opacity:n?1:0,transform:n?"translateY(0)":"translateY(".concat(ge.height,"px)"),transition:"opacity 120ms ease-out, transform 120ms ease-out"}},this.renderActionButtons());{const e=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionRect||D.d();if(!e)return;const t=document.body.getBoundingClientRect(),i=me({},e,{left:10,top:e.top+10-t.top});this.listenForPositionChanges.state;const{device:o}=this.environment;return r.createElement(A.c,{popupType:o.isReactNative?A.c.PopupType.SlideUp:A.c.PopupType.Popup,open:n,preventBlockRenderQueueOnEnter:!0,placementToOrigin:A.c.Placement.Bottom,alignmentToOrigin:A.c.Alignment.Start,originRect:i,disableMouseCapture:!0,keepFocus:!0,render:()=>r.createElement("div",{style:{height:ge.height,width:"calc(80wv)",borderRadius:3,overflow:"hidden"}},this.renderActionButtons())})}}renderActionButtons(){const e=this.shouldShowTextActions.state,t=this.shouldShowBlockActions.state,n=this.shouldShowTemplatesButton();return r.createElement("div",{style:this.getActionButtonStyles()},n&&this.renderTemplatesButton(),!n&&t&&this.renderBlockActions(),!n&&e&&this.renderTextActions(),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:me({},this.getItemStyle(),{borderLeft:this.getItemBorder(),borderRight:"none"}),onClick:this.handleDismissKeyboard},ge.keyboardIcon))}renderBlockActions(){const e=this.canTriggerBlockActions.state;let t=!1,n=!1;const i=this.props.currentBlockStore.getValue();i&&(Object(le.A)(i)||(t=!0),Object(le.B)(i)||(n=!0));const{device:o}=this.environment;return r.createElement("div",{ref:this.handleScrollerRef,style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:me({},this.getItemStyle(),{},!o.isSmallPhone&&{paddingLeft:12,paddingRight:12}),onClick:this.handleInsert,disabled:!e},ge.plusIcon,this.renderChevronDown()),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:me({},this.getItemStyle(),{fontWeight:p.a.fontWeight.medium}),onClick:e=>{this.stores.store.setState(me({},this.stores.store.state,{isTurnIntoOpen:!0})),this.trackItemTap("turn_into")},disabled:!e},r.createElement(Z.b,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.buttonTitle"}),this.renderChevronDown()),r.createElement(k.a,{capture:!0,render:e=>r.createElement(z.a,Object.assign({mobileFeedback:!0,disabledFeedback:!0},e,{style:this.getItemStyle(),onClick:this.handleMention,disabled:!n}),r.createElement("span",{style:{fontSize:19,lineHeight:1,fontWeight:p.a.fontWeight.medium,marginBottom:o.isAndroid?4:0}},"@"))}),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleComment,disabled:!t},ge.discussionIcon),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleTakePicture,disabled:!e},ge.imageIcon),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleDelete,disabled:!e},ge.trashIcon),this.renderBlockMovementActions(),this.renderBlockUndoActions(),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:me({},this.getItemStyle(),{fontWeight:p.a.fontWeight.medium}),onClick:e=>{this.stores.store.setState(me({},this.stores.store.state,{isColorOpen:!0})),this.trackItemTap("color")},disabled:!e},r.createElement(Z.b,{defaultMessage:"Color",id:"mobileActionBar.color.buttonTitle"}),this.renderChevronDown()),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:me({},this.getItemStyle(),{fontWeight:p.a.fontWeight.medium}),onClick:this.handleMoreClick,disabled:!e},r.createElement(Z.b,{defaultMessage:"More",id:"mobileActionBar.more.buttonTitle"}),this.renderChevronDown()))}renderBlockMovementActions(){const e=this.canTriggerBlockActions.state,t=j.b.state.stores[0];return r.createElement("div",{style:me({},this.getItemStyle(),{paddingLeft:6,paddingRight:6})},r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!e||!a.b(t),onClick:this.handleUnindent},ge.unindentIcon),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!e||!a.a(t),onClick:this.handleIndent},ge.indentIcon),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!e,onClick:this.handleMoveUp},ge.moveUpIcon),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!e,onClick:this.handleMoveDown},ge.moveDownIcon))}renderBlockUndoActions(){return r.createElement("div",{style:me({},this.getItemStyle(),{paddingLeft:6,paddingRight:6})},r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!l.b(),onClick:this.handleUndo},ge.undoIcon),r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!l.a(),onClick:this.handleRedo},ge.redoIcon))}renderTextActions(){const e=this.canTriggerTextActions.state,t=this.props.currentBlockStore.canComment();return r.createElement("div",{style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},r.createElement(E.a,{style:this.getItemStyle(),blockStore:j.b.state.stores[0],disabled:!t}),r.createElement(v.a,{type:"b",style:this.getItemStyle(),onClick:()=>this.trackItemTap("bold"),disabled:!e},r.createElement("span",{style:{fontWeight:p.a.fontWeight.semibold}},r.createElement(Z.b,{defaultMessage:"B",id:"mobileActionBar.bold.symbol",description:"Letter 'B' which represents 'bold' format option."}))),r.createElement(v.a,{type:"i",style:this.getItemStyle(),onClick:()=>this.trackItemTap("italic"),disabled:!e},r.createElement("span",{style:{fontStyle:"italic",fontWeight:p.a.fontWeight.semibold}},r.createElement(Z.b,{defaultMessage:"i",id:"mobileActionBar.italic.symbol",description:"Letter 'i' which represents 'italic' format option."}))),r.createElement(v.a,{type:"_",style:this.getItemStyle(),onClick:()=>this.trackItemTap("underline"),disabled:!e},r.createElement("span",{style:{textDecoration:"underline"}},r.createElement(Z.b,{defaultMessage:"U",id:"mobileActionBar.underline.symbol",description:"Letter 'U' which represents 'underline' format option."}))),r.createElement(v.a,{type:"s",style:this.getItemStyle(),onClick:()=>this.trackItemTap("strike_through"),disabled:!e},r.createElement("span",{style:{textDecoration:"line-through"}},r.createElement(Z.b,{defaultMessage:"S",id:"mobileActionBar.strikeThrough.symbol",description:"Letter 'S' which represents 'strike-through' format option."}))),r.createElement(v.a,{type:"c",style:this.getItemStyle(),onClick:()=>this.trackItemTap("code"),disabled:!e},r.createElement("span",{style:{fontFamily:p.a.fontFamily.githubMono}},r.createElement(Z.b,{defaultMessage:"Code",id:"mobileActionBar.code.symbol",description:"Word 'code' which represents 'code' format option."}))),r.createElement(w.a,{style:this.getItemStyle(),disabled:!e},r.createElement("span",{style:{borderBottom:"1px solid ".concat(this.theme.linkDecorationColor)}},r.createElement(Z.b,{defaultMessage:"Link",id:"mobileActionBar.link.symbol",description:"Word 'link' which represents 'link' format option."}))),r.createElement(ae.a,{onClick:()=>this.trackItemTap("equation"),disabled:!e,style:this.getItemStyle()},o.a.equation({width:16,height:16})),r.createElement(H.a,{style:this.getItemStyle(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,disabled:!e}))}renderTemplatesButton(){return r.createElement("div",{style:this.getActionMenuStyle()},r.createElement(z.a,{mobileFeedback:!0,disabledFeedback:!0,style:me({},this.getItemStyle(),{borderRight:"none",fontWeight:p.a.fontWeight.medium}),onClick:e=>{this.stores.store.setState(me({},this.stores.store.state,{isTemplatesOpen:!0})),this.trackItemTap("templates")}},o.a.templatesColor({width:20,marginRight:8}),r.createElement(Z.b,{defaultMessage:"Choose a template...",id:"mobileActionBar.templates.buttonTitle"}),this.renderChevronDown()))}renderInsertPopup(){const{device:e}=this.environment;return r.createElement(O.a,{capture:this.stores.store.state.isInsertOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:t=>r.createElement(A.c,{popupType:e.isMobile?A.c.PopupType.SlideUp:A.c.PopupType.Popup,preventBlockRenderQueueOnEnter:!0,open:this.stores.store.state.isInsertOpen,keepFocus:!0,onDismiss:()=>{t(),this.handleCloseInsertPopup()},render:()=>r.createElement(f.b,{menuType:f.b.MenuType.Modal,title:r.createElement(Z.b,{defaultMessage:"Insert block",id:"mobileActionBar.insertBlock.modalTitle"}),right:r.createElement(se.CancelMenuText,null),onClickRight:()=>{t(),this.handleCloseInsertPopup()}},r.createElement(y.a,{sections:m.i,context:{environment:this.environment,blocks:j.b.state.stores},onAccept:this.handleCloseInsertPopup}))})})}renderTurnIntoPopup(){const{device:e}=this.environment;return r.createElement(O.a,{capture:this.stores.store.state.isTurnIntoOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>r.createElement(A.c,{popupType:e.isMobile?A.c.PopupType.SlideUp:A.c.PopupType.Popup,open:this.stores.store.state.isTurnIntoOpen,keepFocus:!0,onDismiss:this.handleCloseTurnIntoPopup,preventBlockRenderQueueOnEnter:!0,render:()=>r.createElement(f.b,{menuType:f.b.MenuType.Modal,title:r.createElement(Z.b,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.modalTitle"}),right:r.createElement(se.CancelMenuText,null),onClickRight:this.handleCloseTurnIntoPopup},r.createElement(y.a,{sections:[me({},m.r,{title:""})],context:{environment:this.environment,blocks:j.b.state.stores},onAccept:this.handleCloseTurnIntoPopup}))})})}renderColorPopup(){const{device:e}=this.environment;return r.createElement(O.a,{capture:this.stores.store.state.isColorOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>r.createElement(A.c,{popupType:e.isMobile?A.c.PopupType.SlideUp:A.c.PopupType.Popup,open:this.stores.store.state.isColorOpen,keepFocus:!0,onDismiss:this.handleCloseColorPopup,preventBlockRenderQueueOnEnter:!0,render:()=>r.createElement(f.b,{menuType:f.b.MenuType.Modal,title:r.createElement(Z.b,{defaultMessage:"Block color",id:"mobileActionBar.blockColor.modalTitle"}),right:r.createElement(se.CancelMenuText,null),onClickRight:this.handleCloseColorPopup},r.createElement(y.a,{sections:[m.p,m.o,m.b],context:{environment:this.environment,blocks:j.b.state.stores},onAccept:this.handleCloseColorPopup}))})})}renderTemplatesPopup(){const{device:e}=this.environment;return r.createElement(O.a,{capture:this.stores.store.state.isTemplatesOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:()=>r.createElement(A.c,{popupType:e.isMobile?A.c.PopupType.SlideUp:A.c.PopupType.Popup,open:this.stores.store.state.isTemplatesOpen,keepFocus:!0,render:()=>r.createElement(f.b,{menuType:f.b.MenuType.Modal,title:r.createElement(Z.b,{defaultMessage:"Templates",id:"mobileActionBar.templates.modalTitle"}),right:r.createElement(se.CancelMenuText,null),onClickRight:this.handleCloseTemplatesPopup},r.createElement(J.a,{type:J.a.Type.Vertical,store:this.stores.templatePickerMenuListStore,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,onAccept:this.handleCloseTemplatesPopup,sections:[{key:"Basic",render:e=>r.createElement(ie.a,null,e.children),items:$.e.map(this.renderPageTemplatePickerItem)},{key:"Database",render:e=>r.createElement(ie.a,{title:r.createElement(Z.b,{defaultMessage:"Database",id:"mobileActionBar.databaseSection.title"})},e.children),items:$.a.filter(e=>e.shouldShow(this.environment)).map(this.renderPageTemplatePickerItem)},...ee.a(this.environment,this.props.intl).map(e=>({key:e.name,render:t=>r.createElement(ie.a,{title:e.name,key:e.name},t.children),items:e.items.map(this.renderMobileTemplatePreviewItem)}))]}))})})}renderChevronDown(){return o.a.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.stores.store.state.isOpen:this.shouldShow.state}trackItemTap(e){h.Yd(this.environment,{itemName:e})}shouldShowTemplatesButton(){const{isPhone:e}=this.environment.device,t=this.props.currentBlockStore,n=Y.a.state.currentLoadingContainerStore,r=Boolean(t&&t.isCollectionView()),i=Boolean(t&&t.getParentCollectionStore()),o=this.environment.currentUser.isLoggedIn();return Boolean(!i&&!r&&e&&t&&n&&t.hasValue()&&t.canEdit()&&0===t.getContentIds().length&&o&&n.state.ready)}getItemBorder(){return"1px solid ".concat(this.theme.regularDividerColor)}getActionButtonStyles(){const{device:e,WindowSizeStore:t}=this.environment;return{height:"100%",width:"100%",fontSize:15,display:"flex",boxShadow:this.props.position===he.a.Bottom?this.theme.bottomActionBarShadow:this.theme.mediumBoxShadow,backgroundColor:this.theme.keyboardActionBarBackground,paddingLeft:e.isReactNative?t.state.paddingLeftCSS:0,paddingRight:e.isReactNative?t.state.paddingRightCSS:0}}getActionMenuStyle(){return{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"}}getItemStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:e.isSmallPhone?8:10,paddingRight:e.isSmallPhone?8:10,borderRight:this.getItemBorder(),whiteSpace:"nowrap",height:ge.height,flexShrink:0,flexGrow:0,flexBasis:"auto",color:this.theme.regularTextColor,minWidth:e.isSmallPhone?42:44}}}ge.unindentIcon=o.a.indentDown({width:18,height:18,transform:"rotate(90deg)",position:"relative",left:1}),ge.indentIcon=o.a.indentDown({width:18,height:18,transform:"rotate(-90deg)",position:"relative",left:-1}),ge.moveUpIcon=o.a.moveUp({width:18,height:18,position:"relative",left:2}),ge.moveDownIcon=o.a.moveUp({width:18,height:18,transform:"rotate(180deg)",position:"relative",left:2}),ge.undoIcon=o.a.undo({width:19,height:19}),ge.redoIcon=o.a.redo({width:19,height:19}),ge.trashIcon=o.a.trash({width:18,height:18}),ge.discussionIcon=o.a.speechBubbleThin({width:18,height:18}),ge.plusIcon=o.a.thinPlus({width:14,height:14}),ge.keyboardIcon=o.a.keyboard({width:18,height:18}),ge.imageIcon=o.a.image({width:18,height:18}),ge.height=42,ge.minorItemStyle={width:34,justifyContent:"center"};t.default=Object(Z.h)(ge)},1162:function(e,t,n){"use strict";n.r(t);n(15),n(12);var r=n(0),i=n(70),o=n(3),s=n(8),a=n(16);class l extends a.a{getInitialState(){return{}}}var c=l,d=n(22),h=n(68),p=n(88),m=n(116),u=n(107),g=n(90),b=n(13),y=n(93),f=n(182),S=n(53),v=n(5);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class k extends o.a{constructor(){super(...arguments),this.renderProperty=e=>{const{schema:t,store:n,blockPropertyValueOverlayStore:i}=this.props;if(t[e])return r.createElement(g.b,{key:e,store:n,property:e,schema:t,disabled:!0,locked:!1,format:g.b.Format.Calendar,tableWrap:!1,blockPropertyValueOverlayStore:i})}}renderComponent(){const{time:e,store:t}=this.props,n=t.hasIcon()||!t.isEmptyPage(),i=Object(h.a)({store:t,fullyQualified:!1}),o=y.h(t);return r.createElement(f.a,{href:i},r.createElement(S.a,{focused:!1,title:r.createElement(r.Fragment,null,e&&r.createElement("div",{style:{display:"flex",color:this.theme.mediumTextColor,fontSize:14,marginTop:8,marginBottom:6}},e),r.createElement("div",{style:E({display:"flex",alignItems:"center"},e&&{marginBottom:8})},n&&r.createElement(p.a,{disabled:!0,icon:t.getIcon(),isEmptyPage:t.isEmptyPage(),size:24,style:{flexShrink:0,marginRight:8}}),r.createElement(m.a,{store:t,style:{fontWeight:d.a.fontWeight.semibold}}),o>0&&r.createElement("div",{style:{display:"flex",alignItems:"center",color:this.theme.regularDividerColor,fontSize:12,marginLeft:4,flexShrink:0}},s.a.speechBubble({width:12,height:12,marginRight:4,fill:this.theme.mediumIconColor}),o))),caption:this.renderProperties()}))}renderProperties(){const{format:e,schema:t,store:n}=this.props,i=(e.calendar_properties?e.calendar_properties.filter(e=>e.visible).map(e=>e.property):[]).filter(e=>u.e({blockValue:n.getValue(),property:e,schema:t,getRecordValue:n.getRecordValue,userTimeZone:b.m,intl:v.a.getIntl()}));if(i.length>0)return r.createElement("div",{style:{marginTop:8}},i.map(this.renderProperty))}}var P=k,M=n(26),T=n(181),C=n(40),j=n(255),I=n(341),B=n(11),x=n(21),A=n(24),D=n(314),L=n(508),R=n(154),F=n(151),W=n(42),U=n(83),N=n(206),V=n(164),_=n(1),z=n(91),H=n(10);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class K extends o.a{constructor(){var e;super(...arguments),e=this,this.storeTypes={store:c,requestStore:j.a},this.renderResults=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const{requestStore:i}=e.stores,{disabled:o}=e.props,a=e.getCurrentStartOfDay(),l=a.clone().endOf("day");return r.createElement(x.b,{menuType:x.b.MenuType.Modal,title:r.createElement("div",{style:K.headerStyle},r.createElement(F.a,{onClick:e.handleLeftClick,icon:s.a.chevronLeft,style:{marginRight:8,marginTop:2},mobileFeedback:!0}),r.createElement("div",null,a.format("MMMM Do")),r.createElement(F.a,{onClick:e.handleRightClick,icon:s.a.chevronRight,style:{marginLeft:8,marginTop:2},mobileFeedback:!0})),right:r.createElement(z.DoneMenuText,null),onClickRight:e.props.onDismiss},i.state.loading&&r.createElement(A.a,null,r.createElement(L.a,null)),!i.state.loading&&0===n.length&&r.createElement(A.a,null,r.createElement(R.a,{title:r.createElement(_.b,{defaultMessage:"No items",id:"mobileCalendarDayMenu.noResults.message"})})),!i.state.loading&&n.length>0&&r.createElement(A.a,null,n.map(t=>e.renderItem(t,a,l))),!o&&r.createElement(A.a,{topBorder:!0},r.createElement(D.a,{focused:!1,onClick:e.handleAddItemClick,title:r.createElement(_.b,{defaultMessage:"New item",id:"mobileCalendarDayMenu.newItemButton.label"})})))},this.handleLeftClick=()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState(G({},this.stores.store.state,{currentStartOfDay:e.clone().add(-1,"day").valueOf()}))},this.handleRightClick=()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState(G({},this.stores.store.state,{currentStartOfDay:e.clone().add(1,"day").valueOf()}))},this.handleAddItemClick=()=>{const{collectionViewLocalStore:e,collectionStore:t,calendarBy:n}=this.props,r=this.getCurrentStartOfDay(),i=B.d(this.environment,i=>I.e({environment:this.environment,collectionStore:t,collectionViewLocalStore:e,calendarBy:n,startOfDay:r.valueOf(),transaction:i})),o=Object(h.a)({store:i});this.navigate(o)},this.performRequest=async e=>{const{collectionStore:t,collectionViewStore:n,query:r}=this.props,o=Object(i.a)(e).endOf("day").valueOf(),s=await C.Fb(this.environment,{collectionId:t.id,collectionViewId:n.id,query:r,loader:{type:"calendar",dateRangeStart:e,dateRangeEnd:o,searchQuery:void 0,scale:"day",userTimeZone:b.m,startDayOfWeek:U.q.state}});if("failed"===s.type)throw s.error;return"calendar"===s.data.result.type?s.data.result.groups[0].items:[]}}navigate(e){this.context.overrideLinkClick?this.context.overrideLinkClick(e):W.f({environment:this.environment,url:e})}renderComponent(){const{requestStore:e}=this.stores;return r.createElement(T.a,{requestStore:e,request:this.getCurrentStartOfDay().valueOf(),performRequest:this.performRequest,render:this.renderResults})}renderItem(e,t,n){const{collectionStore:i,disabled:o,blockPropertyValueOverlayStore:s}=this.props,a=M.a.createChildStore(i,{table:H.b,id:e.id});return r.createElement(P,{key:e.id,store:a,time:e.includeTime?this.renderTime(e,t,n):void 0,disabled:o,format:this.props.format,schema:this.props.schema,blockPropertyValueOverlayStore:s})}renderTime(e,t,n){const{schema:r,calendarBy:o,intl:s}=this.props,a=r[o];if(!a||"date"!==a.type)return;const l=a.date_format||b.v,c=a.time_format||b.x,d=Object(i.a)(e.start),h=e.end?Object(i.a)(e.end):void 0,p=Boolean(!d.isBetween(t,n)&&h&&!h.isBetween(t,n));if(e.end){const t=b.s(e.start,e.end,e.timeZone);return p?Object(N.a)({value:t,date_format:l,time_format:c,userTimeZone:e.timeZone,allowRelativeDates:!0,intl:s}):Object(N.d)({start_time:t.start_time,end_time:t.end_time,time_format:c,humanReadable:!0,intl:s})}return Object(N.c)({start_time:b.r(e.start,e.timeZone).start_time,time_format:c,humanReadable:!0,intl:s})}getCurrentStartOfDay(){const{currentStartOfDay:e}=this.stores.store.state;return e?Object(i.a)(e):Object(i.a)(this.props.initialStartOfDay)}}K.contextTypes=V.a,K.headerStyle={display:"flex",alignItems:"center",height:"100%"};t.default=Object(_.h)(K)},1163:function(e,t,n){"use strict";n.r(t);n(15),n(12);var r=n(0),i=n(171),o=n(14),s=n(8),a=n(26),l=n(115),c=n(79),d=n(754),h=n(49),p=n(3),m=n(768),u=n(773),g=n(329),b=n(1489),y=n(1292),f=n(81),S=n(220),v=n(23),w=n(618),E=n(502),O=n(550),k=n(34),P=n(67),M=n(161),T=n(77),C=n(343),j=n(21),I=n(17),B=n(172);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class D extends p.a{constructor(){super(...arguments),this.renderOrigin=e=>{const{device:t}=this.environment;return r.createElement(k.a,Object.assign({style:this.getButtonStyle(),mobileFeedback:t.isMobile},e),s.a.dots({width:18,height:18}))},this.renderPopup=()=>{const{device:e}=this.environment,{store:t}=this.props,n={environment:this.environment,blocks:[t]};let i;return i=e.isMobile?{menuType:j.b.MenuType.ActionSheet}:{menuType:j.b.MenuType.Popup,width:210,maxHeight:"80vh"},r.createElement(j.b,Object.assign({},i),r.createElement(C.a,{sections:B.m,onAccept:this.handleAccept,context:n}))},this.handleClick=()=>{v.e(this.environment),o.Nc(this.environment)},this.handleDismiss=()=>{this.props.buttonPopupStore.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.props.buttonPopupStore.state,{open:!1}))},this.handleAccept=e=>{const{currentBlockStore:t}=I.a.state;if(t){const n=t.getType();n&&o.o(this.environment,{analyticsName:e.analyticsName,from:"public_topbar_more_menu",block_type:n})}e.closeParentMenu&&this.handleDismiss()}}renderComponent(){const{device:e}=this.environment;return r.createElement(h.a,{popupType:e.isMobile?h.a.PopupType.SlideUp:h.a.PopupType.Popup,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderOrigin,onClick:this.handleClick,render:this.renderPopup,originGap:8})}getButtonStyle(){const{device:e}=this.environment;return e.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",marginLeft:8,marginRight:8}:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:3}}}var L=D,R=n(688),F=n(117),W=n(22),U=n(367),N=n(88),V=n(116),_=n(85),z=n(1658),H=n(19),q=n(42),G=n(561),Q=n(11),K=n(280),Z=n(10),Y=n(350),X=n(211),J=n(83),$=n(265),ee=n(389),te=n(775),ne=n(1),re=n(1490),ie=n(414),oe=n(120),se=n(769),ae=n(235);function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class de extends p.a{constructor(){super(...arguments),this.storeTypes={shareButtonPopupStore:c.a},this.handleOpenQuickFind=()=>{R.b({environment:this.environment,analyticsFrom:"public-page-topbar"})},this.handleShareClick=()=>{o.Jc(this.environment),f.f(this.environment)},this.handleTopbarClick=()=>{v.e(this.environment)},this.navigateToFirstSpace=()=>{const{currentUserRootStore:e,currentUserSettingsStore:t}=I.a.state;e&&t&&F.n({environment:this.environment,userRootStore:e,userSettingsStore:t})},this.handleMoveToClick=e=>{U.d({blocks:[this.props.store],analyticsFrom:"quick_add",onAccept:this.handleMoveToAccept,isAddTo:!0})},this.handleMoveToAccept=e=>{const{currentSpaceStore:t}=I.a.state;t&&this.props.saveParent&&_.A({currentUserId:this.environment.currentUser.id,spaceId:t.id,value:e}),o.hc(this.environment)},this.handleCancelQuickAdd=e=>{const t=I.a.state.currentBlockStore,n=Y.a.state.lastPageId;t&&n&&(q.h({environment:this.environment,store:a.a.createChildStore(t,{table:Z.b,id:n}),showMoveTo:!1,saveParent:!1}),Q.d(this.environment,e=>{G.a({environment:this.environment,blocks:[t],transaction:e})}))}}renderComponent(){const{store:e}=this.props,{WindowSizeStore:t,device:n}=this.environment,i=Object(M.g)(this.environment,this.props.store);return r.createElement(g.a,{capture:!0,render:o=>r.createElement("div",Object.assign({},o,{style:this.getWrapStyle()}),i?this.renderPublicPageTopbar():this.renderNormalTopbar(),e.canEdit()&&n.isPhone&&r.createElement(w.a,{store:this.props.store,isMobile:!0,key:this.props.store.id}),this.props.isOffline&&r.createElement(K.b,{type:K.a.White,isMobile:!0},r.createElement("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingLeft:t.getSafePaddingLeftCSS(10),paddingRight:t.getSafePaddingRightCSS(14)}},s.a.mobileOffline({width:26,marginRight:12}),r.createElement("div",null,r.createElement(ne.b,{defaultMessage:"You're offline",id:"topbarMobile.offline.message"})))),r.createElement(m.a,{banners:this.props.banners,isMobile:!0}))})}renderPublicPageTopbar(){const{store:e}=this.props;return r.createElement("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:P.ub},this.environment.currentUser.isLoggedIn()&&r.createElement(r.Fragment,null,r.createElement(k.a,{style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:14,paddingRight:14,fontWeight:W.a.fontWeight.medium,color:this.theme.regularTextColor},mobileFeedback:!0,onClick:this.navigateToFirstSpace},r.createElement(ne.b,{defaultMessage:"Back",id:"topbarMobile.backButton.label"})),r.createElement("div",{style:{height:18,width:1,flexShrink:0,marginRight:6,background:this.theme.darkDividerColor}})),r.createElement(d.a,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:1,showCurrentPageControls:!1,ancestorMaxWidth:100,currentPageMaxWidth:220,isMobile:!0}),r.createElement("div",{style:{flexGrow:1,flexShrink:1}}),r.createElement(T.a,{onClick:this.handleOpenQuickFind},s.a.searchThick({width:20,height:20})),r.createElement(L,{store:e,buttonPopupStore:E.a}))}renderNormalTopbar(){const{store:e,pageVisitStore:t,presenceStore:n}=this.props,{isTablet:i}=this.environment.device,o=this.props.isInvalidPage;return r.createElement("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:P.ub},this.renderHamburgerButton(),i&&r.createElement(re.a,null),!o&&this.renderBreadcrumbs(),e.canEdit()&&i&&r.createElement(w.a,{store:e,isMobile:!1,key:e.id}),r.createElement(b.a,null),e.isRestricted()&&r.createElement(se.a,{style:{marginRight:8},onClick:()=>{this.stores.shareButtonPopupStore.setState({open:!0})}}),i&&e.canEdit()&&t&&n&&r.createElement(te.a,{rootStore:e,pageVisitStore:t,presenceStore:n}),this.props.shouldShowMoveTo?this.renderCancelQuickAdd():this.renderRightButtons())}renderHamburgerButton(){const e=O.a.getUnreadMentionsCountForOtherSpaces();return r.createElement(k.a,{mobileFeedback:!0,style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,height:"100%",width:36,marginLeft:4},onClick:()=>{Object(ee.a)(this.environment)?S.g({environment:this.environment,isExpanded:!$.a.get()}):S.d(),o.Ec(this.environment)}},s.a.hamburgerMenu({width:18,height:18}),r.createElement(y.a,{color:y.a.Color.Red,count:e,style:{position:"absolute",top:9,right:1}}))}renderBreadcrumbs(){const{isTablet:e}=this.environment.device;return this.props.shouldShowMoveTo?this.renderMoveTo():r.createElement(d.a,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:e?2:1,showCurrentPageControls:!1,ancestorMaxWidth:e?160:100,currentPageMaxWidth:e?240:220,isMobile:!0})}renderMoveTo(){var e=this;const{store:t}=this.props,n=t.getParentStore(),{currentSpaceStore:i}=I.a.state,o=n instanceof l.a&&i&&n.id===i.id;if(n){if(o)return r.createElement(k.a,{mobileFeedback:!0,style:de.moveToButtonStyle,onClick:this.handleMoveToClick},r.createElement(ne.b,{defaultMessage:"<mediumcolor>Add to</mediumcolor>{userAvatar}<mediumweight>Private pages</mediumweight>",id:"topbarMobile.addToPrivateSectionButton.label",values:{mediumcolor:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.createElement("span",{style:{color:e.theme.mediumTextColor,marginRight:8}},n)},mediumweight:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.createElement("span",{style:{fontWeight:W.a.fontWeight.medium,marginLeft:4}},t)},userAvatar:r.createElement(X.a,{size:22,avatarShouldShowShadow:!0,userValue:Object(J.g)(this.environment)})}}),this.renderChevron());{const e=t instanceof l.a?Object(oe.getSpaceIcon)(this.environment,t):t.getIcon();return r.createElement(k.a,{mobileFeedback:!0,style:de.moveToButtonStyle,onClick:this.handleMoveToClick},r.createElement("span",{style:{color:this.theme.mediumTextColor}},r.createElement(ne.b,{defaultMessage:"Add to",id:"topbarMobile.addToPageOrWorkspaceSectionButton.label",description:"Displayed to the user in front of a page or space, like 'Add to Page', where 'Page' is an existing page."})," "),r.createElement(N.a,{disabled:!0,icon:e,isEmptyPage:n.table===Z.b&&n.isEmptyPage(),title:n instanceof l.a?Object(oe.getSpaceName)(this.environment,n):void 0,size:24,style:{marginLeft:8,marginRight:4}}),r.createElement(V.a,{style:{fontWeight:W.a.fontWeight.semibold},store:n}),this.renderChevron())}}}renderChevron(){return s.a.chevronDown({marginLeft:4,width:10,fill:this.theme.lightTextColor})}renderRightButtons(){const{device:e}=this.environment;if(!this.props.isInvalidPage)return e.isReactNative?r.createElement(r.Fragment,null,this.renderShare(),this.renderShowMore()):r.createElement(r.Fragment,null,this.renderShowMore(),this.renderShare(),this.renderUpdatesButton())}renderCancelQuickAdd(){return r.createElement(k.a,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:16,paddingRight:16,fontWeight:W.a.fontWeight.medium,color:H.f.blue},onClick:this.handleCancelQuickAdd},r.createElement(ne.b,{defaultMessage:"Cancel",id:"topbarMobile.cancelQuickAddButton.label"}))}renderShowMore(){return r.createElement(u.a,{store:this.props.store,collectionViewStore:this.props.collectionViewStore,buttonPopupStore:E.a})}renderShare(){const{device:e}=this.environment;return r.createElement(h.a,{popupType:e.isMobile?h.a.PopupType.SlideUp:h.a.PopupType.Popup,style:{width:460},buttonPopupStore:this.stores.shareButtonPopupStore,onClick:this.handleShareClick,renderOrigin:t=>r.createElement(k.a,Object.assign({mobileFeedback:!0,style:de.actionButtonStyle},t),e.isAndroid?s.a.androidShare({width:16,height:16}):s.a.iOSShare({width:26})),render:()=>r.createElement(ae.b,{buttonPopupStore:this.stores.shareButtonPopupStore,store:this.props.store,onClose:()=>{this.stores.shareButtonPopupStore.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.stores.shareButtonPopupStore.state,{open:!1}))}})})}renderUpdatesButton(){return r.createElement(z.a,{format:z.a.Format.TopbarMobile})}getWrapStyle(){return{width:"100%",maxWidth:"100vw",zIndex:i.p}}getStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100vw",height:ie.b,marginTop:e.state.paddingTopCSS,paddingLeft:e.getSafePaddingLeftCSS(0),paddingRight:this.props.shouldShowMoveTo?e.getSafePaddingRightCSS(0):e.getSafePaddingRightCSS(7),boxShadow:"0 1px 0 ".concat(this.theme.darkDividerColor),background:this.theme.contentBackground,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}getBreadcrumbsStyle(){const{isTablet:e}=this.environment.device;return{flexGrow:0,marginLeft:2,overflow:"auto",WebkitOverflowScrolling:"touch",marginRight:e?16:8,height:"100%"}}}de.actionButtonStyle={display:"flex",alignItems:"center",height:"100%",paddingLeft:6,paddingRight:6},de.moveToButtonStyle={display:"flex",alignItems:"center",paddingLeft:8,paddingRight:12,fontSize:W.a.fontSize.UIRegular.mobile,lineHeight:W.a.lineHeight.UIRegular.mobile,whiteSpace:"nowrap",minWidth:0};t.default=de},1499:function(e,t,n){"use strict";var r=n(175),i=n(770),o=n(317);t.a=new r.a(()=>{const{phase:e}=i.b.state;return!!o.a.state.open||(e===i.a.hidden||e===i.a.willHide)})},1658:function(e,t,n){"use strict";n(15),n(12);var r=n(0),i=n(158),o=n(49),s=n(3),a=n(1190),l=n(92),c=n(39),d=n(22),h=n(8),p=n(2),m=n(857),u=n(31),g=n(181),b=n(40),y=n(59),f=n(99),S=n(183),v=n(93),w=n(41),E=n(17),O=n(80),k=n(176),P=n(243),M=n(334),T=n(462),C=n(1);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const x={mentions:!0,following:!0,archive:!1};class A extends s.a{constructor(){super(...arguments),this.storeTypes={size:y.a.of(20),checkpoint:y.a.of(Math.random())},this.renderRequest=(e,t,n)=>{const i=E.a.state.currentSpaceStore;if(!i||e)return r.createElement("div",{style:this.getPlaceholderContentStyle()},r.createElement(C.b,{defaultMessage:"Something went wrong.",id:"notificationUpdates.unknownErrorMessage"}));if(!t)return r.createElement("div",{style:this.getContentStyle()},this.renderSpinner());const o=t.map(e=>Object(w.c)(i,{table:M.a,id:e})),s=p.compact(o.map(e=>{const t=e.getValue();if(!t)return;if(t.invalid)return;if(t.visited&&x[this.props.type]||!t.visited&&"archive"===this.props.type)return;const n=v.c(e);if(!n)return;const r=n.getValue();return r&&!r.invalid?{activity:r,notification:t}:void 0})),a=this.stores.size.get(),l=0===s.length;return T.a.setState(I({},T.a.state,{isCurrentTabEmpty:l})),r.createElement("div",{style:l?this.getPlaceholderContentStyle():this.getContentStyle()},l&&this.props.empty,r.createElement("div",{className:"notranslate"},s.map((e,t,n)=>{let{activity:o,notification:s}=e;const a=n.length-1===t;return r.createElement(m.a,{key:o.id,activity:o,rootStore:i,isLast:a,notification:s,analyticsContext:this.props.analyticsContext,isTopbarUpdatesMenu:!1,source:"notifications"})})),r.createElement(S.a,{onChange:e=>{e<200&&n&&t&&t.length>=a&&this.stores.size.set(t.length+20)}},!n&&this.renderSpinner(!0)))},this.handleActivityEmit=()=>{this.stores.checkpoint.set(Math.random())},this.handleActivityEmitThrottled=p.throttle(this.handleActivityEmit,1e3),this.handleNotificationEmit=u.g(this.handleActivityEmitThrottled)}willMount(){this.startMessageListeners()}willUnmount(){this.stopMessageListeners()}renderComponent(){return O.a.state.online?this.renderOnline():this.renderOffline()}renderOffline(){return r.createElement("div",{style:this.getPlaceholderContentStyle()},r.createElement("div",null,r.createElement(C.b,{defaultMessage:"Please go online to view updates.",id:"notificationUpdates.offline.message"})))}renderOnline(){const{currentUserStore:e,currentSpaceStore:t}=E.a.state;if(!e||!t)return;const n=t.id,i=this.stores.size.get(),o=this.stores.checkpoint.get(),s=this.props.type;return r.createElement(g.a,{throttle:1e3,request:{spaceId:n,size:i,type:s,checkpoint:o},performRequest:async e=>{let{spaceId:t,size:n,type:r}=e;const i=await b.N(this.environment,{spaceId:t,size:n,type:r});if("failed"===i.type)throw i.error;return i.data.notificationIds},render:this.renderRequest})}renderSpinner(e){return r.createElement("div",{style:this.getSpinnerStyle(e)},r.createElement(f.a,null))}startMessageListeners(){const{currentUserStore:e}=E.a.state;if(e){const t=Object(P.f)(e.id);this.notificationListenerReference=k.a.addListener(t,this.handleNotificationEmit,void 0)}}stopMessageListeners(){this.notificationListenerReference&&(k.a.removeListener(this.notificationListenerReference),this.notificationListenerReference=void 0)}getContentStyle(){const{device:e}=this.environment;return{minHeight:e.isMobile?void 0:"mentions"===this.props.type?void 0:"75vh",paddingBottom:e.isMobile?44:0}}getPlaceholderContentStyle(){const{device:e}=this.environment;return I({},this.getContentStyle(),{paddingTop:e.isMobile?64:void 0,minHeight:e.isMobile?void 0:220,display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontSize:14,color:this.theme.mediumTextColor,overflow:"hidden"})}getSpinnerStyle(e){return I({},this.getPlaceholderContentStyle(),{minHeight:e?64:220})}}var D,L=A,R=n(845),F=n(1292),W=n(21),U=n(351),N=n(14),V=n(38),_=n(859),z=n(1290),H=n(1400),q=n(566),G=n(761),Q=n(102),K=n(296),Z=n(550),Y=n(19),X=n(151),J=n(34),$=n(67),ee=n(77),te=n(91),ne=n(161),re=n(30),ie=n(221);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile"}(D||(D={}));class le extends s.a{constructor(){super(...arguments),this.renderSpaceUpdates=()=>{const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:W.b.MenuType.Modal,title:r.createElement(C.b,{defaultMessage:"All Updates",id:"updatesModal.mobileMenu.title"}),right:r.createElement(te.DoneMenuText,null),onClickRight:this.closeMenu,left:h.a.settings({fill:Y.f.blue,width:18,height:18}),onClickLeft:this.handleOpenSettings,header:this.renderHeader(),whiteBackground:!0,footer:this.renderFooter()}:{menuType:W.b.MenuType.Popup,header:this.renderHeader(),maxHeight:"80vh",height:"auto",footer:this.renderFooter()},r.createElement(H.a,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>r.createElement(W.b,Object.assign({},t,e,{className:$.Bb}),r.createElement(ie.a,{capture:!0,allowUndo:!0,allowEsc:!0,render:()=>this.renderContent()}))})},this.closeMenu=()=>{q.a.setState(se({},q.a.state,{open:!1})),this.setCurrentTabAsRead()},this.handleDismiss=()=>{this.setCurrentTabAsRead()},this.handleClick=()=>{this.handleTrackTab()},this.handleSwipeLeft=()=>{const e=this.tabs.indexOf(T.a.state.currentTab)+1,t=this.tabs[e];void 0!==t&&this.changeTab(t)},this.handleSwipeRight=()=>{const e=this.tabs.indexOf(T.a.state.currentTab)-1,t=this.tabs[e];void 0!==t&&this.changeTab(t)},this.handleTabClick=e=>{const t=this.tabs[e];T.a.state.currentTab!==t&&this.changeTab(t)},this.handleOpenSettings=()=>{const{device:e}=this.environment;N.Ic(this.environment),e.isMobile?G.a.setState({open:!0}):(q.a.setState(se({},q.a.state,{open:!1})),K.a.setState(se({},K.a.state,{currentTab:"notifications"})),K.a.setState(se({},K.a.state,{open:!0})))},this.handleArchiveAll=()=>{const e=T.a.state.currentTab;Object(T.b)(e)&&U.a(this.environment,e)},this.setCurrentTabAsRead=()=>{U.c(this.environment)}}willMount(){const e=Q.a.get(le.lastUpdatesTabKey);e&&this.tabs.includes(e)&&this.setTabState(e)}renderComponent(){const{device:e}=this.environment;return r.createElement(c.a,{renderTooltip:()=>r.createElement(C.b,{defaultMessage:"Updates for all pages in this space",id:"updatesButton.tooltip"}),originGap:6,placement:i.b.Right,render:t=>r.createElement(o.a,{popupType:e.isMobile?o.a.PopupType.SlideUp:o.a.PopupType.Popup,alignmentToOrigin:i.a.Start,placementToOrigin:i.b.Right,onClick:this.handleClick,originGap:0,style:se({},!e.isMobile&&{width:500,overflow:"hidden"}),isWideTabletWidth:!0,render:this.renderSpaceUpdates,onClose:this.handleDismiss,isFullWidthOnMobile:!0,preventScaleTransition:!0,buttonPopupStore:q.a,renderOrigin:e=>this.renderButton(t,e)})})}renderButton(e,t){const n=this.props.format,i=Z.a.getUnreadCountForCurrentSpace(),o=i.mentions>0||i.following>0,s=q.a.state.open,c=i.mentions;return n===D.MobileBottomBarPhone?r.createElement(J.a,Object.assign({style:le.mobileBottomBarPhoneButtonStyle,mobileFeedback:!0},t),r.createElement("div",{style:{position:"relative"}},h.a.mobileBottomBarUpdates({width:26,fill:this.theme.regularTextColor}),r.createElement(F.a,{color:F.a.Color.Red,count:c,style:{position:"absolute",top:-3,right:c<99?-5:-8}}))):n===D.MobileBottomBarTablet?r.createElement(J.a,Object.assign({style:le.mobileBottomBarTabletButtonStyle,mobileFeedback:!0},t),r.createElement("div",{style:{position:"relative"}},h.a.mobileBottomBarUpdates({width:26,fill:this.theme.regularTextColor}),r.createElement(F.a,{color:F.a.Color.Red,count:c,style:{position:"absolute",top:-3,right:c<99?-5:-8}}))):n===D.TopbarMobile?r.createElement(J.a,Object.assign({style:se({},le.actionButtonStyle,{marginLeft:2,marginRight:2}),mobileFeedback:!0},t),h.a.mobileBottomBarUpdates({width:26}),r.createElement(F.a,{color:F.a.Color.Red,count:c,style:{position:"absolute",top:8,right:0}})):n===D.SidebarMobile?r.createElement(J.a,Object.assign({style:le.actionButtonStyle,mobileFeedback:!0},t),h.a.mobileBottomBarUpdates({width:26}),r.createElement(F.a,{color:F.a.Color.Red,count:c,style:{position:"absolute",top:8,right:0}})):n===D.Sidebar?r.createElement(J.a,Object.assign({style:se({},o&&{fontWeight:d.a.fontWeight.medium,color:this.theme.regularTextColor})},Object(l.a)(e,t)),r.createElement(a.a,{isMobile:!1,left:r.createElement("div",{style:{color:o?this.theme.regularTextColor:"inherit"}},h.a.typesCreatedAt({fill:o?this.theme.regularIconColor:this.theme.mediumIconColor,width:14})),right:r.createElement(F.a,{color:F.a.Color.Red,count:c,style:{marginBottom:2,marginLeft:6}}),style:{background:s?this.theme.buttonHoveredBackground:"none"}},r.createElement(C.b,{defaultMessage:"All Updates",id:"updatesButton.allUpdates.sidebarButton"}))):void 0}renderHeader(){const{device:e}=this.environment,{currentTab:t}=T.a.state,n=this.tabs.indexOf(t),i=Z.a.getUnreadCountForCurrentSpace(),o={mentions:r.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:i.mentions>0?d.a.fontWeight.medium:void 0},className:$.Ab},r.createElement("div",null,r.createElement(C.b,{defaultMessage:"Inbox",id:"updatesModal.mentionsTab.title"})),r.createElement(F.a,{color:F.a.Color.Red,count:i.mentions,style:{marginLeft:6},numberStyle:{marginBottom:e.isMobile?0:2}})),following:r.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:i.following>0?d.a.fontWeight.medium:void 0}},r.createElement("div",null,r.createElement(C.b,{defaultMessage:"Following",id:"updatesModal.followedUpdatesTab.title"})),r.createElement(F.a,{color:F.a.Color.Gray,count:i.following,style:{marginLeft:6},numberStyle:{marginBottom:e.isMobile?0:2}})),allPages:r.createElement("div",{className:$.yb},r.createElement(C.b,{defaultMessage:"All",id:"updatesModal.allUpdatesTab.title"})),archive:r.createElement("div",{className:$.zb},r.createElement(C.b,{defaultMessage:"Archived",id:"updatesModal.archiveTab.title"})),currentPage:e.isMobile&&r.createElement("div",null,r.createElement(C.b,{defaultMessage:"This page",id:"updatesModal.mobielThisPage.title"}))};let s;if("currentPage"===T.a.state.currentTab){const{currentBlockStore:e}=E.a.state;e&&(s=r.createElement(_.a,{store:e}))}const a=this.tabs.map(e=>o[e]);return r.createElement(r.Fragment,null,r.createElement(z.a,{tabs:a,selectedIndex:n,onChange:this.handleTabClick,separatorIndexes:[this.tabs.indexOf("archive")-1],right:!e.isMobile&&this.renderNotificationSettingsButton()}),s)}renderNotificationSettingsButton(){return r.createElement(c.a,{renderTooltip:()=>r.createElement(C.b,{defaultMessage:"Open notifications settings",id:"updatesModal.openNotifications.tooltip"}),render:e=>r.createElement(X.a,Object.assign({icon:h.a.sidebarSettings,onClick:this.handleOpenSettings},e))})}renderContent(){const e=T.a.state.currentTab;if("following"===e)return r.createElement(L,{key:"following",type:"following",empty:this.renderEmptyState(r.createElement(C.b,{defaultMessage:"Turn on “Follow this page” in the Updates menu on any page to receive updates here.",id:"updatesModal.followedUpdatesTab.allArchived"}),r.createElement(C.b,{defaultMessage:"No new updates",id:"updatesModal.followedUpdatesTab.allArchivedTitle"})),analyticsContext:"click_followed_pages"});if("allPages"===e){const{currentSpaceStore:e}=E.a.state;return e?r.createElement(R.a,{key:"all-pages",spaceId:e.id,empty:this.renderEmptyState(r.createElement(C.b,{defaultMessage:"Updates on pages in your workspace will appear here.",id:"updatesModal.allPagesTab.emptyPrompt"}),r.createElement(C.b,{defaultMessage:"No new updates",id:"updatesModal.allPagesTab.emptyPromptTitle"})),source:"all_updates",analyticsContext:"click_all_updates",isTopbarUpdatesMenu:!1}):null}if("mentions"===e)return r.createElement(L,{key:"mentions",type:"mentions",empty:this.renderEmptyState(Object(ne.f)(this.environment)?r.createElement(C.b,{defaultMessage:"When someone @mentions you, replies to your comments, sends you a request, or invites you to a page, you’ll be notified here.",id:"updatesModal.spaceUpdatesTab.allArchivedRequests"}):r.createElement(C.b,{defaultMessage:"When someone @mentions you, replies to your comments, or invites you to a page, you’ll be notified here.",id:"updatesModal.spaceUpdatesTab.allArchived"}),r.createElement(C.b,{defaultMessage:"You're all caught up",id:"updatesModal.spaceUpdatesTab.allArchivedTitle"})),analyticsContext:"click_comments_and_mentions"});if("archive"===e)return r.createElement(L,{key:"archive",type:"archive",empty:this.renderEmptyState(r.createElement(C.b,{defaultMessage:"Any Inbox updates you archived will show up here.",id:"updatesModal.arvhiveTab.emptyPrompt"}),r.createElement(C.b,{defaultMessage:"No archived updates",id:"updatesModal.arvhiveTab.emptyPromptTitle"})),analyticsContext:"click_followed_pages"});if("currentPage"===e){const{currentSpaceStore:e,currentBlockStore:t}=E.a.state;if(!e||!t)return null;const n=t.getValue(),i=n&&V.q(n)?n.collection_id:void 0;return r.createElement(R.a,{key:"current-page",navigableBlockId:t.id,collectionId:i,spaceId:e.id,empty:this.renderEmptyState(r.createElement(C.b,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),r.createElement(C.b,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})),analyticsContext:"click_all_updates",isTopbarUpdatesMenu:!0,source:"notifications"})}throw Object(re.e)(e)}renderEmptyState(e,t){const{device:n}=this.environment;return r.createElement("div",{style:{textAlign:"center",paddingLeft:20,paddingRight:20,paddingTop:n.isMobile?64:void 0,height:n.isMobile?void 0:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden",minHeight:n.isMobile?void 0:220}},r.createElement("div",{style:{paddingBottom:12}},h.a.inbox({width:48,fill:this.theme.lightIconColor})),r.createElement("div",{style:{fontSize:14,fontWeight:500,color:this.theme.mediumTextColor,maxWidth:380}},t),r.createElement("div",{style:{fontSize:14,color:this.theme.mediumTextColor,marginTop:2,marginBottom:4,maxWidth:380}},e))}renderFooter(){const{currentTab:e,isCurrentTabEmpty:t}=T.a.state;if("mentions"!==e)return;if(t)return;const{device:n}=this.environment;return r.createElement("div",{style:this.getInboxActionsStyle()},r.createElement(ee.a,{onClick:this.handleArchiveAll,style:this.getArchiveButtonStyle(),mobileFeedback:n.isMobile},h.a.archive({width:n.isMobile?16:14,fill:"inherit",marginLeft:n.isMobile?6:0,marginRight:n.isMobile?8:6}),r.createElement(C.b,{defaultMessage:"Archive all",id:"updatesModal.spaceUpdatesTab.archiveAllButtonTitle"})))}setTabState(e){Q.a.get(le.lastUpdatesTabKey)!==e&&Q.a.set(le.lastUpdatesTabKey,e),T.a.state.currentTab!==e&&T.a.setState(se({},T.a.state,{currentTab:e}))}handleTrackTab(){let e;switch(T.a.state.currentTab){case"mentions":e="mentions_comments";break;case"following":e="followed_pages";break;default:e="all_updates"}N.vc(this.environment,{tab:e}),N.Zd(this.environment,{itemName:"updates"})}changeTab(e){this.setCurrentTabAsRead(),this.setTabState(e),this.handleTrackTab()}get tabs(){return this.environment.device.isMobile?["mentions","following","allPages","currentPage","archive"]:["mentions","following","allPages","archive"]}getInboxActionsStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",alignItems:e.isMobile?"flex-start":"center",background:e.isMobile?this.theme.contentBackground:this.theme.sidebarBackground,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor),marginTop:1,position:e.isMobile?"absolute":"sticky",left:0,right:0,bottom:0,height:e.isPhone?t.getSafePaddingBottomCSS(44):void 0}}getArchiveButtonStyle(){const{device:e}=this.environment;return{paddingLeft:e.isMobile?0:14,paddingRight:e.isMobile?8:12,marginRight:"auto",width:"100%",color:e.isMobile?this.theme.blueColor:this.theme.mediumTextColor,fill:e.isMobile?this.theme.blueColor:this.theme.mediumTextColor,height:e.isMobile?44:36,borderRadius:0,fontSize:e.isMobile?16:12,fontWeight:e.isMobile?500:400,justifyContent:e.isMobile?"center":void 0}}}le.Format=D,le.lastUpdatesTabKey="LastUpdatesTab",le.actionButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,height:"100%",minWidth:34,position:"relative"},le.mobileBottomBarPhoneButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",flex:1},le.mobileBottomBarTabletButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",width:62,flex:"none"};t.a=le}}]);