# ~/.config/sway/config
# Converted from Hyprland configuration

# Variables
set $mod Mod4
set $left h
set $down j
set $up k
set $right l
set $term ghostty
set $menu walker

# Output configuration (monitor setup)
output eDP-1 resolution 1920x1080@60Hz position 0,0 scale 1
# Uncomment for external monitor:
# output HDMI-A-1 resolution 1920x1080@75Hz position 0,0 scale 1

# Wallpaper
output * bg ~/dotfiles/wallpaper/Zelda_Ghib.heic fill

output * max_render_time 1

# Input configuration
input type:keyboard {
    xkb_layout us
    repeat_delay 240
    repeat_rate 50
}

input type:touchpad {
    natural_scroll enabled
    tap enabled
    click_method clickfinger
    middle_emulation disabled
}

# Enable gesture support
bindgesture swipe:right workspace prev
bindgesture swipe:left workspace next

# General appearance
default_border pixel 2
default_floating_border pixel 2
hide_edge_borders none
gaps inner 5
gaps outer 10

# Colors (matching your Hyprland theme)
client.focused          #33ccffee #33ccffee #ffffff #33ccffee #33ccffee
client.focused_inactive #595959aa #595959aa #ffffff #595959aa #595959aa
client.unfocused        #595959aa #595959aa #888888 #595959aa #595959aa
client.urgent           #ff6b6b   #ff6b6b   #ffffff #ff6b6b   #ff6b6b
client.placeholder      #000000   #0c0c0c   #ffffff #000000   #0c0c0c
client.background       #ffffff

# Layout
workspace_layout default

# Autostart applications
exec_always --no-startup-id {
    # Kill existing processes to prevent duplicates
    pkill -f wl-gammarelay-rs
    pkill -f waybar
    pkill -f swaync
    pkill -f nm-applet
}

# Core system services
exec dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP

# Desktop portal (for cross-platform support)
exec /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec systemctl --user start xdg-desktop-portal-wlr
exec systemctl --user start xdg-desktop-portal

# Color enhancement (vibrance mode) - matching your hyprshade vibrance
exec wl-gammarelay-rs
exec_always sleep 2 && busctl --user call rs.wl-gammarelay / rs.wl.gammarelay UpdateGamma ddddd 1.0 1.0 1.0 1.3 1.0

# UI applications (matching your exec-once commands)
exec waybar
exec swaync  
exec nm-applet
exec ghostty
exec zen-browser
exec elephant

# Additional autostart from your config
exec systemctl --user start hyprpolkitagent

# Window rules
assign [app_id="kitty"] workspace number 1
assign [app_id="alacritty"] workspace number 1
assign [app_id="org.wezfurlong.wezterm"] workspace number 1
assign [app_id="com.mitchellh.ghostty"] workspace number 1
assign [app_id="kdesystemsettings"] workspace number 2
assign [app_id="Brave-browser"] workspace number 3
assign [app_id="firefox"] workspace number 3
assign [app_id="floorp"] workspace number 3
assign [app_id="zen"] workspace number 3

# Floating windows
for_window [app_id="pavucontrol-qt"] floating enable
for_window [app_id="pavucontrol-qt"] resize set 40ppt 90ppt
for_window [app_id="pavucontrol-qt"] move position 60ppt 5ppt
for_window [class="rofi"] floating enable, opacity 0.8
for_window [app_id="dev.benz.walker"] border none
for_window [app_id="dev.benz.walker"] floating enable 

# Scratchpad-like functionality for dropdown terminal
for_window [app_id="kitty-dropterm"] {
    floating enable
    resize set 75ppt 60ppt
    move position center
    move scratchpad
}

# Key bindings
# Basic controls
bindsym $mod+q kill
bindsym $mod+f fullscreen toggle
bindsym $mod+Shift+f fullscreen toggle global
bindsym $mod+Return exec $term
bindsym $mod+t exec kitty
bindsym $mod+Shift+q exec swaynag -t warning -m 'Exit sway?' -B 'Yes' 'swaymsg exit'
bindsym $mod+Shift+v floating toggle

# Drag floating windows
floating_modifier $mod normal

# Application launcher
bindsym $mod+d exec $menu

# Screenshots
bindsym $mod+y exec grim -g "$(slurp)" ~/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png

# Audio controls
bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
bindsym XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%
bindsym XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle

# Brightness controls
bindsym F12 exec brightnessctl -q set +5%
bindsym F11 exec brightnessctl -q set 5%-

# Screen recording
bindsym $mod+r exec wf-recorder -g "$(slurp)" -f ~/Videos/recording-$(date +%Y%m%d-%H%M%S).mp4

# Logout menu
bindsym $mod+Shift+e exec wlogout

# Focus controls (master layout simulation)
bindsym $mod+j focus next
bindsym $mod+k focus prev
bindsym $mod+h focus left
bindsym $mod+l focus right

# Move windows
bindsym $mod+Shift+h move left
bindsym $mod+Shift+l move right
bindsym $mod+Shift+k move up
bindsym $mod+Shift+j move down
bindsym $mod+Shift+Return focus parent, focus child

# Resize windows
bindsym $mod+Left resize shrink width 40px
bindsym $mod+Right resize grow width 40px

# Workspace switching
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# Move windows to workspaces
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# Scratchpad (similar to special workspace)
bindsym $mod+u scratchpad show
bindsym $mod+Shift+u move scratchpad

# Power menu and additional menus
bindsym $mod+Shift+p exec walker --provider menus

# Notifications
bindsym $mod+Shift+n exec swaync-client -t -sw

# Scratchpad-like bindings (pyprland replacements)
bindsym $mod+v exec ~/.config/sway/scripts/toggle-volume.sh
bindsym $mod+a exec ~/.config/sway/scripts/toggle-dropterm.sh
bindsym $mod+Shift+m exec ~/.config/sway/scripts/toggle-utop.sh

# Environment variables
exec systemctl --user set-environment QT_QPA_PLATFORMTHEME=qt6ct
exec systemctl --user set-environment GDK_BACKEND=wayland
exec systemctl --user set-environment QT_QPA_PLATFORM="wayland;xcb"
exec systemctl --user set-environment CLUTTER_BACKEND=wayland
exec systemctl --user set-environment XDG_CURRENT_DESKTOP=sway
exec systemctl --user set-environment XDG_SESSION_DESKTOP=sway
exec systemctl --user set-environment QT_AUTO_SCREEN_SCALE_FACTOR=1
exec systemctl --user set-environment XDG_SESSION_TYPE=wayland
exec systemctl --user set-environment QT_WAYLAND_DISABLE_WINDOWDECORATION=1
exec systemctl --user set-environment ELECTRON_OZONE_PLATFORM_HINT=wayland
exec systemctl --user set-environment GDK_SCALE=1
exec systemctl --user set-environment QT_SCALE_FACTOR=1

# XWayland settings
xwayland enable

include /etc/sway/config.d/*
