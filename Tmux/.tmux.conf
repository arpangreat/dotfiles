unbind C-b
set -g prefix C-s
bind-key -r C-s send-prefix

# set -ga terminal-overrides ",*256col*:Tc"
set -ga terminal-overrides ',alacritty:Tc'
# set -ga terminal-overrides ',xterm-kitty-256color:Tc'
set -g status-style 'bg=#ff79c6 fg=#5eacd3'
# set -g default-terminal "xterm-kitty-256color"
# set -g default-terminal "alacritty"
set -ga terminal-overrides '*:Ss=\E[%p1%d q:Se=\E[ q'

set -g mouse on
set -g mode-keys vi

# source-file ~/dotfiles/nvim/tmux-jellybeans
# source-file ~/dotfiles/Tmux/kanagawa.conf
# source-file ~/dotfiles/Tmux/nightfox_tmux.tmux
# source-file ~/dotfiles/Tmux/catppuccin.conf
source-file ~/dotfiles/Tmux/bubbles.conf

set -g focus-events on
set -g status-style bg=default
set -g status-left-length 90
set -g status-right-length 90
set -g status-justify centre
# Reload with a message
bind r source-file ~/.tmux.conf \; display "Reloaded!"
# Open a new window in the current path

bind-key \\ splitw -h -c '#{pane_current_path}'
bind-key - splitw -v -c '#{pane_current_path}'

# Moving Windows 
bind-key -n C-S-left swap-window -t -1
bind-key -n C-S-right swap-window -t +1

bind-key -n M-enter copy-mode

bind -n M-g popup -E "tmux new-session -A -s scratch 'cd ~/dotfiles/scratch && nvim .'"
bind -n C-g display-popup -E "tmux new-session -A -s tmux-config 'nvim ~/dotfiles/Tmux/.tmux.conf'"

bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind -n WheelDownPane select-pane -t= \; send-keys -M
bind -n C-WheelUpPane select-pane -t= \; copy-mode -e \; send-keys -M
bind -T copy-mode-vi    C-WheelUpPane   send-keys -X halfpage-up
bind -T copy-mode-vi    C-WheelDownPane send-keys -X halfpage-down
bind -T copy-mode-emacs C-WheelUpPane   send-keys -X halfpage-up
bind -T copy-mode-emacs C-WheelDownPane send-keys -X halfpage-down

# To copy, left click and drag to highlight text in yellow, 
# once you release left click yellow text will disappear and will automatically be available in clibboard
# # Use vim keybindings in copy mode
setw -g mode-keys vi
# Update default binding of `Enter` to also use copy-pipe
unbind -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xclip -selection c"
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"

# vim-like pane switching
bind -n M-k select-pane -U
bind -n M-j select-pane -D
bind -n M-h select-pane -L
bind -n M-l select-pane -R

bind c new-window -c '#{pane_current_path}'

set-option -g renumber-windows on

bind-key -r u last-window
bind-key b break-pane -d
bind-key v copy-mode

# Resizing panes
bind -r k resize-pane -U 5
bind -r j resize-pane -D 5
bind -r h resize-pane -L 5
bind -r l resize-pane -R 5

bind -r T split-window -b -p 35 -h -c "#{pane_current_path}" "[[ -e TODO.md ]] && nvim TODO.md || nvim ~/dotfiles/todo.md"

bind -r i run-shell -b "tmux neww tmux-cht.sh"
bind -r C-w split-window -h "tmux list-sessions | sed -E 's/:.*$//' | grep -v \"^$(tmux display-message -p '#S')\$\" | fzf --reverse | xargs tmux switch-client -t"

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'dracula/tmux'
set -g @plugin 'sainnhe/tmux-fzf'
# set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'tmux-plugins/tmux-net-speed'
set -g @plugin 'samoshkin/tmux-plugin-sysstat' # `sysstat_ntemp` and `sysstat_itemp` are temperatures of nvidia card and intel card, these scripts are available in my fork: https://github.com/sainnhe/tmux-plugin-sysstat
# set -g @plugin "arcticicestudio/nord-tmux"

TMUX_FZF_LAUNCH_KEY="C-f"

set -g @sysstat_cpu_view_tmpl '#[fg=magenta]C:#[default] #[fg=#{cpu.color}]#{cpu.pused}#[default]'
set -g @sysstat_mem_view_tmpl '#[fg=magenta]M:#[default] #[fg=#{mem.color}]#{mem.pused}#[default]'
set -g status-interval 3

# set -g status-right '#{prefix_highlight} | %a %Y-%m-%d %H:%M'

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'
# set -g @plugin 'christoomey/vim-tmux-navigator'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
